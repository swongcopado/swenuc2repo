function dtmlXMLLoaderObject(e,t,i,n){return this.xmlDoc="",this.async=void 0===i||i,this.onloadAction=e||null,this.mainObject=t||null,this.waitCall=null,this.rSeed=n||!1,this}function callerFunction(t,i){return this.handler=function(e){return e=e||window.event,t(e,i),!0},this.handler}function getAbsoluteLeft(e){return getOffset(e).left}function getAbsoluteTop(e){return getOffset(e).top}function getOffsetSum(e){for(var t=0,i=0;e;)t+=parseInt(e.offsetTop),i+=parseInt(e.offsetLeft),e=e.offsetParent;return{top:t,left:i}}function getOffsetRect(e){var t=e.getBoundingClientRect(),i=document.body,n=document.documentElement,a=window.pageYOffset||n.scrollTop||i.scrollTop,o=window.pageXOffset||n.scrollLeft||i.scrollLeft,e=n.clientTop||i.clientTop||0,i=n.clientLeft||i.clientLeft||0,e=t.top+a-e,i=t.left+o-i;return{top:Math.round(e),left:Math.round(i)}}function getOffset(e){return(e.getBoundingClientRect?getOffsetRect:getOffsetSum)(e)}function convertStringToBoolean(e){switch(e="string"==typeof e?e.toLowerCase():e){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(e){return-1!=e.indexOf("?")?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop||(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this)}function _dhtmlxError(e,t,i){return this.catches||(this.catches=new Array),this}function dhtmlXHeir(e,t){for(var i in t)"function"==typeof t[i]&&(e[i]=t[i]);return e}function dhtmlxEvent(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)}function dhtmlXMenuObject(e,t){var i,a=this;if(this.conf={skin:t||window.dhx4.skin||("undefined"!=typeof dhtmlx?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxmenu")||"dhx_skyblue",mode:"web",align:"left",is_touched:!1,selected:-1,last_click:-1,fixed_pos:!1,rtl:!1,icons_path:"",arrow_ff_fix:0<=navigator.userAgent.indexOf("MSIE")&&"BackCompat"==document.compatMode,live_id:window.dhx4.newId(),tags:{root:"menu",item:"item",text_ext:"itemtext",userdata:"userdata",tooltip:"tooltip",hotkey:"hotkey",href:"href"},autoload:{},hide_tm:{},top_mode:!0,top_tmtime:200,v_enabled:!1,v:{x1:null,x2:null,y1:null,y2:null},dir_toplv:"bottom",dir_sublv:"right",auto_overflow:!1,overflow_limit:0,of_utm:null,of_utime:20,of_ustep:3,of_dtm:null,of_dtime:20,of_dstep:3,tm_sec:400,tm_handler:null,dload:!1,dload_url:"",dload_icon:!1,dload_params:{action:"loadMenu"},dload_pid:"parentId",tl_botmarg:1,tl_rmarg:0,tl_ofsleft:1,context:!1,ctx_zoneid:!1,ctx_autoshow:!0,ctx_autohide:!0,ctx_hideall:!0,ctx_zones:{},ctx_baseid:null,selected_sub:[],opened_poly:[]},"object"==typeof e&&null!=e&&void 0===e.tagName){for(var n in null==e.icons_path&&null==e.icon_path||(this.conf.icons_path=e.icons_path||e.icon_path),null!=e.skin&&(this.conf.skin=e.skin),e.visible_area&&(this.conf.v_enabled=!0,this.conf.v={x1:e.visible_area.x1,x2:e.visible_area.x2,y1:e.visible_area.y1,y2:e.visible_area.y2}),{json:1,xml:1,items:1,top_text:1,align:1,open_mode:1,overflow:1,dynamic:1,dynamic_icon:1,context:1,onload:1,onclick:1,oncheckboxclick:1,onradioclick:1})null!=e[n]&&(this.conf.autoload[n]=e[n]);e=e.parent}for(n in null!=e&&null!=(i="string"==typeof e?document.getElementById(e):e)?(this.base=i,this.base.id||(this.base.id=(new Date).valueOf()),this.base.className+=" dhtmlxMenu_"+this.conf.skin+"_Middle dir_left",this.base._autoSkinUpdate=!0,this.base.oncontextmenu&&(this.base._oldContextMenuHandler=this.base.oncontextmenu),this.conf.ctx_baseid=this.base.id,this.base.onselectstart=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},this.base.oncontextmenu=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1}):this.base=document.body,this.idPrefix="",this.topId="dhxWebMenuTopId",this.idPull={},this.itemPull={},this.userData={},this.radio={},this.setSkin=function(e){var t,i=this.conf.skin;switch(this.conf.skin=e,this.conf.skin){case"dhx_skyblue":case"dhx_web":this.conf.tl_botmarg=2,this.conf.tl_rmarg=1,this.conf.tl_ofsleft=1;break;case"dhx_terrace":this.conf.tl_botmarg=0,this.conf.tl_rmarg=0,this.conf.tl_ofsleft=0}for(t in this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+i+"_Middle","")+" dhtmlxMenu_"+this.conf.skin+"_Middle"),this.idPull)this.idPull[t].className=String(this.idPull[t].className).replace(i,this.conf.skin)},this.setSkin(this.conf.skin),this._addSubItemToSelected=function(e,t){for(var i=!0,n=0;n<this.conf.selected_sub.length;n++)this.conf.selected_sub[n][0]==e&&this.conf.selected_sub[n][1]==t&&(i=!1);return 1==i&&this.conf.selected_sub.push(new Array(e,t)),i},this._removeSubItemFromSelected=function(e,t){for(var i=new Array,n=!1,a=0;a<this.conf.selected_sub.length;a++)this.conf.selected_sub[a][0]==e&&this.conf.selected_sub[a][1]==t?n=!0:i[i.length]=this.conf.selected_sub[a];return 1==n&&(this.conf.selected_sub=i),n},this._getSubItemToDeselectByPolygon=function(e){for(var t=new Array,i=0;i<this.conf.selected_sub.length;i++)if(this.conf.selected_sub[i][1]==e){t[t.length]=this.conf.selected_sub[i][0];for(var t=t.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[i][0])),n=!0,a=0;a<this.conf.opened_poly.length;a++)this.conf.opened_poly[a]==this.conf.selected_sub[i][0]&&(n=!1);1==n&&(this.conf.opened_poly[this.conf.opened_poly.length]=this.conf.selected_sub[i][0]),this.conf.selected_sub[i][0]=-1,this.conf.selected_sub[i][1]=-1}return t},this._hidePolygon=function(e){if(null!=this.idPull["polygon_"+e]){if(null!=this.idPull["polygon_"+e]._zId&&window.dhx4.zim.clear(this.idPull["polygon_"+e]._zId),void 0!==this._menuEffect&&!1!==this._menuEffect)this._hidePolygonEffect("polygon_"+e);else{if("none"==this.idPull["polygon_"+e].style.display)return;this.idPull["polygon_"+e].style.display="none",null!=this.idPull["arrowup_"+e]&&(this.idPull["arrowup_"+e].style.display="none"),null!=this.idPull["arrowdown_"+e]&&(this.idPull["arrowdown_"+e].style.display="none"),this._updateItemComplexState(e,!0,!1),window.dhx4.isIE6&&null!=this.idPull["polygon_"+e+"_ie6cover"]&&(this.idPull["polygon_"+e+"_ie6cover"].style.display="none")}(e=String(e).replace(this.idPrefix,""))==this.topId&&(e=null),this.callEvent("onHide",[e]),null!=e&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+e].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+e,!0)}},this._showPolygon=function(e,t){var i,n,a,o,r,s,l,d,_,h,c,u,m,f=this._countVisiblePolygonItems(e);0==f||null!=this.idPull[i="polygon_"+e]&&null!=this.idPull[e]&&(this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context&&!this.idPull[e]._mouseOver&&t==this.conf.dir_toplv||(this.conf.fixed_pos||this._autoDetectVisibleArea(),h=n=0,(m=_=null)==this.idPull[i]._zId&&(this.idPull[i]._zId=window.dhx4.newId()),this.idPull[i]._zInd=window.dhx4.zim.reserve(this.idPull[i]._zId),this.idPull[i].style.visibility="hidden",this.idPull[i].style.left="0px",this.idPull[i].style.top="0px",this.idPull[i].style.display="",this.idPull[i].style.zIndex=this.idPull[i]._zInd,this.conf.auto_overflow&&(this.idPull[i].firstChild.offsetHeight>this.conf.v.y1+this.conf.v.y2?(d=Math.floor((this.conf.v.y2-this.conf.v.y1-35)/24),this.conf.overflow_limit=d):(this.conf.overflow_limit=0,null!=this.idPull["arrowup_"+e]&&this._removeUpArrow(String(e).replace(this.idPrefix,"")),null!=this.idPull["arrowdown_"+e]&&this._removeDownArrow(String(e).replace(this.idPrefix,"")))),0<this.conf.overflow_limit&&this.conf.overflow_limit<f&&(null==this.idPull["arrowup_"+e]&&this._addUpArrow(String(e).replace(this.idPrefix,"")),null==this.idPull["arrowdown_"+e]&&this._addDownArrow(String(e).replace(this.idPrefix,"")),(_=this.idPull["arrowup_"+e]).style.display="none",(m=this.idPull["arrowdown_"+e]).style.display="none"),0<this.conf.overflow_limit&&(this.conf.overflow_limit<f?(this.idPull[i].childNodes[1].style.height=24*this.conf.overflow_limit+"px",_.style.width=m.style.width=this.idPull[i].childNodes[1].style.width=this.idPull[i].childNodes[1].childNodes[0].offsetWidth+"px",this.idPull[i].childNodes[1].scrollTop=0,_.style.display="",n=_.offsetHeight,m.style.display="",h=m.offsetHeight):(this.idPull[i].childNodes[1].style.height="",this.idPull[i].childNodes[1].style.width="")),null!=this.itemPull[e]?this.itemPull[e].parent:this.conf.context&&this.idPull[this.idPrefix+this.topId],a=null!=this.idPull[e].tagName?window.dhx4.absLeft(this.idPull[e]):this.idPull[e][0],o=null!=this.idPull[e].tagName?window.dhx4.absTop(this.idPull[e]):this.idPull[e][1],r=null!=this.idPull[e].tagName?this.idPull[e].offsetWidth:0,s=null!=this.idPull[e].tagName?this.idPull[e].offsetHeight:0,d=l=0,_=this.idPull[i].offsetWidth,h=this.idPull[i].childNodes[1].offsetHeight+n+h,"bottom"==t&&(l=this.conf.rtl?a+(null!=r?r:0)-_:"right"==this.conf.align?a+r-_:a-1+(t==this.conf.dir_toplv?this.conf.tl_rmarg:0),d=o-1+s+this.conf.tl_botmarg),"right"==t&&(l=a+r-1,d=o+2),"left"==t&&(l=a-this.idPull[i].offsetWidth+2,d=o+2),"top"==t&&(l=a-1,d=o-h+2),this.conf.fixed_pos?u=c=65536:(c=null!=this.conf.v.x2?this.conf.v.x2:0,u=null!=this.conf.v.y2?this.conf.v.y2:0,0==c&&(u=window.innerWidth?(c=window.innerWidth,window.innerHeight):(c=document.body.offsetWidth,document.body.scrollHeight))),(l=(l=c<l+_&&!this.conf.rtl?a-_+2:l)<this.conf.v.x1&&this.conf.rtl?a+r-2:l)<0&&(l=0),u<d+h&&null!=this.conf.v.y2&&(d=Math.max(o+s-h+2,this.conf.v_enabled?this.conf.v.y1+2:2),this.conf.context&&this.idPrefix+this.topId==e&&null!=m&&(d-=2),null==this.itemPull[e]||this.conf.context||this.itemPull[e].parent==this.idPrefix+this.topId&&(d-=this.base.offsetHeight)),this.idPull[i].style.left=l+"px",this.idPull[i].style.top=d+"px",void 0!==this._menuEffect&&!1!==this._menuEffect?this._showPolygonEffect(i):(this.idPull[i].style.visibility="",0<this.conf.overflow_limit&&this.conf.overflow_limit<f&&(this.idPull[i].childNodes[1].scrollTop=0,this._checkArrowsState(e)),window.dhx4.isIE6&&(null==this.idPull[m=i+"_ie6cover"]&&((f=document.createElement("IFRAME")).className="dhtmlxMenu_IE6CoverFix_"+this.conf.skin,f.frameBorder=0,f.setAttribute("src","javascript:false;"),document.body.insertBefore(f,document.body.firstChild),this.idPull[m]=f),this.idPull[m].style.left=l+"px",this.idPull[m].style.top=d+"px",this.idPull[m].style.width=this.idPull[i].offsetWidth+"px",this.idPull[m].style.height=this.idPull[i].offsetHeight+"px",this.idPull[m].style.zIndex=this.idPull[i].style.zIndex-1,this.idPull[m].style.display="")),(e=String(e).replace(this.idPrefix,""))==this.topId&&(e=null),this.callEvent("onShow",[e]),null!=e&&"dhx_terrace"==this.conf.skin&&this.itemPull[this.idPrefix+e].parent==this.idPrefix+this.topId&&this._improveTerraceButton(this.idPrefix+e,!1)))},this._redistribSubLevelSelection=function(e,t){for(;0<this.conf.opened_poly.length;)this.conf.opened_poly.pop();var i=this._getSubItemToDeselectByPolygon(t);this._removeSubItemFromSelected(-1,-1);for(var n=0;n<i.length;n++)null!=this.idPull[i[n]]&&i[n]!=e&&"enabled"==this.itemPull[i[n]].state&&(this.idPull[i[n]].className="sub_item");for(var a,n=0;n<this.conf.opened_poly.length;n++)this.conf.opened_poly[n]!=t&&this._hidePolygon(this.conf.opened_poly[n]);"enabled"==this.itemPull[e].state&&(this.idPull[e].className="sub_item_selected",this.itemPull[e].complex&&this.conf.dload&&"no"==this.itemPull[e].loaded&&(1==this.conf.dload_icon&&this._updateLoaderIcon(e,!0),this.itemPull[e].loaded="get",a=e.replace(this.idPrefix,""),this._dhxdataload.onBeforeXLS=function(){var e,t={params:{}};for(e in t.params[this.conf.dload_pid]=a,this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)),(this.itemPull[e].complex||this.conf.dload&&"yes"==this.itemPull[e].loaded)&&this.itemPull[e].complex&&null!=this.idPull["polygon_"+e]&&(this._updateItemComplexState(e,!0,!0),this._showPolygon(e,this.conf.dir_sublv)),this._addSubItemToSelected(e,t),this.conf.selected=e)},this._doOnClick=function(e,t,i){if(this.conf.last_click=e,null!=this.itemPull[this.idPrefix+e].href_link&&"enabled"==this.itemPull[this.idPrefix+e].state){var n=document.createElement("FORM"),a=String(this.itemPull[this.idPrefix+e].href_link).split("?");if(n.action=a[0],null!=a[1])for(var o=String(a[1]).split("&"),r=0;r<o.length;r++){var s=String(o[r]).split("="),l=document.createElement("INPUT");l.type="hidden",l.name=s[0]||"",l.value=s[1]||"",n.appendChild(l)}return null!=this.itemPull[this.idPrefix+e].href_target&&(n.target=this.itemPull[this.idPrefix+e].href_target),n.style.display="none",document.body.appendChild(n),n.submit(),void(null!=n&&(document.body.removeChild(n),n=null))}if("c"!=t.charAt(0)&&"d"!=t.charAt(1)&&"s"!=t.charAt(2)){if(this.checkEvent("onClick"))this.callEvent("onClick",[e,this.conf.ctx_zoneid,i]);else if("d"==t.charAt(1)||"win"==this.conf.mode&&"t"==t.charAt(2))return;this.conf.context&&this._isContextMenuVisible()&&this.conf.ctx_autohide?this._hideContextMenu():this._clearAndHide&&this._clearAndHide()}},this._doOnTouchMenu=function(e){0==this.conf.is_touched&&(this.conf.is_touched=!0,this.checkEvent("onTouch")&&this.callEvent("onTouch",[e]))},this._searchMenuNode=function(e,t){for(var i,n=new Array,a=0;a<t.length;a++)"object"==typeof t[a]&&(5==t[a].length&&"object"!=typeof t[a][0]&&t[a][0].replace(this.idPrefix,"")==e&&0==a&&(n=t),0<(i=this._searchMenuNode(e,t[a])).length&&(n=i));return n},this._getMenuNodes=function(e){var t,i=new Array;for(t in this.itemPull)this.itemPull[t].parent==e&&(i[i.length]=t);return i},this._genStr=function(e){for(var t="",i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=0;n<e;n++)t+=i.charAt(Math.round(Math.random()*(i.length-1)));return t},this.getItemType=function(e){return e=this.idPrefix+e,null==this.itemPull[e]?null:this.itemPull[e].type},this.forEachItem=function(e){for(var t in this.itemPull)e(String(t).replace(this.idPrefix,""))},this._clearAndHide=function(){for(a.conf.selected=-1,a.conf.last_click=-1;0<a.conf.opened_poly.length;)a.conf.opened_poly.pop();for(var e=0;e<a.conf.selected_sub.length;e++){var t=a.conf.selected_sub[e][0];null!=a.idPull[t]&&"enabled"==a.itemPull[t].state&&("sub_item_selected"==a.idPull[t].className&&(a.idPull[t].className="sub_item"),a.idPull[t].className=="dhtmlxMenu_"+a.conf.skin+"_TopLevel_Item_Selected"&&(null!=a.itemPull[t].cssNormal?a.idPull[t].className=a.itemPull[t].cssNormal:a.idPull[t].className="dhtmlxMenu_"+a.conf.skin+"_TopLevel_Item_Normal")),a._hidePolygon(t)}a.conf.is_touched=!1,a.conf.context&&a.conf.ctx_hideall&&a._hidePolygon(a.idPrefix+a.topId)},this._showSubLevelItem=function(e,t){null!=document.getElementById("arrow_"+this.idPrefix+e)&&(document.getElementById("arrow_"+this.idPrefix+e).style.display=t?"none":""),null!=document.getElementById("image_"+this.idPrefix+e)&&(document.getElementById("image_"+this.idPrefix+e).style.display=t?"none":""),null!=document.getElementById(this.idPrefix+e)&&(document.getElementById(this.idPrefix+e).style.display=t?"":"none")},this._hideSubLevelItem=function(e){this._showSubLevelItem(e,!0)},this.idPrefix=this._genStr(12)+"_",this._bodyClick=function(e){2==(e=e||event).button||window.dhx4.isOpera&&1==e.ctrlKey||(a.conf.context?a.conf.ctx_autohide&&(!window.dhx4.isOpera||a._isContextMenuVisible()&&window.dhx4.isOpera)&&a._hideContextMenu():a._clearAndHide&&a._clearAndHide())},this._bodyContext=function(e){e=e||event;var t=String((e.srcElement||e.target).className);if(-1==t.search("dhtmlxMenu")||-1==t.search("SubLevelArea")){for(var i=!0,n=e.target||e.srcElement;null!=n;)null!=n.id&&a.isContextZone(n.id)&&(i=!1),n==document.body&&(i=!1),n=n.parentNode;i&&a.hideContextMenu()}},void 0!==window.addEventListener?(window.addEventListener("click",this._bodyClick,!1),window.addEventListener("contextmenu",this._bodyContext,!1)):(document.body.attachEvent("onclick",this._bodyClick),document.body.attachEvent("oncontextmenu",this._bodyContext)),this.unload=function(){window.dhx4._eventable(this,"clear"),dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=null;try{delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]}catch(e){}if(this.conf.live_id=null,"function"==typeof window.addEventListener?(window.removeEventListener("click",this._bodyClick,!1),window.removeEventListener("contextmenu",this._bodyContext,!1)):(document.body.detachEvent("onclick",this._bodyClick),document.body.detachEvent("oncontextmenu",this._bodyContext)),this._bodyClick=null,this._bodyContext=null,this.removeItem(this.idPrefix+this.topId,!0),this.itemPull=null,this.idPull=null,this.conf.context)for(var e in this.conf.ctx_zones)this.removeContextZone(e);for(var e in null!=this.cont&&(this.cont.className="",this.cont.parentNode.removeChild(this.cont),this.cont=null),null!=this.base&&(this.base.className="",this.conf.context||(this.base.oncontextmenu=this.base._oldContextMenuHandler||null),this.base.onselectstart=null,this.base=null),this)this[e]=null;a=null},dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]=this,window.dhx4._enableDataLoading(this,"_initObj","_xmlToJson",this.conf.tags.root,{struct:!0}),window.dhx4._eventable(this),1==window.dhx4.s2b(this.conf.autoload.context)&&this.renderAsContextMenu(),null!=this.conf.autoload.dynamic?this.enableDynamicLoading(this.conf.autoload.dynamic,window.dhx4.s2b(this.conf.autoload.dynamic_icon)):null!=this.conf.autoload.items?this.loadStruct(this.conf.autoload.items,this.conf.autoload.onload):null!=this.conf.autoload.json?this.loadStruct(this.conf.autoload.json,this.conf.autoload.onload):null!=this.conf.autoload.xml&&this.loadStruct(this.conf.autoload.xml,this.conf.autoload.onload),{onclick:1,oncheckboxclick:1,onradioclick:1})null!=this.conf.autoload[n]&&("function"==typeof this.conf.autoload[n]?this.attachEvent(n,this.conf.autoload[n]):"function"==typeof window[this.conf.autoload[n]]&&this.attachEvent(n,window[this.conf.autoload[n]]));for(n in null!=this.conf.autoload.top_text&&this.setTopText(this.conf.autoload.top_text),null!=this.conf.autoload.align&&this.setAlign(this.conf.autoload.align),null!=this.conf.autoload.open_mode&&this.setOpenMode(this.conf.autoload.open_mode),null!=this.conf.autoload.overflow&&this.setOverflowHeight(this.conf.autoload.overflow),this.conf.autoload)this.conf.autoload[n]=null,delete this.conf.autoload[n];return this.conf.autoload=null,this}!function(){function dtmlXMLLoaderObject(e,t,i,n){return this.xmlDoc="",this.async=void 0===i||i,this.onloadAction=e||null,this.mainObject=t||null,this.waitCall=null,this.rSeed=n||!1,this}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop||(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this)}function _dhtmlxError(e,t,i){return this.catches||(this.catches=[]),this}function dhtmlXHeir(e,t){for(var i in t)"function"==typeof t[i]&&(e[i]=t[i]);return e}window.dhtmlx||(window.dhtmlx=function(e){for(var t in e)dhtmlx[t]=e[t];return dhtmlx}),dhtmlx.extend_api=function(e,n,t){var a=window[e];a&&(window[e]=function(e){var t;if(e&&"object"==typeof e&&!e.tagName){for(var i in t=a.apply(this,n._init?n._init(e):arguments),dhtmlx)n[i]&&this[n[i]](dhtmlx[i]);for(var i in e)n[i]?this[n[i]](e[i]):0===i.indexOf("on")&&this.attachEvent(i,e[i])}else t=a.apply(this,arguments);return n._patch&&n._patch(this),t||this},window[e].prototype=a.prototype,t&&dhtmlXHeir(window[e].prototype,t))},window.dhtmlxAjax={get:function(e,t){var i=new dtmlXMLLoaderObject(!0);return i.async=arguments.length<3,i.waitCall=t,i.loadXML(e),i},post:function(e,t,i){var n=new dtmlXMLLoaderObject(!0);return n.async=arguments.length<4,n.waitCall=i,n.loadXML(e,!0,t),n},getSync:function(e){return this.get(e,null,!0)},postSync:function(e,t){return this.post(e,t,null,!0)}},window.dtmlXMLLoaderObject=dtmlXMLLoaderObject,dtmlXMLLoaderObject.count=0,dtmlXMLLoaderObject.prototype.waitLoadFunction=function(e){var t=!0;return this.check=function(){!e||!e.onloadAction||e.xmlDoc.readyState&&4!=e.xmlDoc.readyState||t&&(t=!1,dtmlXMLLoaderObject.count++,"function"==typeof e.onloadAction&&e.onloadAction(e.mainObject,null,null,null,e),e.waitCall&&(e.waitCall.call(this,e),e.waitCall=null))},this.check},dtmlXMLLoaderObject.prototype.getXMLTopNode=function(e,t){var i;if(i=this.xmlDoc.responseXML?(i=0===(i=this.xmlDoc.responseXML.getElementsByTagName(e)).length&&-1!=e.indexOf(":")?this.xmlDoc.responseXML.getElementsByTagName(e.split(":")[1]):i)[0]:this.xmlDoc.documentElement)return this._retry=!1,i;if(this._retry||!_isIE)return dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),document.createElement("div");this._retry=!0;t=this.xmlDoc;return this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(e,t)},dtmlXMLLoaderObject.prototype.loadXMLString=function(e,t){var i;_isIE?(this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(e)):(i=new DOMParser,this.xmlDoc=i.parseFromString(e,"text/xml")),t||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))},dtmlXMLLoaderObject.prototype.loadXML=function(e,t,i,n){this.rSeed&&(e+=(-1!=e.indexOf("?")?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf()),this.filePath=e,!_isIE&&window.XMLHttpRequest?this.xmlDoc=new XMLHttpRequest:this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP"),this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)),"string"==typeof t?this.xmlDoc.open(t,e,this.async):this.xmlDoc.open(t?"POST":"GET",e,this.async),n?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):t&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xmlDoc.send(i),this.async||new this.waitLoadFunction(this)()},dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,this.loadXML=null,this.loadXMLString=null,this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null},dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(e){for(var t={},i=0;i<e.attributes.length;i++)t[e.attributes[i].name]=e.attributes[i].value;t._tagvalue=e.firstChild?e.firstChild.nodeValue:"";for(i=0;i<e.childNodes.length;i++){var n=e.childNodes[i].tagName;n&&(t[n]||(t[n]=[]),t[n].push(this.xmlNodeToJSON(e.childNodes[i])))}return t},window.dhtmlDragAndDropObject=dhtmlDragAndDropObject,dhtmlDragAndDropObject.prototype.removeDraggableItem=function(e){e.onmousedown=null,e.dragStarter=null,e.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(e,t){e.onmousedown=this.preCreateDragCopy,e.dragStarter=t,this.addDragLanding(e,t)},dhtmlDragAndDropObject.prototype.addDragLanding=function(e,t){e.dragLanding=t},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(e){if(!e&&!window.event||2!=(e||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(e),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),!(!e||!e.preventDefault||(e.preventDefault(),1)))},dhtmlDragAndDropObject.prototype.callDrag=function(e){e=e||window.event;var t,i,n=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-n.downtime<100)){if(!n.dragNode){if(!n.waitDrag)return n.stopDrag(e,!0);if(n.dragNode=n.dragStartObject._createDragNode(n.dragStartNode,e),!n.dragNode)return n.stopDrag();n.dragNode.onselectstart=function(){return!1},n.gldragNode=n.dragNode,document.body.appendChild(n.dragNode),document.body.onmouseup=n.stopDrag,n.waitDrag=0,n.dragNode.pWindow=window,n.initFrameRoute()}n.dragNode.parentNode!=window.document.body&&n.gldragNode&&(t=n.gldragNode,(t=n.gldragNode.old?n.gldragNode.old:t).parentNode.removeChild(t),i=n.dragNode.pWindow,t.pWindow&&t.pWindow.dhtmlDragAndDrop.lastLanding&&t.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(t.pWindow.dhtmlDragAndDrop.lastLanding),_isIE?((t=document.createElement("div")).innerHTML=n.dragNode.outerHTML,n.dragNode=t.childNodes[0]):n.dragNode=n.dragNode.cloneNode(!0),n.dragNode.pWindow=window,n.gldragNode.old=n.dragNode,document.body.appendChild(n.dragNode),i.dhtmlDragAndDrop.dragNode=n.dragNode),n.dragNode.style.left=e.clientX+15+(n.fx?-1*n.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",n.dragNode.style.top=e.clientY+3+(n.fy?-1*n.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",i=e.srcElement||e.target,n.checkLanding(i,e)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){if(window.name){for(var t,i=parent.frames[window.name].frameElement.offsetParent,n=0,a=0;i;)n+=i.offsetLeft,a+=i.offsetTop,i=i.offsetParent;if(parent.dhtmlDragAndDrop&&(n+=+(t=parent.dhtmlDragAndDrop.calculateFramePosition(1)).split("_")[0],a+=+t.split("_")[1]),e)return n+"_"+a;this.fx=n,this.fy=a}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(e,t){e&&e.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=e,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,t.clientX,t.clientY,t),this.lastLanding_scr=_isIE?t.srcElement:t.target):e&&"BODY"!=e.tagName?this.checkLanding(e.parentNode,t):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,t.clientX,t.clientY,t),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(e,t){var i=window.dhtmlDragAndDrop;t||(i.stopFrameRoute(),t=i.lastLanding,i.lastLanding=null,t&&t.dragLanding._drag(i.dragStartNode,i.dragStartObject,t,_isIE?event.srcElement:e.target)),i.lastLanding=null,i.dragNode&&i.dragNode.parentNode==document.body&&i.dragNode.parentNode.removeChild(i.dragNode),i.dragNode=0,i.gldragNode=0,i.fx=0,i.fy=0,i.dragStartNode=0,i.dragStartObject=0,document.body.onmouseup=i.tempDOMU,document.body.onmousemove=i.tempDOMM,i.tempDOMU=null,i.tempDOMM=null,i.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(e){e&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var t=0;t<window.frames.length;t++)try{window.frames[t]!=e&&window.frames[t].dhtmlDragAndDrop&&window.frames[t].dhtmlDragAndDrop.stopFrameRoute(window)}catch(e){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(e){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(e,t){e&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=e.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=e.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=e.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=e.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&t&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(e){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=e&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!e||t?1:0)}catch(e){}};var _isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1;-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),-1<navigator.userAgent.toLowerCase().indexOf("chrome")&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),525<_KHTMLrv?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,-1==navigator.appVersion.indexOf("MSIE 8.0")&&-1==navigator.appVersion.indexOf("MSIE 9.0")&&-1==navigator.appVersion.indexOf("MSIE 10.0")||"BackCompat"==document.compatMode||(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),dtmlXMLLoaderObject.prototype.doXPath=function(e,t,i,n){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(e,t);if(_isIE)return(t=t||(this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML))||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),i&&t.setProperty("SelectionNamespaces","xmlns:xsl='"+i+"'"),"single"==n?t.selectSingleNode(e):t.selectNodes(e)||new Array(0);var a=t;(t=t||(this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML))||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),-1!=t.nodeName.indexOf("document")?a=t:t=(a=t).ownerDocument;var o=XPathResult.ANY_TYPE;"single"==n&&(o=XPathResult.FIRST_ORDERED_NODE_TYPE);var r=[],s=t.evaluate(e,a,function(e){return i},o,null);if(o==XPathResult.FIRST_ORDERED_NODE_TYPE)return s.singleNodeValue;for(var l=s.iterateNext();l;)r[r.length]=l,l=s.iterateNext();return r},_dhtmlxError.prototype.catchError=function(e,t){this.catches[e]=t},_dhtmlxError.prototype.throwError=function(e,t,i){return this.catches[e]?this.catches[e](e,t,i):this.catches.ALL?this.catches.ALL(e,t,i):(window.alert("Error type: "+e+"\nDescription: "+t),null)},window.dhtmlxError=new _dhtmlxError,dtmlXMLLoaderObject.prototype.doXPathOpera=function(e,t){var i=e.replace(/[\/]+/gi,"/").split("/"),n=null,a=1;if(!i.length)return[];if("."==i[0])n=[t];else{if(""!==i[0])return[];n=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(i[a].replace(/\[[^\]]*\]/g,"")),a++}for(;a<i.length;a++)n=this._getAllNamedChilds(n,i[a]);return n=-1!=i[a-1].indexOf("[")?this._filterXPath(n,i[a-1]):n},dtmlXMLLoaderObject.prototype._filterXPath=function(e,t){for(var i=[],t=t.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),n=0;n<e.length;n++)e[n].getAttribute(t)&&(i[i.length]=e[n]);return i},dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,t){var i=[];_isKHTML&&(t=t.toUpperCase());for(var n=0;n<e.length;n++)for(var a=0;a<e[n].childNodes.length;a++)_isKHTML?e[n].childNodes[a].tagName&&e[n].childNodes[a].tagName.toUpperCase()==t&&(i[i.length]=e[n].childNodes[a]):e[n].childNodes[a].tagName==t&&(i[i.length]=e[n].childNodes[a]);return i},void 0===window.dhtmlxEvent&&(window.dhtmlxEvent=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)}),dtmlXMLLoaderObject.prototype.xslDoc=null,dtmlXMLLoaderObject.prototype.setXSLParamValue=function(e,t,i){(i=i||this.xslDoc).responseXML&&(i=i.responseXML);i=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+e+"']",i,"http://www.w3.org/1999/XSL/Transform","single");i&&(i.firstChild.nodeValue=t)},dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(t,i){var n;if((t=t||this.xslDoc).responseXML&&(t=t.responseXML),(i=i||this.xmlDoc).responseXML&&(i=i.responseXML),_isIE){n=new ActiveXObject("Msxml2.DOMDocument.3.0");try{i.transformNodeToObject(t,n)}catch(e){n=i.transformNode(t)}}else this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(t)),n=this.XSLProcessor.transformToDocument(i);return n},dtmlXMLLoaderObject.prototype.doXSLTransToString=function(e,t){t=this.doXSLTransToObject(e,t);return"string"==typeof t?t:this.doSerialization(t)},dtmlXMLLoaderObject.prototype.doSerialization=function(e){return(e=e||this.xmlDoc).responseXML&&(e=e.responseXML),_isIE?e.xml:(new XMLSerializer).serializeToString(e)},window.dhtmlxEventable=function(obj){obj.attachEvent=function(e,t,i){return this[e="ev_"+e.toLowerCase()]||(this[e]=new this.eventCatcher(i||this)),e+":"+this[e].addEvent(t)},obj.callEvent=function(e,t){return!this[e="ev_"+e.toLowerCase()]||this[e].apply(this,t)},obj.checkEvent=function(e){return!!this["ev_"+e.toLowerCase()]},obj.eventCatcher=function(obj){var dhx_catch=[],z=function(){for(var e,t=!0,i=0;i<dhx_catch.length;i++)dhx_catch[i]&&(e=dhx_catch[i].apply(obj,arguments),t=t&&e);return t};return z.addEvent=function(ev){return"function"!=typeof ev&&(ev=eval(ev)),!!ev&&dhx_catch.push(ev)-1},z.removeEvent=function(e){dhx_catch[e]=null},z},obj.detachEvent=function(e){e&&this[(e=e.split(":"))[0]].removeEvent(e[1])},obj.detachAllEvents=function(){for(var e in this)0===e.indexOf("ev_")&&(this.detachEvent(e),this[e]=null)}},window.dhtmlx||(window.dhtmlx={}),function(){function d(t,i){setTimeout(function(){var e;t.box&&(e=t.callback,o(!1),t.box.parentNode.removeChild(t.box),dhtmlx.callEvent("onAfterMessagePopup",[t.box]),h=t.box=null,e&&e(i))},1)}function a(e){if(h){var t,i=(e=e||event).which||event.keyCode,n=!1;if(dhtmlx.message.keyboard&&(13!=i&&32!=i||(t=e.target||e.srcElement,-1<scheduler._getClassName(t).indexOf("dhtmlx_popup_button")&&t.click?t.click():(d(h,!0),n=!0)),27==i&&(d(h,!1),n=!0)),n)return e.preventDefault&&e.preventDefault(),!(e.cancelBubble=!0)}}function o(e){o.cover||(o.cover=document.createElement("div"),o.cover.onkeydown=a,o.cover.className="dhx_modal_cover",document.body.appendChild(o.cover)),document.body.scrollHeight,o.cover.style.display=e?"inline-block":"none"}function _(e,t,i){return"<div "+scheduler._waiAria.messageButtonAttrString(e)+"class='dhtmlx_popup_button dhtmlx_"+(i||e||"").toLowerCase().replace(/ /g,"_")+"_button' result='"+t+"' ><div>"+e+"</div></div>"}function t(e,t,i){var n=e.tagName?e:function(i,e,t){var n=document.createElement("div");n.className=" dhtmlx_modal_box dhtmlx-"+i.type,n.setAttribute("dhxbox",1);var a=scheduler.uid();scheduler._waiAria.messageModalAttr(n,a);var o,r="",s=!1;if(i.width&&(n.style.width=i.width),i.height&&(n.style.height=i.height),i.title&&(r+='<div class="dhtmlx_popup_title" id="'+a+'">'+i.title+"</div>",s=!0),r+='<div class="dhtmlx_popup_text" '+(s?"":' id="'+a+'" ')+"><span>"+(i.content?"":i.text)+'</span></div><div  class="dhtmlx_popup_controls">',e&&(r+=_(e=void 0===(e=i.ok||scheduler.locale.labels.message_ok)?"OK":e,!0,"ok")),t&&(r+=_(o=void 0===(o=i.cancel||scheduler.locale.labels.message_cancel)?"Cancel":o,!1,"cancel")),i.buttons)for(var l=0;l<i.buttons.length;l++)r+=_(i.buttons[l],l);return n.innerHTML=r+="</div>",i.content&&("none"==(o="string"==typeof(o=i.content)?document.getElementById(o):o).style.display&&(o.style.display=""),n.childNodes[i.title?1:0].appendChild(o)),n.onclick=function(e){var t=(e=e||event).target||e.srcElement,e=scheduler._getClassName(t);e||(t=t.parentNode),"dhtmlx_popup_button"==(e=scheduler._getClassName(t)).split(" ")[0]&&(t=t.getAttribute("result"),d(i,t="true"==t||"false"!=t&&t))},i.box=n,h=i,n}(e,t,i);e.hidden||o(!0),document.body.appendChild(n);t=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-n.offsetWidth)/2)),i=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-n.offsetHeight)/2));return"top"==e.position?n.style.top="-3px":n.style.top=i+"px",n.style.left=t+"px",n.onkeydown=a,dhtmlx.modalbox.focus(n),e.hidden&&dhtmlx.modalbox.hide(n),dhtmlx.callEvent("onMessagePopup",[n]),n}function r(e){return t(e,!0,!1)}function s(e){return t(e,!0,!0)}function l(e){return t(e)}function i(e,t,i){return"object"!=typeof e&&("function"==typeof t&&(i=t,t=""),e={text:e,type:t,callback:i}),e}var h=null;document.attachEvent?document.attachEvent("onkeydown",a):document.addEventListener("keydown",a,!0),dhtmlx.alert=function(){var e=i.apply(this,arguments);return e.type=e.type||"confirm",r(e)},dhtmlx.confirm=function(){var e=i.apply(this,arguments);return e.type=e.type||"alert",s(e)},dhtmlx.modalbox=function(){var e=i.apply(this,arguments);return e.type=e.type||"alert",l(e)},dhtmlx.modalbox.hide=function(e){for(;e&&e.getAttribute&&!e.getAttribute("dhxbox");)e=e.parentNode;e&&(e.parentNode.removeChild(e),o(!1))},dhtmlx.modalbox.focus=function(t){setTimeout(function(){var e=scheduler._getFocusableNodes(t);e.length&&e[0].focus&&e[0].focus()},1)};var c=dhtmlx.message=function(e,t,i,n){switch((e=function(e,t,i,n){return(e="object"!=typeof e?{text:e,type:t,expire:i,id:n}:e).id=e.id||c.uid(),e.expire=e.expire||c.expire,e}.apply(this,arguments)).type=e.type||"info",e.type.split("-")[0]){case"alert":return r(e);case"confirm":return s(e);case"modalbox":return l(e);default:return function(e){c.area||(c.area=document.createElement("div"),c.area.className="dhtmlx_message_area",c.area.style[c.position]="5px",document.body.appendChild(c.area)),c.hide(e.id);var t=document.createElement("div");return t.innerHTML="<div>"+e.text+"</div>",t.className="dhtmlx-info dhtmlx-"+e.type,t.onclick=function(){c.hide(e.id),e=null},scheduler._waiAria.messageInfoAttr(t),"bottom"==c.position&&c.area.firstChild?c.area.insertBefore(t,c.area.firstChild):c.area.appendChild(t),0<e.expire&&(c.timers[e.id]=window.setTimeout(function(){c.hide(e.id)},e.expire)),c.pull[e.id]=t,t=null,e.id}(e)}};c.seed=(new Date).valueOf(),c.uid=function(){return c.seed++},c.expire=4e3,c.keyboard=!0,c.position="top",c.pull={},c.timers={},c.hideAll=function(){for(var e in c.pull)c.hide(e)},c.hide=function(e){var t=c.pull[e];t&&t.parentNode&&(window.setTimeout(function(){t.parentNode.removeChild(t),t=null},2e3),t.className+=" hidden",c.timers[e]&&window.clearTimeout(c.timers[e]),delete c.pull[e])}}(),dhtmlx.attachEvent||dhtmlxEventable(dhtmlx);var dataProcessor=window.dataProcessor=function(e){return this.serverProcessor=e,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhtmlxEventable(this),this};dataProcessor.prototype={setTransactionMode:function(e,t){"object"==typeof e?(this._tMode=e.mode||this._tMode,void 0!==e.headers&&(this._headers=e.headers),void 0!==e.payload&&(this._payload=e.payload)):(this._tMode=e,this._tSend=t),"REST"==this._tMode&&(this._tSend=!1,this._endnm=!0),"JSON"==this._tMode&&(this._tSend=!1,this._endnm=!0,this._headers=this._headers||{},this._headers["Content-type"]="application/json"),this._headers&&!this._headers["Content-Type"]&&(this._headers["Content-Type"]="application/x-www-form-urlencoded")},escape:function(e){return(this._utf?encodeURIComponent:escape)(e)},enableUTFencoding:function(e){this._utf=!!e},setDataColumns:function(e){this._columns="string"==typeof e?e.split(","):e},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(e){this._endnm=!!e},enablePartialDataSend:function(e){this._changed=!!e},setUpdateMode:function(e,t){this.autoUpdate="cell"==e,this.updateMode=e,this.dnd=t},ignore:function(e,t){this._silent_mode=!0,e.call(t||window),this._silent_mode=!1},setUpdated:function(e,t,i){var n,a;this._silent_mode||(n=this.findRow(e),i=i||"updated",(a=this.obj.getUserData(e,this.action_param))&&"updated"==i&&(i=a),t?(this.set_invalid(e,!1),this.updatedRows[n]=e,this.obj.setUserData(e,this.action_param,i),this._in_progress[e]&&(this._in_progress[e]="wait")):this.is_invalid(e)||(this.updatedRows.splice(n,1),this.obj.setUserData(e,this.action_param,"")),t||this._clearUpdateFlag(e),this.markRow(e,t,i),t&&this.autoUpdate&&this.sendData(e))},_clearUpdateFlag:function(e){},markRow:function(e,t,i){var n="",a=this.is_invalid(e);if(a&&(n=this.styles[a],t=!0),this.callEvent("onRowMark",[e,t,i,a])&&(n=this.styles[t?i:"clear"]+n,this.obj[this._methods[0]](e,n),a&&a.details)){n+=this.styles[a+"_cell"];for(var o=0;o<a.details.length;o++)a.details[o]&&this.obj[this._methods[1]](e,o,n)}},getState:function(e){return this.obj.getUserData(e,this.action_param)},is_invalid:function(e){return this._invalid[e]},set_invalid:function(e,t,i){i&&(t={value:t,details:i,toString:function(){return this.value.toString()}}),this._invalid[e]=t},checkBeforeUpdate:function(e){return!0},sendData:function(e){if(!this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2)return this.obj.editStop&&this.obj.editStop(),void 0===e||this._tSend?this.sendAllData():!this._in_progress[e]&&(this.messages=[],!(!this.checkBeforeUpdate(e)&&this.callEvent("onValidationError",[e,this.messages]))&&void this._beforeSendData(this._getRowData(e),e))},_beforeSendData:function(e,t){if(!this.callEvent("onBeforeUpdate",[t,this.getState(t),e]))return!1;this._sendData(e,t)},serialize:function(e,t){if("string"==typeof e)return e;if(void 0!==t)return this.serialize_one(e,"");var i,n=[],a=[];for(i in e)e.hasOwnProperty(i)&&(n.push(this.serialize_one(e[i],i+this.post_delim)),a.push(i));return n.push("ids="+this.escape(a.join(","))),(scheduler.security_key||dhtmlx.security_key)&&n.push("dhx_security="+(scheduler.security_key||dhtmlx.security_key)),n.join("&")},serialize_one:function(e,t){if("string"==typeof e)return e;var i,n=[];for(i in e)if(e.hasOwnProperty(i)){if(("id"==i||i==this.action_param)&&"REST"==this._tMode)continue;n.push(this.escape((t||"")+i)+"="+this.escape(e[i]))}return n.join("&")},_applyPayload:function(e){var t=this.obj.$ajax;if(this._payload)for(var i in this._payload)e=e+t.urlSeparator(e)+this.escape(i)+"="+this.escape(this._payload[i]);return e},_sendData:function(n,a){if(n){if(!this.callEvent("onBeforeDataSending",a?[a,this.getState(a),n]:[null,null,n]))return!1;a&&(this._in_progress[a]=(new Date).valueOf());function e(e){var t=[];if(a)t.push(a);else if(n)for(var i in n)t.push(i);return o.afterUpdate(o,e,t)}var o=this,t=this.obj.$ajax,i=this.serverProcessor+(this._user?t.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):""),r=this._applyPayload(i);if("GET"==this._tMode)t.query({url:r+t.urlSeparator(r)+this.serialize(n,a),method:"GET",callback:e,headers:this._headers});else if("POST"==this._tMode)t.query({url:r,method:"POST",headers:this._headers,data:this.serialize(n,a),callback:e});else if("JSON"==this._tMode){var s,l=n[this.action_param],d={};for(s in n)d[s]=n[s];delete d[this.action_param],delete d.id,delete d.gr_id,t.query({url:r,method:"POST",headers:this._headers,callback:e,data:JSON.stringify({id:a,action:l,data:d})})}else"REST"==this._tMode&&(r=this.getState(a),l=i.replace(/(\&|\?)editing\=true/,""),d="",i="post","inserted"==r?d=this.serialize(n,a):l=("deleted"==r?i="DELETE":(i="PUT",d=this.serialize(n,a)),l+("/"==l.slice(-1)?"":"/")+a),l=this._applyPayload(l),t.query({url:l,method:i,headers:this._headers,data:d,callback:e}));this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var e=!0,t=0;t<this.updatedRows.length;t++)e&=this.checkBeforeUpdate(this.updatedRows[t]);if(!e&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(t=0;t<this.updatedRows.length;t++)if(!this._in_progress[this.updatedRows[t]]){if(this.is_invalid(this.updatedRows[t]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[t]),this.updatedRows[t]),this._waitMode&&("tree"==this.obj.mytype||this.obj._h2))return}}},_getAllData:function(e){for(var t={},i=!1,n=0;n<this.updatedRows.length;n++){var a,o=this.updatedRows[n];this._in_progress[o]||this.is_invalid(o)||(a=this._getRowData(o),this.callEvent("onBeforeUpdate",[o,this.getState(o),a])&&(t[o]=a,i=!0,this._in_progress[o]=(new Date).valueOf()))}return i?t:null},setVerificator:function(e,t){this.mandatoryFields[e]=t||function(e){return""!==e}},clearVerificator:function(e){this.mandatoryFields[e]=!1},findRow:function(e){for(var t=0,t=0;t<this.updatedRows.length&&e!=this.updatedRows[t];t++);return t},defineAction:function(e,t){this._uActions||(this._uActions=[]),this._uActions[e]=t},afterUpdateCallback:function(e,t,i,n){var a=e,o="error"!=i&&"invalid"!=i;if(o||this.set_invalid(e,i),this._uActions&&this._uActions[i]&&!this._uActions[i](n))return delete this._in_progress[a];"wait"!=this._in_progress[a]&&this.setUpdated(e,!1);var r=e;switch(i){case"inserted":case"insert":t!=e&&(this.setUpdated(e,!1),this.obj[this._methods[2]](e,t),e=t);break;case"delete":case"deleted":return this.obj.setUserData(e,this.action_param,"true_deleted"),this.obj[this._methods[3]](e,t),delete this._in_progress[a],this.callEvent("onAfterUpdate",[e,i,t,n])}"wait"!=this._in_progress[a]?(o&&this.obj.setUserData(e,this.action_param,""),delete this._in_progress[a]):(delete this._in_progress[a],this.setUpdated(t,!0,this.obj.getUserData(e,this.action_param))),this.callEvent("onAfterUpdate",[r,i,t,n])},_errorResponse:function(e,t){return this.obj&&this.obj.callEvent&&this.obj.callEvent("onSaveError",[t,e.xmlDoc]),this.cleanUpdate(t)},afterUpdate:function(e,t,i){var n=this.obj.$ajax;if(200===t.xmlDoc.status){if(window.JSON){try{s=JSON.parse(t.xmlDoc.responseText)}catch(e){t.xmlDoc.responseText.length||(s={})}if(s){var a=s.action||this.getState(i)||"updated",o=s.sid||i[0],r=s.tid||i[0];return e.afterUpdateCallback(o,r,a,s),void e.finalizeUpdate()}}var s=n.xmltop("data",t.xmlDoc);if(!s)return this._errorResponse(t,i);var l=n.xpath("//data/action",s);l.length||this._errorResponse(t,i);for(var d=0;d<l.length;d++){var _=l[d],a=_.getAttribute("type"),o=_.getAttribute("sid"),r=_.getAttribute("tid");e.afterUpdateCallback(o,r,a,_)}e.finalizeUpdate()}else this._errorResponse(t,i)},cleanUpdate:function(e){if(e)for(var t=0;t<e.length;t++)delete this._in_progress[e[t]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData(),this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(e){this.obj=e,this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(e){this.attachEvent("onAfterUpdate",e)},enableDebug:function(e){},setOnBeforeUpdateHandler:function(e){this.attachEvent("onBeforeDataSending",e)},setAutoUpdate:function(e,t){e=e||2e3,this._user=t||(new Date).valueOf(),this._need_update=!1,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(e,t,i,n){this.afterAutoUpdate(e,t,i,n)}),this.attachEvent("onFullSync",function(){this.fullSync()});var i=this;window.setInterval(function(){i.loadUpdate()},e)},afterAutoUpdate:function(e,t,i,n){return"collision"!=t||!(this._need_update=!0)},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(e,t){var i=this.obj.$ajax;if(this._update_busy)return!1;this._update_busy=!0,i.get(e,t)},_v:function(e){return e.firstChild?e.firstChild.nodeValue:""},_a:function(e){for(var t=[],i=0;i<e.length;i++)t[i]=this._v(e[i]);return t},loadUpdate:function(){var s=this.obj.$ajax,l=this,e=this.obj.getUserData(0,"version"),e=(e=this.serverProcessor+s.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+e].join("&")).replace("editing=true&","");this.getUpdates(e,function(e){var t=s.xpath("//userdata",e);l.obj.setUserData(0,"version",l._v(t[0]));var i=s.xpath("//update",e);if(i.length){l._silent_mode=!0;for(var n=0;n<i.length;n++){var a=i[n].getAttribute("status"),o=i[n].getAttribute("id"),r=i[n].getAttribute("parent");switch(a){case"inserted":l.callEvent("insertCallback",[i[n],o,r]);break;case"updated":l.callEvent("updateCallback",[i[n],o,r]);break;case"deleted":l.callEvent("deleteCallback",[i[n],o,r])}}l._silent_mode=!1}l._update_busy=!1,l=null})}},window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(e){this.init_original(e),(e._dataprocessor=this).setTransactionMode("POST",!0),this.serverProcessor+=(-1!=this.serverProcessor.indexOf("?")?"&":"?")+"editing=true"}),dhtmlxError.catchError("LoadXML",function(e,t,i){var n=i[0].responseText;switch(scheduler.config.ajax_error){case"alert":window.alert(n);break;case"console":window.console.log(n)}});var Scheduler={_seed:0,plugin:function(e){this._schedulerPlugins.push(e),e(window.scheduler)},_schedulerPlugins:[]};Scheduler.getSchedulerInstance=function(){function i(e){var t=document.createElement("div");return(e||"").split(" ").forEach(function(e){t.classList.add(e)}),t}function l(e){var t=function(e){var t;if(e.view)switch(e.view){case"today":case"next":case"prev":t=r.builtInButton;break;case"date":t=r.date;break;case"spacer":t=r.spacer;break;case"button":t=r.button;break;case"minicalendar":t=r.minicalendarButton;break;default:t=r.view}else e.rows?t=r.rows_container:e.cols&&(t=r.row);return t}(e);if(t){var i,t=t(e);return e.css&&t.classList.add(e.css),e.width&&((i=e.width)===+i&&(i+="px"),t.style.width=i),e.height&&((i=e.height)===+i&&(i+="px"),t.style.height=i),e.click&&t.addEventListener("click",e.click),e.html&&(t.innerHTML=e.html),e.align&&(i="","right"==e.align?i="flex-end":"left"==e.align&&(i="flex-start"),t.style.justifyContent=i),t}}function d(e){return(e="string"==typeof e?{view:e}:e).view||e.rows||e.cols||(e.view="button"),e}function n(e){return e.querySelector(".dhx_cal_header")&&e.querySelector(".dhx_cal_data")&&e.querySelector(".dhx_cal_navline")}function t(){if(P._is_material_skin())return!0;if(void 0!==g)return g;var e=document.createElement("div");e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.innerHTML="<div class='dhx_cal_container'><div class='dhx_cal_data'><div class='dhx_cal_event'><div class='dhx_body'></div></div><div>",document.body.appendChild(e);var t=window.getComputedStyle(e.querySelector(".dhx_body")).getPropertyValue("box-sizing");document.body.removeChild(e),(g=!("border-box"!==t))||setTimeout(function(){g=void 0},1e3)}function e(){var e;P._is_material_skin()||P._border_box_events()||(e=g,p=g=void 0,e!==t()&&P.$container&&P.setCurrentView())}var P={version:"5.3.10-pre1"},a={agenda:"https://docs.dhtmlx.com/scheduler/agenda_view.html",grid:"https://docs.dhtmlx.com/scheduler/grid_view.html",map:"https://docs.dhtmlx.com/scheduler/map_view.html",unit:"https://docs.dhtmlx.com/scheduler/units_view.html",timeline:"https://docs.dhtmlx.com/scheduler/timeline_view.html",week_agenda:"https://docs.dhtmlx.com/scheduler/weekagenda_view.html",year:"https://docs.dhtmlx.com/scheduler/year_view.html",anythingElse:"https://docs.dhtmlx.com/scheduler/views.html"},o={agenda:"ext/dhtmlxscheduler_agenda_view.js",grid:"ext/dhtmlxscheduler_grid_view.js",map:"ext/dhtmlxscheduler_map_view.js",unit:"ext/dhtmlxscheduler_units.js",timeline:"ext/dhtmlxscheduler_timeline.js, ext/dhtmlxscheduler_treetimeline.js, ext/dhtmlxscheduler_daytimeline.js",week_agenda:"ext/dhtmlxscheduler_week_agenda.js",year:"ext/dhtmlxscheduler_year_view.js",limit:"ext/dhtmlxscheduler_limit.js"};P._commonErrorMessages={unknownView:function(e){var t=o[e]?"You're probably missing "+o[e]+".":"";return"`"+e+"` view is not defined. \nPlease check parameters you pass to `scheduler.init` or `scheduler.setCurrentView` in your code and ensure you've imported appropriate extensions. \n"+("Related docs: "+(a[e]||a.anythingElse))+"\n"+(t?t+"\n":"")},collapsedContainer:function(e){return"Scheduler container height is set to *100%* but the rendered height is zero and the scheduler is not visible. \nMake sure that the container has some initial height or use different units. For example:\n<div id='scheduler_here' class='dhx_cal_container' style='width:100%; height:600px;'> \n"}},P.createTimelineView=function(){throw new Error("scheduler.createTimelineView is not implemented. Be sure to add the required extension: "+o.timeline+"\nRelated docs: "+a.timeline)},P.createUnitsView=function(){throw new Error("scheduler.createUnitsView is not implemented. Be sure to add the required extension: "+o.unit+"\nRelated docs: "+a.unit)},P.createGridView=function(){throw new Error("scheduler.createGridView is not implemented. Be sure to add the required extension: "+o.grid+"\nRelated docs: "+a.grid)},P.addMarkedTimespan=function(){throw new Error("scheduler.addMarkedTimespan is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_limit.js\nRelated docs: https://docs.dhtmlx.com/scheduler/limits.html")},P.renderCalendar=function(){throw new Error("scheduler.renderCalendar is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_minical.js\nhttps://docs.dhtmlx.com/scheduler/minicalendar.html")},P.exportToPNG=function(){throw new Error(["scheduler.exportToPNG is not implemented.","This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/png.html","Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml"].join("\n"))},P.exportToPDF=function(){throw new Error(["scheduler.exportToPDF is not implemented.","This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/pdf.html","Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml"].join("\n"))},dhtmlxEventable(P);var r={rows_container:function(){return i("dhx_cal_navbar_rows_container")},row:function(){return i("dhx_cal_navbar_row")},view:function(e){var t=i("dhx_cal_tab");return t.setAttribute("name",e.view+"_tab"),t.setAttribute("data-viewname",e.view),P.config.fix_tab_position&&(e.$firstTab?t.classList.add("dhx_cal_tab_first"):e.$lastTab?t.classList.add("dhx_cal_tab_last"):"week"!==e.view&&t.classList.add("dhx_cal_tab_standalone")),t},date:function(){return i("dhx_cal_date")},button:function(e){return i("dhx_cal_nav_button dhx_cal_nav_button_custom dhx_cal_tab")},builtInButton:function(e){return i("dhx_cal_"+e.view+"_button dhx_cal_nav_button")},spacer:function(){return i("dhx_cal_line_spacer")},minicalendarButton:function(e){var t=i("dhx_minical_icon");return e.click||(t.onclick=function(){P.isCalendarVisible()?P.destroyCalendar():P.renderCalendar({position:this,date:P.getState().date,navigation:!0,handler:function(e,t){P.setCurrentView(e),P.destroyCalendar()}})}),t},html_element:function(e){return i("dhx_cal_nav_content")}};P._init_nav_bar=function(e){var t=this.$container.querySelector(".dhx_cal_navline");return t||((t=document.createElement("div")).className="dhx_cal_navline dhx_cal_navline_flex",P._update_nav_bar(e,t),t)};var s=null;P._update_nav_bar=function(e,t){var i,n,a;e&&(n=e.height||P.xy.nav_height,a=!(a=i=!1),(i=null===s||s!==n?!0:i)&&(P.xy.nav_height=n),a&&(t.innerHTML="",t.appendChild(function e(t){for(var i=document.createDocumentFragment(),n=Array.isArray(t)?t:[t],a=0;a<n.length;a++){var o,r=d(n[a]);"day"===r.view&&n[a+1]&&("week"!==(o=d(n[a+1])).view&&"month"!==o.view||(r.$firstTab=!0)),"month"===r.view&&n[a-1]&&("week"!==(o=d(n[a-1])).view&&"day"!==o.view||(r.$lastTab=!0));var s=l(r);i.appendChild(s),(r.cols||r.rows)&&s.appendChild(e(r.cols||r.rows))}return i}(e))),(i||a)&&(P._els=[],P.get_elements(),P.set_actions()),t.style.display=0===n?"none":"",s=n)},P._detachDomEvent=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},P._init_once=function(){function r(e){return{w:e.innerWidth||document.documentElement.clientWidth,h:e.innerHeight||document.documentElement.clientHeight}}function n(n,a){var e,o=r(a);a.addEventListener("resize",function(){clearTimeout(e),e=setTimeout(function(){var e,t,i;!function(e){for(var t=document.body;e&&e!=t;)e=e.parentNode;return t==e}(n.$container)||(e=r(a),i=e,(t=o).w==i.w&&t.h==i.h||(o=e,n.callEvent("onSchedulerResize",[])&&(n.updateView(),n.callEvent("onAfterSchedulerResize",[]))))},150)})}(function(e){var t=e.$container;"static"==window.getComputedStyle(t).getPropertyValue("position")&&(t.style.position="relative");var i=document.createElement("iframe");i.className="scheduler_container_resize_watcher",i.tabIndex=-1,e.config.wai_aria_attributes&&(i.setAttribute("role","none"),i.setAttribute("aria-hidden",!0)),t.appendChild(i),i.contentWindow?n(e,i.contentWindow):(t.removeChild(i),n(e,window))})(P),P._init_once=function(){}};var _,h,c={render:function(e){return P._init_nav_bar(e)}},u={render:function(e){var t=document.createElement("div");return t.className="dhx_cal_header",t}},m={render:function(e){var t=document.createElement("div");return t.className="dhx_cal_data",t}};P.init=function(e,t,i){if(t=t||P._currentDate(),i=i||"week",this._obj&&this.unset_actions(),this._obj="string"==typeof e?document.getElementById(e):e,this.$container=this._obj,!this.$container.offsetHeight&&this.$container.offsetWidth&&"100%"===this.$container.style.height&&window.console.error(P._commonErrorMessages.collapsedContainer(),this.$container),this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&this.$container.setAttribute("role","application"),this.config.header||n(this.$container)||(this.config.header=function(t){var i=["day","week","month"];if(t.matrix)for(var e in t.matrix)i.push(e);if(t._props)for(var e in t._props)i.push(e);if(t._grid&&t._grid.names)for(var e in t._grid.names)i.push(e);return["map","agenda","week_agenda","year"].forEach(function(e){t[e+"_view"]&&i.push(e)}),i.concat(["date"]).concat(["prev","today","next"])}(this),console.log(["Required DOM elements are missing from the scheduler container and **scheduler.config.header** is not specified.","Using a default header configuration: ","scheduler.config.header = "+JSON.stringify(this.config.header,null,2),"Check this article for the details: https://docs.dhtmlx.com/scheduler/initialization.html"].join("\n"))),this.config.header)this.$container.innerHTML="",this.$container.classList.add("dhx_cal_container"),this.config.header.height&&(this.xy.nav_height=this.config.header.height),this.$container.appendChild(c.render(this.config.header)),this.$container.appendChild(u.render()),this.$container.appendChild(m.render());else if(!n(this.$container))throw new Error(["Required DOM elements are missing from the scheduler container.","Be sure to either specify them manually in the markup: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviamarkup","Or to use **scheduler.config.header** setting so they could be created automatically: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviaheaderconfig"].join("\n"));this.config.rtl&&(this.$container.className+=" dhx_cal_container_rtl"),this._skin_init&&P._skin_init(),P.date.init(),this._scroll=!0,this._quirks=this.$env.isIE&&"BackCompat"==document.compatMode,this._quirks7=this.$env.isIE&&-1==navigator.appVersion.indexOf("MSIE 8"),this._els=[],this.get_elements(),this.init_templates(),this.set_actions(),this._init_once(),this._init_touch_events(),this.set_sizes(),P.callEvent("onSchedulerReady",[]),this.setCurrentView(t,i)},P.xy={min_event_height:40,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22,event_header_height:14},P.keys={edit_save:13,edit_cancel:27},P.bind=function(e,t){return e.bind?e.bind(t):function(){return e.apply(t,arguments)}},P.set_sizes=function(){var e=this._x=this._obj.clientWidth-this.xy.margin_left,t=this._y=this._obj.clientHeight-this.xy.margin_top,i=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,n=this._table_view?-1:this.xy.scale_width,a=this.$container.querySelector(".dhx_cal_scale_placeholder");P._is_material_skin()?(a||((a=document.createElement("div")).className="dhx_cal_scale_placeholder",this.$container.insertBefore(a,this._els.dhx_cal_header[0])),a.style.display="block",this.set_xy(a,e,this.xy.scale_height+1,0,this.xy.nav_height+(this._quirks?-1:1))):a&&a.parentNode.removeChild(a),this._lightbox&&(P.$container.offsetWidth<1200||this._setLbPosition(document.querySelector(".dhx_cal_light"))),this.set_xy(this._els.dhx_cal_navline[0],e,this.xy.nav_height,0,0),this.set_xy(this._els.dhx_cal_header[0],e-i,this.xy.scale_height,n,this.xy.nav_height+(this._quirks?-1:1));n=this._els.dhx_cal_navline[0].offsetHeight;0<n&&(this.xy.nav_height=n);n=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);this.set_xy(this._els.dhx_cal_data[0],e,t-(n+2),0,n+2)},P.set_xy=function(e,t,i,n,a){var o="left";e.style.width=Math.max(0,t)+"px",e.style.height=Math.max(0,i)+"px",3<arguments.length&&(this.config.rtl&&(o="right"),e.style[o]=n+"px",e.style.top=a+"px")},P.get_elements=function(){for(var e=this._obj.getElementsByTagName("DIV"),t=0;t<e.length;t++){var i=P._getClassName(e[t]),n=e[t].getAttribute("name")||"",i=i&&i.split(" ")[0];this._els[i]||(this._els[i]=[]),this._els[i].push(e[t]);i=P.locale.labels[n||i];(i="string"!=typeof i&&n&&!e[t].innerHTML?n.split("_")[0]:i)&&(this._waiAria.labelAttr(e[t],i),e[t].innerHTML=i)}},P.unset_actions=function(){for(var e in this._els)if(this._click[e])for(var t=0;t<this._els[e].length;t++)this._els[e][t].onclick=null;this._obj.onselectstart=null,this._obj.onmousemove=null,this._obj.onmousedown=null,this._obj.onmouseup=null,this._obj.ondblclick=null,this._obj.oncontextmenu=null},P.set_actions=function(){for(var e in this._els)if(this._click[e])for(var t=0;t<this._els[e].length;t++)this._els[e][t].onclick=P._click[e];this._obj.onselectstart=function(e){return!1},this._obj.onmousemove=function(e){P._temp_touch_block||P._on_mouse_move(e||event)},this._obj.onmousedown=function(e){P._ignore_next_click||P._on_mouse_down(e||event)},this._obj.onmouseup=function(e){P._ignore_next_click||P._on_mouse_up(e||event)},this._obj.ondblclick=function(e){P._on_dbl_click(e||event)},this._obj.oncontextmenu=function(e){var t=e||event,e=t.target||t.srcElement;return P.callEvent("onContextMenu",[P._locate_event(e),t])}},P.select=function(e){this._select_id!=e&&(P._close_not_saved(),this.editStop(!1),this.unselect(),this._select_id=e,this.updateEvent(e))},P.unselect=function(e){e&&e!=this._select_id||(e=this._select_id,this._select_id=null,e&&this.getEvent(e)&&this.updateEvent(e))},P.getState=function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}},P._click={dhx_cal_data:function(e){if(P._ignore_next_click)return e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,P._ignore_next_click=!1;var t=e?e.target:event.srcElement,i=P._locate_event(t);if(e=e||event,i){if(!P.callEvent("onClick",[i,e])||P.config.readonly)return}else P.callEvent("onEmptyClick",[P.getActionData(e).date,e]);i&&P.config.select?(P.select(i),-1!=(t=P._getClassName(t)).indexOf("_icon")&&P._click.buttons[t.split(" ")[1].replace("icon_","")](i)):(P._close_not_saved(),500<(new Date).valueOf()-(P._new_event||0)&&P.unselect())},dhx_cal_prev_button:function(){P._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(e,t){var i=1;P.config.rtl&&(t=-t,i=-i),P.setCurrentView(P.date.add(P.date[P._mode+"_start"](new Date(P._date)),t||i,P._mode))},dhx_cal_today_button:function(){P.callEvent("onBeforeTodayDisplayed",[])&&P.setCurrentView(P._currentDate())},dhx_cal_tab:function(){var e=this.getAttribute("name"),e=e.substring(0,e.search("_tab"));P.setCurrentView(P._date,e)},buttons:{delete:function(e){var t=P.locale.labels.confirm_deleting;P._dhtmlx_confirm(t,P.locale.labels.title_confirm_deleting,function(){P.deleteEvent(e)})},edit:function(e){P.edit(e)},save:function(e){P.editStop(!0)},details:function(e){P.showLightbox(e)},cancel:function(e){P.editStop(!1)}}},P._dhtmlx_confirm=function(e,t,i){if(!e)return i();e={text:e};t&&(e.title=t),i&&(e.callback=function(e){e&&i()}),dhtmlx.confirm(e)},P.addEventNow=function(e,t,i){var n={};P._isObject(e)&&!P._isDate(e)&&(n=e,e=null);var a=6e4*(this.config.event_duration||this.config.time_step);e=e||(n.start_date||Math.round(P._currentDate().valueOf()/a)*a);var o,r=new Date(e);t||((o=this.config.first_hour)>r.getHours()&&(r.setHours(o),e=r.valueOf()),t=e.valueOf()+a);t=new Date(t);r.valueOf()==t.valueOf()&&t.setTime(t.valueOf()+a),n.start_date=n.start_date||r,n.end_date=n.end_date||t,n.text=n.text||this.locale.labels.new_event,n.id=this._drag_id=n.id||this.uid(),this._drag_mode="new-size",this._loading=!0;n=this.addEvent(n);return this.callEvent("onEventCreated",[this._drag_id,i]),this._loading=!1,this._drag_event={},this._on_mouse_up(i),n},P._on_dbl_click=function(e,t){if(t=t||e.target||e.srcElement,!this.config.readonly){var i=P._getClassName(t).split(" ")[0];switch(i){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!P.config.dblclick_create)break;this.addEventNow(this.getActionData(e).date,null,e);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":var n=this._locate_event(t);if(!this.callEvent("onDblClick",[n,e]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(n)._timed||!this.config.select?this.showLightbox(n):this.edit(n);break;case"dhx_time_block":case"dhx_cal_container":return;default:n=this["dblclick_"+i];if(n)n.call(this,e);else if(t.parentNode&&t!=this)return P._on_dbl_click(e,t.parentNode)}}},P._get_column_index=function(e){var t=0;if(this._cols){for(var i=0,n=0;i+this._cols[n]<e&&n<this._cols.length;)i+=this._cols[n],n++;if(t=n+(this._cols[n]?(e-i)/this._cols[n]:0),this._ignores&&t>=this._cols.length)for(;1<=t&&this._ignores[Math.floor(t)];)t--}return t},P._week_indexes_from_pos=function(e){if(this._cols){var t=this._get_column_index(e.x);return e.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(t)-1)),e.y=Math.max(0,Math.ceil(60*e.y/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),e}return e},P._mouse_coords=function(e){var t=document.body,i=document.documentElement,n=this.$env.isIE||!e.pageX&&!e.pageY?{x:e.clientX+(t.scrollLeft||i.scrollLeft||0)-t.clientLeft,y:e.clientY+(t.scrollTop||i.scrollTop||0)-t.clientTop}:{x:e.pageX,y:e.pageY};this.config.rtl&&this._colsS?(n.x=this.$container.querySelector(".dhx_cal_data").offsetWidth-n.x,"month"!==this._mode&&(n.x-=this.xy.scale_width)):n.x-=this.$domHelpers.getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width),n.y-=this.$domHelpers.getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els.dhx_cal_data[0].scrollTop,n.ev=e;e=this["mouse_"+this._mode];if(e)n=e.call(this,n);else if(this._table_view){e=this._get_column_index(n.x);if(!this._cols||!this._colsS)return n;for(var a=0,a=1;a<this._colsS.heights.length&&!(this._colsS.heights[a]>n.y);a++);n.y=Math.ceil(24*(Math.max(0,e)+7*Math.max(0,a-1))*60/this.config.time_step),!P._drag_mode&&"month"!=this._mode||(n.y=24*(Math.max(0,Math.ceil(e)-1)+7*Math.max(0,a-1))*60/this.config.time_step),"move"==this._drag_mode&&P._ignores_detected&&P.config.preserve_length&&(n._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"}))),n.x=0}else n=this._week_indexes_from_pos(n);return n.timestamp=+new Date,n},P._close_not_saved=function(){var e;500<(new Date).valueOf()-(P._new_event||0)&&P._edit_id&&(e=P.locale.labels.confirm_closing,P._dhtmlx_confirm(e,P.locale.labels.title_confirm_closing,function(){P.editStop(P.config.positive_closing)}),e&&(this._drag_id=this._drag_pos=this._drag_mode=null))},P._correct_shift=function(e,t){return e-6e4*(new Date(P._min_date).getTimezoneOffset()-new Date(e).getTimezoneOffset())*(t?-1:1)},P._is_pos_changed=function(e,t){function i(e,t,i){return Math.abs(e-t)>i}if(!e||!this._drag_pos)return!0;return!!(this._drag_pos.has_moved||!this._drag_pos.timestamp||100<t.timestamp-this._drag_pos.timestamp||i(e.ev.clientX,t.ev.clientX,5)||i(e.ev.clientY,t.ev.clientY,5))},P._correct_drag_start_date=function(e){var t=(t=P.matrix?P.matrix[P._mode]:t)||{x_step:1,x_unit:"day"};e=new Date(e);var i=1;return(t._start_correction||t._end_correction)&&(i=60*(t.last_hour||0)-(60*e.getHours()+e.getMinutes())||1),+e+(P._get_fictional_event_length(e,i,t)-i)},P._correct_drag_end_date=function(e,t){var i=(i=P.matrix?P.matrix[P._mode]:i)||{x_step:1,x_unit:"day"},t=+e+P._get_fictional_event_length(e,t,i);return new Date(+t-(P._get_fictional_event_length(t,-1,i,-1)+1))},P._on_mouse_move=function(e){if(this._drag_mode){var t=this._mouse_coords(e);if(this._is_pos_changed(this._drag_pos,t))if(this._edit_id!=this._drag_id&&this._close_not_saved(),this._drag_mode){var i=null;if(this._drag_pos&&!this._drag_pos.has_moved&&((i=this._drag_pos).has_moved=!0),this._drag_pos=t,this._drag_pos.has_moved=!0,"create"==this._drag_mode){if(i&&(t=i),this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,l=this._get_date_from_pos(t).valueOf(),!this._drag_start)return this.callEvent("onBeforeEventCreated",[e,this._drag_id])?(this._loading=!1,void(this._drag_start=l)):void(this._loading=!1);s=l,this._drag_start;var n=new Date(this._drag_start),a=new Date(s);"day"!=this._mode&&"week"!=this._mode||n.getHours()!=a.getHours()||n.getMinutes()!=a.getMinutes()||(a=new Date(this._drag_start+1e3)),this._drag_id=this.uid(),this.addEvent(n,a,this.locale.labels.new_event,this._drag_id,t.fields),this.callEvent("onEventCreated",[this._drag_id,e]),this._loading=!1,this._drag_mode="new-size"}var o,r,s,l,d=this.config.time_step,_=this.getEvent(this._drag_id),h=(h=P.matrix?P.matrix[P._mode]:h)||{x_step:1,x_unit:"day"};"move"==this._drag_mode?(l=this._min_date.valueOf()+6e4*(t.y*this.config.time_step+24*t.x*60),!t.custom&&this._table_view&&(l+=1e3*this.date.time_part(_.start_date)),!this._table_view&&this._dragEventBody&&void 0===this._drag_event._move_event_shift&&(this._drag_event._move_event_shift=l-_.start_date),this._drag_event._move_event_shift&&(l-=this._drag_event._move_event_shift),l=this._correct_shift(l),s=t._ignores&&this.config.preserve_length&&this._table_view?(l=P._correct_drag_start_date(l),P._correct_drag_end_date(l,this._drag_event._event_length)):_.end_date.valueOf()-(_.start_date.valueOf()-l)):(l=_.start_date.valueOf(),s=_.end_date.valueOf(),this._table_view?(r=this._min_date.valueOf()+t.y*this.config.time_step*6e4+(t.custom?0:864e5),"month"==this._mode?(r=this._correct_shift(r,!1),this._drag_from_start?(u=864e5,r<=P.date.date_part(new Date(s+u-1)).valueOf()&&(l=r-u)):s=r):this.config.preserve_length?t.resize_from_start?l=P._correct_drag_start_date(r):s=P._correct_drag_end_date(r,0):t.resize_from_start?l=r:s=r):(o=this.date.date_part(new Date(_.end_date.valueOf()-1)).valueOf(),i=new Date(o),n=this.config.first_hour,a=60/d*(this.config.last_hour-n),this.config.time_step=1,r=this._mouse_coords(e),this.config.time_step=d,n=t.y*d*6e4,a=Math.min(t.y+1,a)*d*6e4,r=6e4*r.y,s=Math.abs(n-r)>Math.abs(a-r)?o+a:o+n,s+=6e4*(new Date(s).getTimezoneOffset()-i.getTimezoneOffset()),this._els.dhx_cal_data[0].style.cursor="s-resize","week"!=this._mode&&"day"!=this._mode||(s=this._correct_shift(s))),"new-size"==this._drag_mode?s<=this._drag_start?(m=t.shift||(this._table_view&&!t.custom?864e5:0),l=s-(t.shift?0:m),s=this._drag_start+(m||6e4*d)):l=this._drag_start:s<=l&&(s=l+6e4*d));var c,u,m=new Date(s-1),d=new Date(l);"move"==this._drag_mode&&P.config.limit_drag_out&&(+d<+P._min_date||+s>+P._max_date)&&(+_.start_date<+P._min_date||+_.end_date>+P._max_date?(d=new Date(_.start_date),s=new Date(_.end_date)):(c=s-d,+d<+P._min_date?(d=new Date(P._min_date),s=t._ignores&&this.config.preserve_length&&this._table_view?(d=new Date(P._correct_drag_start_date(d)),h._start_correction&&(d=new Date(d.valueOf()+h._start_correction)),new Date(+d+this._get_fictional_event_length(d,this._drag_event._event_length,h))):new Date(+d+c)):(s=new Date(P._max_date),t._ignores&&this.config.preserve_length&&this._table_view?(h._end_correction&&(s=new Date(s.valueOf()-h._end_correction)),s=new Date(+s-this._get_fictional_event_length(s,0,h,!0)),d=new Date(+s-this._get_fictional_event_length(s,this._drag_event._event_length,h,!0)),this._ignores_detected&&(d=P.date.add(d,h.x_step,h.x_unit),s=new Date(+s-this._get_fictional_event_length(s,0,h,!0)),s=P.date.add(s,h.x_step,h.x_unit))):d=new Date(+s-c))),m=new Date(s-1)),!this._table_view&&this._dragEventBody&&!P.config.all_timed&&(!P._get_section_view()&&t.x!=this._get_event_sday({start_date:new Date(l),end_date:new Date(l)})||new Date(l).getHours()<this.config.first_hour)&&(c=s-d,"move"==this._drag_mode&&(u=this._min_date.valueOf()+24*t.x*60*6e4,(d=new Date(u)).setHours(this.config.first_hour),s=new Date(d.valueOf()+c),m=new Date(s-1))),this._table_view||P.config.all_timed||!(!P.getView()&&t.x!=this._get_event_sday({start_date:new Date(s),end_date:new Date(s)})||new Date(s).getHours()>=this.config.last_hour)||(c=s-d,u=this._min_date.valueOf()+24*t.x*60*6e4,(s=P.date.date_part(new Date(u))).setHours(this.config.last_hour),m=new Date(s-1),"move"==this._drag_mode&&(d=new Date(+s-c))),(this._table_view||m.getDate()==d.getDate()&&m.getHours()<this.config.last_hour||P._allow_dnd)&&(_.start_date=d,_.end_date=new Date(s),this.config.update_render?(f=P._els.dhx_cal_data[0].scrollTop,this.update_view(),P._els.dhx_cal_data[0].scrollTop=f):this.updateEvent(this._drag_id)),this._table_view&&this.for_rendered(this._drag_id,function(e){e.className+=" dhx_in_move dhx_cal_event_drag"}),this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,e])}}else{var f;P.checkEvent("onMouseMove")&&(f=this._locate_event(e.target||e.srcElement),this.callEvent("onMouseMove",[f,e]))}},P._on_mouse_down=function(e,t){if(2!=e.button&&!this.config.readonly&&!this._drag_mode){t=t||e.target||e.srcElement;var i=P._getClassName(t).split(" ")[0];switch(this.config.drag_event_body&&"dhx_body"==i&&t.parentNode&&-1===t.parentNode.className.indexOf("dhx_cal_select_menu")&&(i="dhx_event_move",this._dragEventBody=!0),i){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize",P._getClassName(t).indexOf("dhx_event_resize_end")<0?P._drag_from_start=!0:P._drag_from_start=!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(t.parentNode)return P._on_mouse_down(e,t.parentNode);break;default:if((!P.checkEvent("onMouseDown")||P.callEvent("onMouseDown",[i,e]))&&t.parentNode&&t!=this&&"dhx_body"!=i)return P._on_mouse_down(e,t.parentNode);this._drag_mode=null,this._drag_id=null}if(this._drag_mode){var n=this._locate_event(t);if(this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[n,this._drag_mode,e])){if(this._drag_id=n,(this._edit_id!=this._drag_id||this._edit_id&&"create"==this._drag_mode)&&this._close_not_saved(),!this._drag_mode)return;this._drag_event=P._lame_clone(this.getEvent(this._drag_id)||{}),this._drag_pos=this._mouse_coords(e)}else this._drag_mode=this._drag_id=0}this._drag_start=null}},P._get_private_properties=function(e){var t,i={};for(t in e)0===t.indexOf("_")&&(i[t]=!0);return i},P._clear_temporary_properties=function(e,t){var i,n=this._get_private_properties(e);for(i in this._get_private_properties(t))n[i]||delete t[i]},P._on_mouse_up=function(e){if(!e||2!=e.button||!this._mobile){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var t=this._drag_id,i=this._drag_mode,n=!this._drag_pos||this._drag_pos.has_moved;delete this._drag_event._move_event_shift;var a=this.getEvent(this._drag_id);if(n&&(this._drag_event._dhx_changed||!this._drag_event.start_date||a.start_date.valueOf()!=this._drag_event.start_date.valueOf()||a.end_date.valueOf()!=this._drag_event.end_date.valueOf())){n="new-size"==this._drag_mode;if(this.callEvent("onBeforeEventChanged",[a,e,n,this._drag_event]))if(this._drag_id=this._drag_mode=null,n&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select||!this.isOneDayEvent(this.getEvent(t)))return P.callEvent("onDragEnd",[t,i,e]),this.showLightbox(t);this._drag_pos=!0,this._select_id=this._edit_id=t}else this._new_event||this.callEvent(n?"onEventAdded":"onEventChanged",[t,this.getEvent(t)]);else n?this.deleteEvent(a.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(a,this._drag_event),P._lame_copy(a,this._drag_event),this.updateEvent(a.id))}this._drag_pos&&(this._drag_pos.has_moved||!0===this._drag_pos)&&(this._drag_id=this._drag_mode=null,this.render_view_data()),P.callEvent("onDragEnd",[t,i,e])}this._drag_id=null,this._drag_mode=null,this._drag_pos=null}},P._trigger_dyn_loading=function(){return!(!this._load_mode||!this._load()||(this._render_wait=!0,0))},P.update_view=function(){this._reset_ignores(),this._update_nav_bar(this.config.header,this.$container.querySelector(".dhx_cal_navline"));var e=this[this._mode+"_view"];if(e?e(!0):this._reset_scale(),this._trigger_dyn_loading())return!0;this.render_view_data()},P.isViewExists=function(e){return!!(P[e+"_view"]||P.date[e+"_start"]&&P.templates[e+"_date"]&&P.templates[e+"_scale_date"])},P._set_aria_buttons_attrs=function(){for(var e=["dhx_cal_next_button","dhx_cal_prev_button","dhx_cal_tab","dhx_cal_today_button"],t=0;t<e.length;t++)for(var i=this._els[e[t]],n=0;i&&n<i.length;n++){var a=i[n].getAttribute("name"),o=this.locale.labels[e[t]];a&&(o=this.locale.labels[a]||o),"dhx_cal_next_button"==e[t]?o=this.locale.labels.next:"dhx_cal_prev_button"==e[t]&&(o=this.locale.labels.prev),this._waiAria.headerButtonsAttributes(i[n],o||"")}},P.updateView=function(e,t){if(!this.$container)throw new Error("The scheduler is not initialized. \n **scheduler.updateView** or **scheduler.setCurrentView** can be called only after **scheduler.init**");e=e||this._date,t=t||this._mode;var i="dhx_cal_data",n=this._obj,a="dhx_scheduler_"+this._mode,o="dhx_scheduler_"+t;this._mode&&-1!=n.className.indexOf(a)?n.className=n.className.replace(a,o):n.className+=" "+o;var r,n="dhx_multi_day",o=!(this._mode!=t||!this.config.preserve_scroll)&&this._els[i][0].scrollTop;this._els[n]&&this._els[n][0]&&(r=this._els[n][0].scrollTop),this[this._mode+"_view"]&&t&&this._mode!=t&&this[this._mode+"_view"](!1),this._close_not_saved(),this._els[n]&&(this._els[n][0].parentNode.removeChild(this._els[n][0]),this._els[n]=null),this._mode=t,this._date=e,this._table_view="month"==this._mode,this._dy_shift=0,this.update_view(),this._set_aria_buttons_attrs();var s=this._els.dhx_cal_tab;if(s)for(var l=0;l<s.length;l++){var d=s[l];d.getAttribute("name")==this._mode+"_tab"?(d.classList.add("active"),this._waiAria.headerToggleState(d,!0)):(d.classList.remove("active"),this._waiAria.headerToggleState(d,!1))}"number"==typeof o&&(this._els[i][0].scrollTop=o),"number"==typeof r&&this._els[n]&&this._els[n][0]&&(this._els[n][0].scrollTop=r)},P.setCurrentView=function(e,t){this.callEvent("onBeforeViewChange",[this._mode,this._date,t||this._mode,e||this._date])&&(this.updateView(e,t),this.callEvent("onViewChange",[this._mode,this._date]))},P.render=function(e,t){P.setCurrentView(e,t)},P._render_x_header=function(e,t,i,n,a){a=a||0;var o=document.createElement("div");o.className="dhx_scale_bar",this.templates[this._mode+"_scalex_class"]&&(o.className+=" "+this.templates[this._mode+"_scalex_class"](i));var r=this._cols[e]-1;"month"==this._mode&&0===e&&this.config.left_border&&(o.className+=" dhx_scale_bar_border",t+=1),this.set_xy(o,r,this.xy.scale_height-2,t,a);i=this.templates[this._mode+"_scale_date"](i,this._mode);o.innerHTML=i,this._waiAria.dayHeaderAttr(o,i),n.appendChild(o)},P._get_columns_num=function(e,t){var i,n=7;return P._table_view||((i=P.date["get_"+P._mode+"_end"])&&(t=i(e)),n=Math.round((t.valueOf()-e.valueOf())/864e5)),n},P._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))},P._get_view_end=function(){var e,t=this._get_timeunit_start(),i=P.date.add(t,1,this._mode);return P._table_view||(e=P.date["get_"+P._mode+"_end"])&&(i=e(t)),i},P._calc_scale_sizes=function(e,t,i){var n=this.config.rtl,a=e,o=this._get_columns_num(t,i);this._process_ignores(t,o,"day",1);for(var r=o-this._ignores_detected,s=0;s<o;s++)this._ignores[s]?(this._cols[s]=0,r++):this._cols[s]=Math.floor(a/(r-s)),a-=this._cols[s],this._colsS[s]=(this._cols[s-1]||0)+(this._colsS[s-1]||(this._table_view?0:(n?this.xy.scroll_width:this.xy.scale_width)+2));this._colsS.col_length=o,this._colsS[o]=this._cols[o-1]+this._colsS[o-1]||0},P._set_scale_col_size=function(e,t,i){var n=this.config;this.set_xy(e,t-1,n.hour_size_px*(n.last_hour-n.first_hour),i+this.xy.scale_width+1,0)},P._render_scales=function(e,t){var i=new Date(P._min_date),n=new Date(P._max_date),a=this.date.date_part(P._currentDate()),o=parseInt(e.style.width,10),r=new Date(this._min_date),s=this._get_columns_num(i,n);this._calc_scale_sizes(o,i,n);var l=0;e.innerHTML="";for(var d,_,h=0;h<s;h++)this._ignores[h]||this._render_x_header(h,l,r,e),this._table_view||(d=document.createElement("div"),_="dhx_scale_holder",r.valueOf()==a.valueOf()&&(_="dhx_scale_holder_now"),d.setAttribute("data-column-index",h),this._ignores_detected&&this._ignores[h]&&(_+=" dhx_scale_ignore"),d.className=_+" "+this.templates.week_date_class(r,a),this._waiAria.dayColumnAttr(d,r),this._set_scale_col_size(d,this._cols[h],l),t.appendChild(d),this.callEvent("onScaleAdd",[d,r])),l+=this._cols[h],r=this.date.add(r,1,"day"),r=this.date.day_start(r)},P._getNavDateElement=function(){return this.$container.querySelector(".dhx_cal_date")},P._reset_scale=function(){var e,t,i,n,a,o,r,s;this.templates[this._mode+"_date"]&&(n=this._els.dhx_cal_header[0],s=this._els.dhx_cal_data[0],r=this.config,n.innerHTML="",s.innerHTML="",t=(r.readonly||!r.drag_resize?" dhx_resize_denied":"")+(r.readonly||!r.drag_move?" dhx_move_denied":""),s.className="dhx_cal_data"+t,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes(),a=this._get_timeunit_start(),i=P._get_view_end(),o=this._table_view?P.date.week_start(a):a,this._min_date=o,e=this.templates[this._mode+"_date"](a,i,this._mode),(t=this._getNavDateElement())&&(t.innerHTML=e,this._waiAria.navBarDateAttr(t,e)),this._max_date=i,P._render_scales(n,s),this._table_view?this._reset_month_scale(s,a,o):(this._reset_hours_scale(s,a,o),r.multi_day&&(this._els[i="dhx_multi_day"]&&(this._els[i][0].parentNode.removeChild(this._els[i][0]),this._els[i]=null),n=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+1,(a=document.createElement("div")).className=i,a.style.visibility="hidden",o=this._colsS[this._colsS.col_length],r=r.rtl?this.xy.scale_width:this.xy.scroll_width,r=Math.max(o+r-2,0),this.set_xy(a,r,0,0,n),s.parentNode.insertBefore(a,s),(s=a.cloneNode(!0)).className=i+"_icon",s.style.visibility="hidden",this.set_xy(s,this.xy.scale_width,0,0,n),a.appendChild(s),this._els[i]=[a,s],this._els[i][0].onclick=this._click.dhx_cal_data)))},P._reset_hours_scale=function(e,t,i){var n=document.createElement("div");n.className="dhx_scale_holder";for(var a=new Date(1980,1,1,this.config.first_hour,0,0),o=+this.config.first_hour;o<this.config.last_hour;o++){var r=document.createElement("div");r.className="dhx_scale_hour",r.style.height=this.config.hour_size_px+"px";var s=this.xy.scale_width;this.config.left_border&&(r.className+=" dhx_scale_hour_border"),r.style.width=s+"px";s=P.templates.hour_scale(a);r.innerHTML=s,this._waiAria.hourScaleAttr(r,s),n.appendChild(r),a=this.date.add(a,1,"hour")}e.appendChild(n),this.config.scroll_hour&&(e.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))},P._currentDate=function(){return P.config.now_date?new Date(P.config.now_date):new Date},P._reset_ignores=function(){this._ignores={},this._ignores_detected=0},P._process_ignores=function(e,t,i,n,a){this._reset_ignores();var o=P["ignore_"+this._mode];if(o)for(var r=new Date(e),s=0;s<t;s++)o(r)&&(this._ignores_detected+=1,this._ignores[s]=!0,a&&t++),r=P.date.add(r,n,i),P.date[i+"_start"]&&(r=P.date[i+"_start"](r))},P._render_month_scale=function(e,t,i,n){function a(e){var t=P._colsS.height;return t=void 0!==P._colsS.heights[e+1]?P._colsS.heights[e+1]-(P._colsS.heights[e]||0):t}var o=P.date.add(t,1,"month"),r=new Date(i),s=P._currentDate();this.date.date_part(s),this.date.date_part(i),n=n||Math.ceil(Math.round((o.valueOf()-i.valueOf())/864e5)/7);for(var l=[],d=0;d<=7;d++){var _=(this._cols[d]||0)-1;0===d&&this.config.left_border&&--_,l[d]=_+"px"}var h=0,c=document.createElement("table");c.setAttribute("cellpadding","0"),c.setAttribute("cellspacing","0");var u=document.createElement("tbody");c.appendChild(u);for(var m=[],d=0;d<n;d++){var f=document.createElement("tr");u.appendChild(f);for(var p=Math.max(a(d)-P.xy.month_head_height,0),g=0;g<7;g++){var v=document.createElement("td");f.appendChild(v);var x="";i<t?x="dhx_before":o<=i?x="dhx_after":i.valueOf()==s.valueOf()&&(x="dhx_now"),this._ignores_detected&&this._ignores[g]&&(x+=" dhx_scale_ignore"),v.className=x+" "+this.templates.month_date_class(i,s),v.setAttribute("data-cell-date",P.templates.format_date(i));var y="dhx_month_body",x="dhx_month_head";0===g&&this.config.left_border&&(y+=" dhx_month_body_border",x+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[g]?(v.appendChild(document.createElement("div")),v.appendChild(document.createElement("div"))):(this._waiAria.monthCellAttr(v,i),(b=document.createElement("div")).className=x,b.innerHTML=this.templates.month_day(i),v.appendChild(b),(b=document.createElement("div")).className=y,b.style.height=p+"px",b.style.width=l[g],v.appendChild(b)),m.push(i);var b=i.getDate();1<(i=this.date.add(i,1,"day")).getDate()-b&&(i=new Date(i.getFullYear(),i.getMonth(),b+1,12,0))}P._colsS.heights[d]=h,h+=a(d)}this._min_date=r,this._max_date=i,e.innerHTML="",e.appendChild(c),this._scales={};for(var w=e.getElementsByTagName("div"),d=0;d<m.length;d++){var e=w[2*d+1],D=m[d];this._scales[+D]=e}for(d=0;d<m.length;d++){D=m[d];this.callEvent("onScaleAdd",[this._scales[+D],D])}return this._max_date},P._reset_month_scale=function(e,t,i,n){var a=P.date.add(t,1,"month"),o=P._currentDate();this.date.date_part(o),this.date.date_part(i),n=n||Math.ceil(Math.round((a.valueOf()-i.valueOf())/864e5)/7);a=Math.floor(e.clientHeight/n)-this.xy.month_head_height;return this._colsS.height=a+this.xy.month_head_height,this._colsS.heights=[],P._render_month_scale(e,t,i,n)},P.getView=function(e){return e=e||P.getState().mode,P.matrix&&P.matrix[e]?P.matrix[e]:P._props&&P._props[e]?P._props[e]:null},P.getLabel=function(e,t){for(var i=this.config.lightbox.sections,n=0;n<i.length;n++)if(i[n].map_to==e)for(var a=i[n].options,o=0;o<a.length;o++)if(a[o].key==t)return a[o].label;return""},P.updateCollection=function(e,t){e=P.serverList(e);return!!e&&(e.splice(0,e.length),e.push.apply(e,t||[]),P.callEvent("onOptionsLoad",[]),P.resetLightbox(),!0)},P._lame_clone=function(e,t){var i,n,a;for(t=t||[],i=0;i<t.length;i+=2)if(e===t[i])return t[i+1];if(e&&"object"==typeof e){for(a=Object.create(e),n=[Array,Date,Number,String,Boolean],i=0;i<n.length;i++)e instanceof n[i]&&(a=i?new n[i](e):new n[i]);for(i in t.push(e,a),e)Object.prototype.hasOwnProperty.apply(e,[i])&&(a[i]=P._lame_clone(e[i],t))}return a||e},P._lame_copy=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},P._get_date_from_pos=function(e){e=this._min_date.valueOf()+6e4*(e.y*this.config.time_step+24*(this._table_view?0:e.x)*60);return new Date(this._correct_shift(e))},P.getActionData=function(e){e=this._mouse_coords(e);return{date:this._get_date_from_pos(e),section:e.section}},P._focus=function(e,t){if(e&&e.focus)if(this._mobile)window.setTimeout(function(){e.focus()},10);else try{t&&e.select&&e.offsetWidth&&e.select(),e.focus()}catch(e){}},P._get_real_event_length=function(e,t,i){for(var n=t-e,a=i._start_correction+i._end_correction||0,o=this["ignore_"+this._mode],r=0,s=i.render?(r=this._get_date_index(i,e),this._get_date_index(i,t)):Math.round(n/60/60/1e3/24),l=!0;r<s;){var d=P.date.add(t,-i.x_step,i.x_unit);o&&o(t)&&(!l||o(d))?n-=t-d:(l=!1,n-=a),t=d,s--}return n},P._get_fictional_event_length=function(e,t,i,n){var a,o=new Date(e),r=n?-1:1;(i._start_correction||i._end_correction)&&(a=n?60*o.getHours()+o.getMinutes()-60*(i.first_hour||0):60*(i.last_hour||0)-(60*o.getHours()+o.getMinutes()),n=60*(i.last_hour-i.first_hour),t+=(a=(a=Math.ceil((t/6e4-a)/n))<0?0:a)*(1440-n)*60*1e3);for(var e=new Date(+e+t*r),s=this["ignore_"+this._mode],l=0,d=i.render?(l=this._get_date_index(i,o),this._get_date_index(i,e)):Math.round(t/60/60/1e3/24);l*r<=d*r;){var _=P.date.add(o,i.x_step*r,i.x_unit);s&&s(o)&&(t+=(_-o)*r,d+=r),o=_,l+=r}return t},P._get_section_view=function(){return this.getView()},P._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null},P._is_initialized=function(){var e=this.getState();return this._obj&&e.date&&e.mode},P._is_lightbox_open=function(){var e=this.getState();return null!==e.lightbox_id&&void 0!==e.lightbox_id},P._getClassName=function(e){if(!e)return"";e=e.className||"";return(e=!(e=e.baseVal?e.baseVal:e).indexOf?"":e)||""},P.event=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},P.eventRemove=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},P._getFocusableNodes=function(e){for(var t,i,e=e.querySelectorAll(["a[href]","area[href]","input","select","textarea","button","iframe","object","embed","[tabindex]","[contenteditable]"].join(", ")),n=Array.prototype.slice.call(e,0),a=0;a<n.length;a++){var o=n[a];i=o,(!isNaN(i.getAttribute("tabindex"))&&0<=+i.getAttribute("tabindex")||(!{input:!0,select:!0,textarea:!0,button:!0,object:!0}[(t=o).nodeName.toLowerCase()]||!t.hasAttribute("disabled"))||(!{a:!0,area:!0}[(t=o).nodeName.loLowerCase()]||t.getAttribute("href")))&&function(e){var t=!1,i=!1;window.getComputedStyle?(t=(a=window.getComputedStyle(e,null)).display,i=a.visibility):e.currentStyle&&(t=e.currentStyle.display,i=e.currentStyle.visibility);var n=!1,a=P._locate_css({target:e},"dhx_form_repeat",!1),n=(n=a?!("0px"!=a.style.height):n)||!e.offsetHeight;return"none"!=t&&"hidden"!=i&&!n}(o)||(n.splice(a,1),a--)}return n},P._trim=function(e){return(String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")}).apply(e)},P._isDate=function(e){return!(!e||"object"!=typeof e||!(e.getFullYear&&e.getMonth&&e.getDate))},P._isObject=function(e){return e&&"object"==typeof e},function(){function a(e){return(e+"").replace(t," ").replace(i," ")}var e,t=new RegExp("<(?:.|\n)*?>","gm"),i=new RegExp(" +","gm"),o=new RegExp("'","gm");for(e in P._waiAria={getAttributeString:function(e){var t,i,n=[" "];for(t in e)"function"!=typeof e[t]&&"object"!=typeof e[t]&&(i=(a(e[t])+"").replace(o,"&#39;"),n.push(t+"='"+i+"'"));return n.push(" "),n.join(" ")},setAttributes:function(e,t){for(var i in t)e.setAttribute(i,a(t[i]));return e},labelAttr:function(e,t){return this.setAttributes(e,{"aria-label":t})},label:function(e){return P._waiAria.getAttributeString({"aria-label":e})},hourScaleAttr:function(e,t){this.labelAttr(e,t)},monthCellAttr:function(e,t){this.labelAttr(e,P.templates.day_date(t))},navBarDateAttr:function(e,t){this.labelAttr(e,t)},dayHeaderAttr:function(e,t){this.labelAttr(e,t)},dayColumnAttr:function(e,t){this.dayHeaderAttr(e,P.templates.day_date(t))},headerButtonsAttributes:function(e,t){return this.setAttributes(e,{role:"button","aria-label":t})},headerToggleState:function(e,t){return this.setAttributes(e,{"aria-pressed":t?"true":"false"})},getHeaderCellAttr:function(e){return P._waiAria.getAttributeString({"aria-label":e})},eventAttr:function(e,t){this._eventCommonAttr(e,t)},_eventCommonAttr:function(e,t){t.setAttribute("aria-label",a(P.templates.event_text(e.start_date,e.end_date,e))),P.config.readonly&&t.setAttribute("aria-readonly",!0),e.$dataprocessor_class&&t.setAttribute("aria-busy",!0),t.setAttribute("aria-selected",P.getState().select_id==e.id?"true":"false")},setEventBarAttr:function(e,t){this._eventCommonAttr(e,t)},_getAttributes:function(e,t){var i={setAttribute:function(e,t){this[e]=t}};return e.apply(this,[t,i]),i},eventBarAttrString:function(e){return this.getAttributeString(this._getAttributes(this.setEventBarAttr,e))},agendaHeadAttrString:function(){return this.getAttributeString({role:"row"})},agendaHeadDateString:function(e){return this.getAttributeString({role:"columnheader","aria-label":e})},agendaHeadDescriptionString:function(e){return this.agendaHeadDateString(e)},agendaDataAttrString:function(){return this.getAttributeString({role:"grid"})},agendaEventAttrString:function(e){e=this._getAttributes(this._eventCommonAttr,e);return e.role="row",this.getAttributeString(e)},agendaDetailsBtnString:function(){return this.getAttributeString({role:"button","aria-label":P.locale.labels.icon_details})},gridAttrString:function(){return this.getAttributeString({role:"grid"})},gridRowAttrString:function(e){return this.agendaEventAttrString(e)},gridCellAttrString:function(e,t,i){return this.getAttributeString({role:"gridcell","aria-label":[void 0===t.label?t.id:t.label,": ",i]})},mapAttrString:function(){return this.gridAttrString()},mapRowAttrString:function(e){return this.gridRowAttrString(e)},mapDetailsBtnString:function(){return this.agendaDetailsBtnString()},minicalHeader:function(e,t){this.setAttributes(e,{id:t+"","aria-live":"assertice","aria-atomic":"true"})},minicalGrid:function(e,t){this.setAttributes(e,{"aria-labelledby":t+"",role:"grid"})},minicalRow:function(e){this.setAttributes(e,{role:"row"})},minicalDayCell:function(e,t){var i=t.valueOf()<P._max_date.valueOf()&&t.valueOf()>=P._min_date.valueOf();this.setAttributes(e,{role:"gridcell","aria-label":P.templates.day_date(t),"aria-selected":i?"true":"false"})},minicalHeadCell:function(e){this.setAttributes(e,{role:"columnheader"})},weekAgendaDayCell:function(e,t){var i=e.querySelector(".dhx_wa_scale_bar"),n=e.querySelector(".dhx_wa_day_data"),e=P.uid()+"";this.setAttributes(i,{id:e}),this.setAttributes(n,{"aria-labelledby":e})},weekAgendaEvent:function(e,t){this.eventAttr(t,e)},lightboxHiddenAttr:function(e){e.setAttribute("aria-hidden","true")},lightboxVisibleAttr:function(e){e.setAttribute("aria-hidden","false")},lightboxSectionButtonAttrString:function(e){return this.getAttributeString({role:"button","aria-label":e,tabindex:"0"})},yearHeader:function(e,t){this.setAttributes(e,{id:t+""})},yearGrid:function(e,t){this.minicalGrid(e,t)},yearHeadCell:function(e){return this.minicalHeadCell(e)},yearRow:function(e){return this.minicalRow(e)},yearDayCell:function(e){this.setAttributes(e,{role:"gridcell"})},lightboxAttr:function(e){e.setAttribute("role","dialog"),e.setAttribute("aria-hidden","true"),e.firstChild.setAttribute("role","heading")},lightboxButtonAttrString:function(e){return this.getAttributeString({role:"button","aria-label":P.locale.labels[e],tabindex:"0"})},eventMenuAttrString:function(e){return this.getAttributeString({role:"button","aria-label":P.locale.labels[e]})},lightboxHeader:function(e,t){e.setAttribute("aria-label",t)},lightboxSelectAttrString:function(e){var t="";switch(e){case"%Y":t=P.locale.labels.year;break;case"%m":t=P.locale.labels.month;break;case"%d":t=P.locale.labels.day;break;case"%H:%i":t=P.locale.labels.hour+" "+P.locale.labels.minute}return P._waiAria.getAttributeString({"aria-label":t})},messageButtonAttrString:function(e){return"tabindex='0' role='button' aria-label='"+e+"'"},messageInfoAttr:function(e){e.setAttribute("role","alert")},messageModalAttr:function(e,t){e.setAttribute("role","dialog"),t&&e.setAttribute("aria-labelledby",t)},quickInfoAttr:function(e){e.setAttribute("role","dialog")},quickInfoHeaderAttrString:function(){return" role='heading' "},quickInfoHeader:function(e,t){e.setAttribute("aria-label",t)},quickInfoButtonAttrString:function(e){return P._waiAria.getAttributeString({role:"button","aria-label":e,tabindex:"0"})},tooltipAttr:function(e){e.setAttribute("role","tooltip")},tooltipVisibleAttr:function(e){e.setAttribute("aria-hidden","false")},tooltipHiddenAttr:function(e){e.setAttribute("aria-hidden","true")}},P._waiAria)P._waiAria[e]=function(e){return function(){return P.config.wai_aria_attributes?e.apply(this,arguments):" "}}(P._waiAria[e])}(),P.utils={mixin:function(e,t,i){for(var n in t)void 0!==e[n]&&!i||(e[n]=t[n]);return e},copy:function e(t){var i,n,a;if(t&&"object"==typeof t)switch(!0){case a=t,!(!a||"object"!=typeof a||!(a.getFullYear&&a.getMonth&&a.getDate)):n=new Date(t);break;case a=t,Array.isArray?Array.isArray(a):a&&void 0!==a.length&&a.pop&&a.push:for(n=new Array(t.length),i=0;i<t.length;i++)n[i]=e(t[i]);break;case a=t,a&&"object"==typeof a&&"function String() { [native code] }"===Function.prototype.toString.call(a.constructor):n=new String(t);break;case a=t,a&&"object"==typeof a&&"function Number() { [native code] }"===Function.prototype.toString.call(a.constructor):n=new Number(t);break;case a=t,a&&"object"==typeof a&&"function Boolean() { [native code] }"===Function.prototype.toString.call(a.constructor):n=new Boolean(t);break;default:for(i in n={},t)Object.prototype.hasOwnProperty.apply(t,[i])&&(n[i]=e(t[i]))}return n||t}},P.$domHelpers={getAbsoluteLeft:function(e){return this.getOffset(e).left},getAbsoluteTop:function(e){return this.getOffset(e).top},getOffsetSum:function(e){for(var t=0,i=0;e;)t+=parseInt(e.offsetTop),i+=parseInt(e.offsetLeft),e=e.offsetParent;return{top:t,left:i}},getOffsetRect:function(e){var t,i,n,a,o=e.getBoundingClientRect(),r=0,s=0;return/Mobi/.test(navigator.userAgent)?((n=document.createElement("div")).style.position="absolute",n.style.left="0px",n.style.top="0px",n.style.width="1px",n.style.height="1px",document.body.appendChild(n),i=n.getBoundingClientRect(),r=o.top-i.top,s=o.left-i.left,n.parentNode.removeChild(n)):(a=document.body,t=document.documentElement,e=window.pageYOffset||t.scrollTop||a.scrollTop,i=window.pageXOffset||t.scrollLeft||a.scrollLeft,n=t.clientTop||a.clientTop||0,a=t.clientLeft||a.clientLeft||0,r=o.top+e-n,s=o.left+i-a),{top:Math.round(r),left:Math.round(s)}},getOffset:function(e){return e.getBoundingClientRect?this.getOffsetRect(e):this.getOffsetSum(e)},closest:function(e,t){return e&&t?h(e,t):null},insertAfter:function(e,t){t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)}},h=Element.prototype.closest?function(e,t){return e.closest(t)}:(_=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,function(e,t){var i=e;do{if(_.call(i,t))return i}while(null!==(i=i.parentElement||i.parentNode)&&1===i.nodeType);return null}),P.$env={isIE:0<=navigator.userAgent.indexOf("MSIE")||0<=navigator.userAgent.indexOf("Trident"),isIE6:!window.XMLHttpRequest&&0<=navigator.userAgent.indexOf("MSIE"),isIE7:0<=navigator.userAgent.indexOf("MSIE 7.0")&&navigator.userAgent.indexOf("Trident")<0,isIE8:0<=navigator.userAgent.indexOf("MSIE 8.0")&&0<=navigator.userAgent.indexOf("Trident"),isOpera:0<=navigator.userAgent.indexOf("Opera"),isChrome:0<=navigator.userAgent.indexOf("Chrome"),isKHTML:0<=navigator.userAgent.indexOf("Safari")||0<=navigator.userAgent.indexOf("Konqueror"),isFF:0<=navigator.userAgent.indexOf("Firefox"),isIPad:0<=navigator.userAgent.search(/iPad/gi),isEdge:-1!=navigator.userAgent.indexOf("Edge")},P.$ajax={_obj:P,cache:!0,method:"get",parse:function(e){return"string"!=typeof e?e:(e=e.replace(/^[\s]+/,""),window.DOMParser&&!P.$env.isIE?t=(new window.DOMParser).parseFromString(e,"text/xml"):window.ActiveXObject!==window.undefined&&((t=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)),t);var t},xmltop:function(e,t,i){if(void 0===t.status||t.status<400){var n=t.responseXML?t.responseXML||t:this.parse(t.responseText||t);if(n&&null!==n.documentElement&&!n.getElementsByTagName("parsererror").length)return n.getElementsByTagName(e)[0]}return-1!==i&&this._obj.callEvent("onLoadXMLError",["Incorrect XML",t,i]),document.createElement("DIV")},xpath:function(e,t){if(t.nodeName||(t=t.responseXML||t),P.$env.isIE)return t.selectNodes(e)||[];for(var i,n=[],a=(t.ownerDocument||t).evaluate(e,t,null,XPathResult.ANY_TYPE,null);i=a.iterateNext();)n.push(i);return n},query:function(e){this._call(e.method||"GET",e.url,e.data||"",e.async||!0,e.callback,null,e.headers)},get:function(e,t){this._call("GET",e,null,!0,t)},getSync:function(e){return this._call("GET",e,null,!1)},put:function(e,t,i){this._call("PUT",e,t,!0,i)},del:function(e,t,i){this._call("DELETE",e,t,!0,i)},post:function(e,t,i){t=1==arguments.length?"":2!=arguments.length||"function"!=typeof t&&"function"!=typeof window[t]?String(t):(i=t,""),this._call("POST",e,t,!0,i)},postSync:function(e,t){return t=null===t?"":String(t),this._call("POST",e,t,!1)},getLong:function(e,t){this._call("GET",e,null,!0,t,{url:e})},postLong:function(e,t,i){2!=arguments.length||"function"!=typeof t&&(window[t],0)||(i=t,t=""),this._call("POST",e,t,!0,i,{url:e,postData:t})},_call:function(e,t,i,n,a,o,r){var s=this._obj,l=window.XMLHttpRequest&&!s.$env.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d=null!==navigator.userAgent.match(/AppleWebKit/)&&null!==navigator.userAgent.match(/Qt/)&&null!==navigator.userAgent.match(/Safari/);if(n&&(l.onreadystatechange=function(){(4==l.readyState||d&&3==l.readyState)&&(200==l.status&&""!==l.responseText||s.callEvent("onAjaxError",[l]))&&window.setTimeout(function(){"function"==typeof a&&a.apply(window,[{xmlDoc:l,filePath:t}]),o&&(void 0!==o.postData?this.postLong(o.url,o.postData,a):this.getLong(o.url,a)),l=a=null},1)}),"GET"!=e||this.cache||(t+=(0<=t.indexOf("?")?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),l.open(e,t,n),r)for(var _ in r)l.setRequestHeader(_,r[_]);else"POST"==e.toUpperCase()||"PUT"==e||"DELETE"==e?l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==e&&(i=null);if(l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.send(i),!n)return{xmlDoc:l,filePath:t}},urlSeparator:function(e){return-1!=e.indexOf("?")?"&":"?"}};function f(e,t){for(var i="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",n=e.match(/%[a-zA-Z]/g),a=0;a<n.length;a++)switch(n[a]){case"%j":case"%d":i+="set[2]=temp["+a+"]||1;";break;case"%n":case"%m":i+="set[1]=(temp["+a+"]||1)-1;";break;case"%y":i+="set[0]=temp["+a+"]*1+(temp["+a+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":i+="set[3]=temp["+a+"]||0;";break;case"%i":i+="set[4]=temp["+a+"]||0;";break;case"%Y":i+="set[0]=temp["+a+"]||0;";break;case"%a":case"%A":i+="set[3]=set[3]%12+((temp["+a+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":i+="set[5]=temp["+a+"]||0;";break;case"%M":i+="set[1]=this.locale.date.month_short_hash[temp["+a+"]]||0;";break;case"%F":i+="set[1]=this.locale.date.month_full_hash[temp["+a+"]]||0;"}return e="set[0],set[1],set[2],set[3],set[4],set[5]",t&&(e=" Date.UTC("+e+")"),new Function("date","var set=[0,0,1,0,0,0]; "+i+" return new Date("+e+");")}var p,g,v,x,y,b,w,D,E;function k(e,t,i){t&&(e._date=t),i&&(e._mode=i)}function S(e,t){var i=this;window.clearTimeout(b),window.clearTimeout(y);var n=i._date,a=i._mode;k(this,e,t),b=setTimeout(function(){i.callEvent("onBeforeViewChange",[a,n,t||i._mode,e||i._date])?(x.call(i,e,t),i.callEvent("onViewChange",[i._mode,i._date]),window.clearTimeout(y),b=0):k(i,n,a)},P.config.delay_render)}function M(e,t){var i=this,n=arguments;k(this,e,t),window.clearTimeout(y),y=setTimeout(function(){b||x.apply(i,n)},P.config.delay_render)}P.date={init:function(){for(var e=P.locale.date.month_short,t=P.locale.date.month_short_hash={},i=0;i<e.length;i++)t[e[i]]=i;for(e=P.locale.date.month_full,t=P.locale.date.month_full_hash={},i=0;i<e.length;i++)t[e[i]]=i},_bind_host_object:function(e){return e.bind?e.bind(P):function(){return e.apply(P,arguments)}},date_part:function(e){var t=new Date(e);return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.getHours()&&(e.getDate()<t.getDate()||e.getMonth()<t.getMonth()||e.getFullYear()<t.getFullYear())&&e.setTime(e.getTime()+36e5*(24-e.getHours())),e},time_part:function(e){return(e.valueOf()/1e3-60*e.getTimezoneOffset())%86400},week_start:function(e){var t=e.getDay();return P.config.start_on_monday&&(0===t?t=6:t--),this.date_part(this.add(e,-1*t,"day"))},month_start:function(e){return e.setDate(1),this.date_part(e)},year_start:function(e){return e.setMonth(0),this.month_start(e)},day_start:function(e){return this.date_part(e)},_add_days:function(e,t){var i,n=new Date(e.valueOf());return n.setDate(n.getDate()+t),t==Math.round(t)&&0<t&&(i=(+n-+e)%864e5)&&e.getTimezoneOffset()==n.getTimezoneOffset()&&(i=i/36e5,n.setTime(n.getTime()+60*(24-i)*60*1e3)),0<=t&&!e.getHours()&&n.getHours()&&(n.getDate()<e.getDate()||n.getMonth()<e.getMonth()||n.getFullYear()<e.getFullYear())&&n.setTime(n.getTime()+36e5*(24-n.getHours())),n},add:function(e,t,i){var n=new Date(e.valueOf());switch(i){case"day":n=P.date._add_days(n,t);break;case"week":n=P.date._add_days(n,7*t);break;case"month":n.setMonth(n.getMonth()+t);break;case"year":n.setYear(n.getFullYear()+t);break;case"hour":n.setTime(n.getTime()+60*t*60*1e3);break;case"minute":n.setTime(n.getTime()+60*t*1e3);break;default:return P.date["add_"+i](e,t,i)}return n},to_fixed:function(e){return e<10?"0"+e:e},copy:function(e){return new Date(e.valueOf())},date_to_str:function(e,t){e=e.replace(/%[a-zA-Z]/g,function(e){switch(e){case"%d":return'"+this.date.to_fixed(date.getDate())+"';case"%m":return'"+this.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+this.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+this.locale.date.day_short[date.getDay()]+"';case"%l":return'"+this.locale.date.day_full[date.getDay()]+"';case"%M":return'"+this.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+this.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+this.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+this.date.to_fixed(date.getHours())+"';case"%i":return'"+this.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+this.date.to_fixed(date.getSeconds())+"';case"%W":return'"+this.date.to_fixed(this.date.getISOWeek(date))+"';default:return e}}),t&&(e=e.replace(/date\.get/g,"date.getUTC"));e=new Function("date",'return "'+e+'";');return P.date._bind_host_object(e)},str_to_date:function(e,t,i){var n=f(e,t),a=/^[0-9]{4}(\-|\/)[0-9]{2}(\-|\/)[0-9]{2} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/,o=/^[0-9]{2}\/[0-9]{2}\/[0-9]{4} ?(([0-9]{1,2}:[0-9]{2})(:[0-9]{1,2})?)?$/,r=/^[0-9]{2}\-[0-9]{2}\-[0-9]{4} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/,s=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,l=f("%Y-%m-%d %H:%i:%s",t),d=f("%m/%d/%Y %H:%i:%s",t),_=f("%d-%m-%Y %H:%i:%s",t);return function(e){if(!i&&!P.config.parse_exact_format){if(e&&e.getISOWeek)return new Date(e);if("number"==typeof e)return new Date(e);if(a.test(String(e)))return l(e);if(o.test(String(e)))return d(e);if(r.test(String(e)))return _(e);if(s.test(e))return new Date(e)}return n.call(P,e)}},getISOWeek:function(e){if(!e)return!1;var t=(e=this.date_part(new Date(e))).getDay();0===t&&(t=7);var i=new Date(e.valueOf());i.setDate(e.getDate()+(4-t));t=i.getFullYear(),t=Math.round((i.getTime()-new Date(t,0,1).getTime())/864e5);return 1+Math.floor(t/7)},getUTCISOWeek:function(e){return this.getISOWeek(this.convert_to_utc(e))},convert_to_utc:function(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())}},P.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Do you want to edit the whole set of repeated events?",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute",repeat_radio_day:"Daily",repeat_radio_week:"Weekly",repeat_radio_month:"Monthly",repeat_radio_year:"Yearly",repeat_radio_day_type:"Every",repeat_text_day_count:"day",repeat_radio_day_type2:"Every workday",repeat_week:" Repeat every",repeat_text_week_count:"week next days:",repeat_radio_month_type:"Repeat",repeat_radio_month_start:"On",repeat_text_month_day:"day every",repeat_text_month_count:"month",repeat_text_month_count2_before:"every",repeat_text_month_count2_after:"month",repeat_year_label:"On",select_year_day2:"of",repeat_text_year_day:"day",select_year_month:"month",repeat_radio_end:"No end date",repeat_text_occurences_count:"occurrences",repeat_radio_end2:"After",repeat_radio_end3:"End by",month_for_recurring:["January","February","March","April","May","June","July","August","September","October","November","December"],day_for_recurring:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},P.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",date_format:"%Y-%m-%d %H:%i",api_date:"%d-%m-%Y %H:%i",parse_exact_format:!1,preserve_length:!0,time_step:5,start_on_monday:!0,first_hour:0,last_hour:24,readonly:!1,drag_resize:!0,drag_move:!0,drag_create:!0,drag_event_body:!0,dblclick_create:!0,edit_on_create:!0,details_on_create:!1,header:null,resize_month_events:!1,resize_month_timed:!1,responsive_lightbox:!1,rtl:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:0,drag_lightbox:!0,preserve_scroll:!0,select:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,touch_swipe_dates:!1,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_left:["dhx_save_btn","dhx_cancel_btn"],buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0,timeline_swap_resize:!0,wai_aria_attributes:!0,wai_aria_application_role:!0},P.config.buttons_left.$inital=P.config.buttons_left.join(),P.config.buttons_right.$inital=P.config.buttons_right.join(),P._helpers={parseDate:function(e){return(P.templates.xml_date||P.templates.parse_date)(e)},formatDate:function(e){return(P.templates.xml_format||P.templates.format_date)(e)}},P.templates={},P.init_templates=function(){var e=P.locale.labels;e.dhx_save_btn=e.icon_save,e.dhx_cancel_btn=e.icon_cancel,e.dhx_delete_btn=e.icon_delete;var e=P.date.date_to_str,i=P.config;(function(e,t){for(var i in t)e[i]||(e[i]=t[i])})(P.templates,{day_date:e(i.default_date),month_date:e(i.month_date),week_date:function(e,t){return i.rtl?P.templates.day_date(P.date.add(t,-1,"day"))+" &ndash; "+P.templates.day_date(e):P.templates.day_date(e)+" &ndash; "+P.templates.day_date(P.date.add(t,-1,"day"))},day_scale_date:e(i.default_date),month_scale_date:e(i.week_date),week_scale_date:e(i.day_date),hour_scale:e(i.hour_date),time_picker:e(i.hour_date),event_date:e(i.hour_date),month_day:e(i.month_day),load_format:e(i.load_date),format_date:e(i.date_format,i.server_utc),parse_date:P.date.str_to_date(i.date_format,i.server_utc),api_date:P.date.str_to_date(i.api_date,!1,!1),event_header:function(e,t,i){return P.templates.event_date(e)+" - "+P.templates.event_date(t)},event_text:function(e,t,i){return i.text},event_class:function(e,t,i){return""},month_date_class:function(e){return""},week_date_class:function(e){return""},event_bar_date:function(e,t,i){return P.templates.event_date(e)+" "},event_bar_text:function(e,t,i){return i.text},month_events_link:function(e,t){return"<a>View more("+t+" events)</a>"},drag_marker_class:function(e,t,i){return""},drag_marker_content:function(e,t,i){return""},tooltip_date_format:P.date.date_to_str("%Y-%m-%d %H:%i"),tooltip_text:function(e,t,i){return"<b>Event:</b> "+i.text+"<br/><b>Start date:</b> "+P.templates.tooltip_date_format(e)+"<br/><b>End date:</b> "+P.templates.tooltip_date_format(t)}}),this.callEvent("onTemplatesReady",[])},P.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++},P._events={},P.clearAll=function(){this._events={},this._loaded={},this._edit_id=null,this._select_id=null,this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this._new_event=null,this.clear_view(),this.callEvent("onClearAll",[])},P.addEvent=function(e,t,i,n,a){if(!arguments.length)return this.addEventNow();var o=e;1!=arguments.length&&((o=a||{}).start_date=e,o.end_date=t,o.text=i,o.id=n),o.id=o.id||P.uid(),o.text=o.text||"","string"==typeof o.start_date&&(o.start_date=this.templates.api_date(o.start_date)),"string"==typeof o.end_date&&(o.end_date=this.templates.api_date(o.end_date));var r=6e4*(this.config.event_duration||this.config.time_step);o.start_date.valueOf()==o.end_date.valueOf()&&o.end_date.setTime(o.end_date.valueOf()+r),o._timed=this.isOneDayEvent(o);r=!this._events[o.id];return this._events[o.id]=o,this.event_updated(o),this._loading||this.callEvent(r?"onEventAdded":"onEventChanged",[o.id,o]),o.id},P.deleteEvent=function(e,t){var i=this._events[e];(t||this.callEvent("onBeforeEventDelete",[e,i])&&this.callEvent("onConfirmedBeforeEventDelete",[e,i]))&&(i&&(this._select_id=null,delete this._events[e],this.event_updated(i),this._drag_id==i.id&&(this._drag_id=null,this._drag_mode=null,this._drag_pos=null)),this.callEvent("onEventDeleted",[e,i]))},P.getEvent=function(e){return this._events[e]},P.setEvent=function(e,t){t.id||(t.id=e),this._events[e]=t},P.for_rendered=function(e,t){for(var i=this._rendered.length-1;0<=i;i--)this._rendered[i].getAttribute("event_id")==e&&t(this._rendered[i],i)},P.changeEventId=function(e,t){var i;e!=t&&((i=this._events[e])&&(i.id=t,this._events[t]=i,delete this._events[e]),this.for_rendered(e,function(e){e.setAttribute("event_id",t)}),this._select_id==e&&(this._select_id=t),this._edit_id==e&&(this._edit_id=t),this.callEvent("onEventIdChange",[e,t]))},function(){for(var e=["text","Text","start_date","StartDate","end_date","EndDate"],t=0;t<e.length;t+=2)P["getEvent"+e[t+1]]=function(t){return function(e){return P.getEvent(e)[t]}}(e[t]),P["setEvent"+e[t+1]]=function(i){return function(e,t){e=P.getEvent(e);e[i]=t,e._changed=!0,e._timed=this.isOneDayEvent(e),P.event_updated(e,!0)}}(e[t])}(),P.event_updated=function(e,t){this.is_visible_events(e)?this.render_view_data():this.clear_event(e.id)},P.is_visible_events=function(e){if(e.start_date.valueOf()<this._max_date.valueOf()&&this._min_date.valueOf()<e.end_date.valueOf()){var t=e.start_date.getHours(),i=e.end_date.getHours()+e.end_date.getMinutes()/60,n=this.config.last_hour,a=this.config.first_hour;return!(!this._table_view&&(n<i||i<a)&&(n<=t||t<a)&&!((e.end_date.valueOf()-e.start_date.valueOf())/36e5>24-(this.config.last_hour-this.config.first_hour)||t<n&&a<=i))}return!1},P.isOneDayEvent=function(e){var t=new Date(e.end_date.valueOf()-1);return e.start_date.getFullYear()===t.getFullYear()&&e.start_date.getMonth()===t.getMonth()&&e.start_date.getDate()===t.getDate()&&e.end_date.valueOf()-e.start_date.valueOf()<864e5},P.get_visible_events=function(e){var t,i=[];for(t in this._events)this.is_visible_events(this._events[t])&&(e&&!this._events[t]._timed||this.filter_event(t,this._events[t])&&i.push(this._events[t]));return i},P.filter_event=function(e,t){var i=this["filter_"+this._mode];return!i||i(e,t)},P._is_main_area_event=function(e){return!!e._timed},P.render_view_data=function(e,t){var i=!1;if(!e){if(i=!0,this._not_render)return void(this._render_wait=!0);this._render_wait=!1,this.clear_view(),e=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(var n=0,a=e.length;n<a;n++)this._recalculate_timed(e[n]);if(this.config.multi_day&&!this._table_view){for(var o=[],r=[],n=0;n<e.length;n++)(this._is_main_area_event(e[n])?o:r).push(e[n]);if(!this._els.dhx_multi_day){var s=P._commonErrorMessages.unknownView(this._mode);throw new Error(s)}this._rendered_location=this._els.dhx_multi_day[0],this._table_view=!0,this.render_data(r,t),this._table_view=!1,this._rendered_location=this._els.dhx_cal_data[0],this._table_view=!1,this.render_data(o,t)}else{var l=document.createDocumentFragment(),s=this._els.dhx_cal_data[0];this._rendered_location=l,this.render_data(e,t),s.appendChild(l),this._rendered_location=s}i&&this.callEvent("onDataRender",[])},P._view_month_day=function(e){e=P.getActionData(e).date;P.callEvent("onViewMoreClick",[e])&&P.setCurrentView(e,"day")},P._render_month_link=function(e){for(var t=this._rendered_location,i=this._lame_clone(e),n=e._sday;n<e._eday;n++){i._sday=n,i._eday=n+1;var a=P.date,o=P._min_date,o=a.add(o,i._sweek,"week");o=a.add(o,i._sday,"day");var r=P.getEvents(o,a.add(o,1,"day")).length,s=this._get_event_bar_pos(i),l=s.x2-s.x,a=document.createElement("div");a.onclick=function(e){P._view_month_day(e||event)},a.className="dhx_month_link",a.style.top=s.y+"px",a.style.left=s.x+"px",a.style.width=l+"px",a.innerHTML=P.templates.month_events_link(o,r),this._rendered.push(a),t.appendChild(a)}},P._recalculate_timed=function(e){!e||(e="object"!=typeof e?this._events[e]:e)&&(e._timed=P.isOneDayEvent(e))},P.attachEvent("onEventChanged",P._recalculate_timed),P.attachEvent("onEventAdded",P._recalculate_timed),P.render_data=function(e,t){e=this._pre_render_events(e,t);for(var i,n={},a=0;a<e.length;a++)if(this._table_view)"month"!=P._mode||(i=P.config.max_month_events)!==+i||e[a]._sorder<i?this.render_event_bar(e[a]):void 0!==i&&e[a]._sorder==i&&P._render_month_link(e[a]);else{var o=e[a],r=P.locate_holder(o._sday);if(!r)continue;n[o._sday]||(n[o._sday]={real:r,buffer:document.createDocumentFragment(),width:r.clientWidth});var s=n[o._sday];this.render_event(o,s.buffer,s.width)}for(a in n)(s=n[a]).real&&s.buffer&&s.real.appendChild(s.buffer)},P._get_first_visible_cell=function(e){for(var t=0;t<e.length;t++)if(-1==(e[t].className||"").indexOf("dhx_scale_ignore"))return e[t];return e[0]},P._pre_render_events=function(e,t){var i=this.xy.bar_height,n=this._colsS.heights,a=this._colsS.heights=[0,0,0,0,0,0,0],o=this._els.dhx_cal_data[0];if(e=this._table_view?this._pre_render_events_table(e,t):this._pre_render_events_line(e,t),this._table_view)if(t)this._colsS.heights=n;else{var r=o.firstChild;if(r.rows){for(var s,l,d,_=0;_<r.rows.length;_++){a[_]++;var h=r.rows[_].cells,c=this._colsS.height-this.xy.month_head_height;if(a[_]*i>c){var u=c;+this.config.max_month_events!==this.config.max_month_events||a[_]<=this.config.max_month_events?u=a[_]*i:(this.config.max_month_events+1)*i>c&&(u=(this.config.max_month_events+1)*i);for(var m=0;m<h.length;m++)h[m].childNodes[1].style.height=u+"px"}a[_]=(a[_-1]||0)+P._get_first_visible_cell(h).offsetHeight}a.unshift(0),r.parentNode.offsetHeight<r.parentNode.scrollHeight&&!P._colsS.scroll_fix&&P.xy.scroll_width&&(l=(s=P._colsS)[s.col_length],d=s.heights.slice(),l-=P.xy.scroll_width||0,this._calc_scale_sizes(l,this._min_date,this._max_date),P._colsS.heights=d,this.set_xy(this._els.dhx_cal_header[0],l,this.xy.scale_height),P._render_scales(this._els.dhx_cal_header[0]),P._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date),s.scroll_fix=!0)}else e.length||"visible"!=this._els.dhx_multi_day[0].style.visibility||(a[0]=-1),!e.length&&-1!=a[0]||(r.parentNode.childNodes,d=(n=t=(a[0]+1)*i+1)+"px",this.config.multi_day_height_limit&&(d=(n=Math.min(t,this.config.multi_day_height_limit))+"px"),o.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+n+"px",o.style.height=this._obj.offsetHeight-parseInt(o.style.top,10)-(this.xy.margin_top||0)+"px",(l=this._els.dhx_multi_day[0]).style.height=d,l.style.visibility=-1==a[0]?"hidden":"visible",(s=this._els.dhx_multi_day[1]).style.height=d,s.style.visibility=-1==a[0]?"hidden":"visible",s.className=a[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(a[0]+1)*i,this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift)),a[0]=0,n!=t&&(o.style.top=parseInt(o.style.top)+2+"px",l.style.overflowY="auto",s.style.position="fixed",s.style.top="",s.style.left=""))}return e},P._get_event_sday=function(e){e=this.date.day_start(new Date(e.start_date));return Math.round((e.valueOf()-this._min_date.valueOf())/864e5)},P._get_event_mapped_end_date=function(e){var t=e.end_date;return!this.config.separate_short_events||(e=(e.end_date-e.start_date)/6e4)<this._min_mapped_duration&&(t=this.date.add(t,this._min_mapped_duration-e,"minute")),t},P._pre_render_events_line=function(e,t){e.sort(function(e,t){return e.start_date.valueOf()==t.start_date.valueOf()?e.id>t.id?1:-1:e.start_date>t.start_date?1:-1});var i=[],n=[];this._min_mapped_duration=Math.ceil(60*this.xy.min_event_height/this.config.hour_size_px);for(var a=0;a<e.length;a++){var o=e[a],r=o.start_date,s=o.end_date,r=r.getHours(),s=s.getHours();if(o._sday=this._get_event_sday(o),this._ignores[o._sday])e.splice(a,1),a--;else{if(i[o._sday]||(i[o._sday]=[]),!t){o._inner=!1;for(var l=i[o._sday];l.length;){var d=l[l.length-1];if(!(this._get_event_mapped_end_date(d).valueOf()<=o.start_date.valueOf()))break;l.splice(l.length-1,1)}for(var _=l.length,h=!1,c=0;c<l.length;c++){d=l[c];if(this._get_event_mapped_end_date(d).valueOf()<=o.start_date.valueOf()){h=!0,o._sorder=d._sorder,_=c,o._inner=!0;break}}if(l.length&&(l[l.length-1]._inner=!0),!h)if(l.length)if(l.length<=l[l.length-1]._sorder){if(l[l.length-1]._sorder)for(c=0;c<l.length;c++){for(var u=!1,m=0;m<l.length;m++)if(l[m]._sorder==c){u=!0;break}if(!u){o._sorder=c;break}}else o._sorder=0;o._inner=!0}else{for(var f=l[0]._sorder,c=1;c<l.length;c++)l[c]._sorder>f&&(f=l[c]._sorder);o._sorder=f+1,o._inner=!1}else o._sorder=0;l.splice(_,_==l.length?0:1,o),l.length>(l.max_count||0)?(l.max_count=l.length,o._count=l.length):o._count=o._count||1}(r<this.config.first_hour||s>=this.config.last_hour)&&(n.push(o),e[a]=o=this._copy_event(o),r<this.config.first_hour&&(o.start_date.setHours(this.config.first_hour),o.start_date.setMinutes(0)),s>=this.config.last_hour&&(o.end_date.setMinutes(0),o.end_date.setHours(this.config.last_hour)),o.start_date>o.end_date||r==this.config.last_hour)&&(e.splice(a,1),a--)}}if(!t){for(a=0;a<e.length;a++)e[a]._count=i[e[a]._sday].max_count;for(a=0;a<n.length;a++)n[a]._count=i[n[a]._sday].max_count}return e},P._time_order=function(e){e.sort(function(e,t){return e.start_date.valueOf()==t.start_date.valueOf()?e._timed&&!t._timed||(e._timed||!t._timed)&&e.id>t.id?1:-1:e.start_date>t.start_date?1:-1})},P._is_any_multiday_cell_visible=function(e,t,i){var n=this._cols.length,a=!1,o=e,r=!0,s=new Date(t);for(P.date.day_start(new Date(t)).valueOf()!=t.valueOf()&&(s=P.date.day_start(s),s=P.date.add(s,1,"day"));o<s;){var r=!1,l=this.locate_holder_day(o,!1,i);if(!this._ignores[l%n]){a=!0;break}o=P.date.add(o,1,"day")}return r||a},P._pre_render_events_table=function(e,t){this._time_order(e);for(var i,n=[],a=[[],[],[],[],[],[],[]],o=this._colsS.heights,r=this._cols.length,s={},l=0;l<e.length;l++){var d=e[l],_=d.id;s[_]||(s[_]={first_chunk:!0,last_chunk:!0});var h=s[_],c=i||d.start_date,u=d.end_date;c<this._min_date&&(h.first_chunk=!1,c=this._min_date),u>this._max_date&&(h.last_chunk=!1,u=this._max_date);var m=this.locate_holder_day(c,!1,d);if(d._sday=m%r,!this._ignores[d._sday]||!d._timed){_=this.locate_holder_day(u,!0,d)||r;if(d._eday=_%r||r,d._length=_-m,d._sweek=Math.floor((this._correct_shift(c.valueOf(),1)-this._min_date.valueOf())/(864e5*r)),P._is_any_multiday_cell_visible(c,u,d)){for(var f=a[d._sweek],p=0;p<f.length&&!(f[p]._eday<=d._sday);p++);d._sorder&&t||(d._sorder=p),d._sday+d._length<=r?(i=null,n.push(d),o[(f[p]=d)._sweek]=f.length-1,d._first_chunk=h.first_chunk,d._last_chunk=h.last_chunk):((u=this._copy_event(d)).id=d.id,u._length=r-d._sday,u._eday=r,u._sday=d._sday,u._sweek=d._sweek,u._sorder=d._sorder,u.end_date=this.date.add(c,u._length,"day"),u._first_chunk=h.first_chunk,h.first_chunk&&(h.first_chunk=!1),n.push(u),i=(f[p]=u).end_date,o[d._sweek]=f.length-1,l--)}}}return n},P._copy_dummy=function(){var e=new Date(this.start_date),t=new Date(this.end_date);this.start_date=e,this.end_date=t},P._copy_event=function(e){return this._copy_dummy.prototype=e,new this._copy_dummy},P._rendered=[],P.clear_view=function(){for(var e=0;e<this._rendered.length;e++){var t=this._rendered[e];t.parentNode&&t.parentNode.removeChild(t)}this._rendered=[]},P.updateEvent=function(e){var t=this.getEvent(e);this.clear_event(e),t&&this.is_visible_events(t)&&this.filter_event(e,t)&&(this._table_view||this.config.multi_day||t._timed)&&(!this.config.update_render&&("month"!=this.getState().mode||this.getState().drag_id||this.isOneDayEvent(t))?this.render_view_data([t],!0):this.render_view_data())},P.clear_event=function(e){this.for_rendered(e,function(e,t){e.parentNode&&e.parentNode.removeChild(e),P._rendered.splice(t,1)})},P._y_from_date=function(e){e=60*e.getHours()+e.getMinutes();return Math.round((60*e*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)},P._calc_event_y=function(e,t){t=t||0;var i=60*e.start_date.getHours()+e.start_date.getMinutes(),n=60*e.end_date.getHours()+e.end_date.getMinutes()||60*P.config.last_hour;return{top:this._y_from_date(e.start_date),height:Math.max(t,(n-i)*this.config.hour_size_px/60)}},P.render_event=function(e,t,i){var n=P.xy.menu_width,a=this.config.use_select_menu_space?0:n;if(!(e._sday<0)){var o=P.locate_holder(e._sday);if(o){t=t||o;var r=this._calc_event_y(e,P.xy.min_event_height),s=r.top,l=r.height,d=e._count||1,_=e._sorder||0;i=i||o.clientWidth;var h=Math.floor((i-a)/d),c=_*h+1;e._inner||(h*=d-_),this.config.cascade_event_display&&(c=_%(r=this.config.cascade_event_count)*(u=this.config.cascade_event_margin),u=e._inner?(d-_-1)%r*u/2:0,h=Math.floor(i-a-c-u));var u=this._render_v_bar(e,a+c,s,h,l,e._text_style,P.templates.event_header(e.start_date,e.end_date,e),P.templates.event_text(e.start_date,e.end_date,e));if(this._waiAria.eventAttr(e,u),this._rendered.push(u),t.appendChild(u),c=c+parseInt(this.config.rtl?o.style.right:o.style.left,10)+a,this._edit_id==e.id&&(u.style.zIndex=1,h=Math.max(h-4,P.xy.editor_width),(u=document.createElement("div")).setAttribute("event_id",e.id),this._waiAria.eventAttr(e,u),u.className="dhx_cal_event dhx_cal_editor",this.config.rtl&&c++,this.set_xy(u,h,l-20,c,s+(P.xy.event_header_height||14)),e.color&&(u.style.backgroundColor=e.color),(a=P.templates.event_class(e.start_date,e.end_date,e))&&(u.className+=" "+a),a=document.createElement("div"),this.set_xy(a,h-6,l-26),a.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",u.appendChild(a),this._els.dhx_cal_data[0].appendChild(u),this._rendered.push(u),a.innerHTML="<textarea class='dhx_cal_editor'>"+e.text+"</textarea>",this._editor=a.querySelector("textarea"),this._quirks7&&(this._editor.style.height=l-12+"px"),this._editor.onkeydown=function(e){if((e||event).shiftKey)return!0;var t=(e||event).keyCode;t==P.keys.edit_save&&P.editStop(!0),t==P.keys.edit_cancel&&P.editStop(!1),t!=P.keys.edit_save&&t!=P.keys.edit_cancel||e.preventDefault&&e.preventDefault()},this._editor.onselectstart=function(e){return(e||event).cancelBubble=!0},P._focus(this._editor,!0),this._els.dhx_cal_data[0].scrollLeft=0),0!==this.xy.menu_width&&this._select_id==e.id){this.config.cascade_event_display&&this._drag_mode&&(u.style.zIndex=1);for(var m,f=this.config["icons_"+(this._edit_id==e.id?"edit":"select")],p="",g=e.color?"background-color: "+e.color+";":"",v=e.textColor?"color: "+e.textColor+";":"",x=0;x<f.length;x++)m=this._waiAria.eventMenuAttrString(f[x]),p+="<div class='dhx_menu_icon "+f[x]+"' style='"+g+v+"' title='"+this.locale.labels[f[x]]+"'"+m+"></div>";s=this._render_v_bar(e,c-n+1,s,n,20*f.length+26-2,"","<div style='"+g+v+"' class='dhx_menu_head'></div>",p,!0);s.style.left=c-n+1,this._els.dhx_cal_data[0].appendChild(s),this._rendered.push(s)}this.config.drag_highlight&&this._drag_id==e.id&&this.highlightEventPosition(e)}}},P._render_v_bar=function(e,t,i,n,a,o,r,s,l){var d=document.createElement("div"),_=e.id,h=l?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",c=P.getState();c.drag_id==e.id&&(h+=" dhx_cal_event_drag"),c.select_id==e.id&&(h+=" dhx_cal_event_selected");var u=P.templates.event_class(e.start_date,e.end_date,e);u&&(h=h+" "+u),this.config.cascade_event_display&&(h+=" dhx_cal_event_cascade");var m=e.color?"background-color:"+e.color+";":"",f=e.textColor?"color:"+e.textColor+";":"",p=P._border_box_events(),g=n-2,v=p?g:n-6,x=p?g:n-(this._quirks?4:14),c=p?g-2:n-8,u=p?a-this.xy.event_header_height-1:a-(this._quirks?20:30)+1,o='<div event_id="'+_+'" class="'+h+'" style="position:absolute; top:'+i+"px; "+(this.config.rtl?"right:":"left:")+t+"px; width:"+(p?g:n-4)+"px; height:"+a+"px;"+(o||"")+'"></div>';d.innerHTML=o;o=d.cloneNode(!0).firstChild;if(!l&&P.renderEvent(o,e,n,a,r,s))return o;o=d.firstChild,v='<div class="dhx_event_move dhx_header" style=" width:'+v+"px;"+m+'" >&nbsp;</div>';v+='<div class="dhx_event_move dhx_title" style="'+m+f+'">'+r+"</div>",v+='<div class="dhx_body" style=" width:'+x+"px; height:"+u+"px;"+m+f+'">'+s+"</div>";s="dhx_event_resize dhx_footer";return!l&&!1!==e._drag_resize||(s="dhx_resize_denied "+s),o.innerHTML=v+='<div class="'+s+'" style=" width:'+c+"px;"+(l?" margin-top:-1px;":"")+m+f+'" ></div>',o},P.renderEvent=function(){return!1},P.locate_holder=function(e){return"day"==this._mode?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[e]},P.locate_holder_day=function(e,t){var i=Math.floor((this._correct_shift(e,1)-this._min_date)/864e5);return t&&this.date.time_part(e)&&i++,i},P._get_dnd_order=function(e,t,i){if(!this._drag_event)return e;this._drag_event._orig_sorder?e=this._drag_event._orig_sorder:this._drag_event._orig_sorder=e;for(var n=t*e;i<n+t;)e--,n-=t;return Math.max(e,0)},P._get_event_bar_pos=function(e){var t=this.config.rtl,i=this._colsS,n=i[e._sday],a=i[e._eday];t&&(n=i[i.col_length]-i[e._eday]+i[0],a=i[i.col_length]-i[e._sday]+i[0]),a==n&&(a=i[e._eday+1]);var o=this.xy.bar_height,r=e._sorder;return e.id==this._drag_id&&(t=i.heights[e._sweek+1]-i.heights[e._sweek]-this.xy.month_head_height,r=P._get_dnd_order(r,o,t)),{x:n,x2:a,y:i.heights[e._sweek]+(i.height?this.xy.month_scale_height+2:2)+r*o}},P.render_event_bar=function(e){var t,i,n,a,o,r,s,l=this._rendered_location,d=this._get_event_bar_pos(e),_=d.y,h=d.x,c=d.x2,u="";c&&(t=P.config.resize_month_events&&"month"==this._mode&&(!e._timed||P.config.resize_month_timed),i=document.createElement("div"),n=e.hasOwnProperty("_first_chunk")&&e._first_chunk,a=e.hasOwnProperty("_last_chunk")&&e._last_chunk,o=t&&(e._timed||n),s=t&&(e._timed||a),r=!0,d="dhx_cal_event_clear",e._timed&&!t||(r=!1,d="dhx_cal_event_line"),n&&(d+=" dhx_cal_event_line_start"),a&&(d+=" dhx_cal_event_line_end"),o&&(u+="<div class='dhx_event_resize dhx_event_resize_start'></div>"),s&&(u+="<div class='dhx_event_resize dhx_event_resize_end'></div>"),(s=P.templates.event_class(e.start_date,e.end_date,e))&&(d+=" "+s),s=e.color?"background:"+e.color+";":"",s=["position:absolute","top:"+_+"px","left:"+h+"px","width:"+(c-h-3-(r?1:0))+"px",e.textColor?"color:"+e.textColor+";":"",s,e._text_style||""].join(";"),s="<div event_id='"+e.id+"' class='"+d+"' style='"+s+"'"+this._waiAria.eventBarAttrString(e)+">",t&&(s+=u),(e="month"==P.getState().mode?P.getEvent(e.id):e)._timed&&(s+=P.templates.event_bar_date(e.start_date,e.end_date,e)),s+=P.templates.event_bar_text(e.start_date,e.end_date,e)+"</div>",i.innerHTML=s+="</div>",this._rendered.push(i.firstChild),l.appendChild(i.firstChild))},P._locate_event=function(e){for(var t=null;e&&!t&&e.getAttribute;)t=e.getAttribute("event_id"),e=e.parentNode;return t},P._locate_css=function(e,t,i){void 0===i&&(i=!0);for(var n=e.target||e.srcElement,a="";n;){if(a=P._getClassName(n)){var o=a.indexOf(t);if(0<=o){if(!i)return n;var r=0===o||!P._trim(a.charAt(o-1)),o=o+t.length>=a.length||!P._trim(a.charAt(o+t.length));if(r&&o)return n}}n=n.parentNode}return null},P.edit=function(e){this._edit_id!=e&&(this.editStop(!1,e),this._edit_id=e,this.updateEvent(e))},P.editStop=function(e,t){t&&this._edit_id==t||(t=this.getEvent(this._edit_id))&&(e&&(t.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(t.id),this._edit_stop_event(t,e))},P._edit_stop_event=function(e,t){this._new_event?(t?this.callEvent("onEventAdded",[e.id,e]):e&&this.deleteEvent(e.id,!0),this._new_event=null):t&&this.callEvent("onEventChanged",[e.id,e])},P.getEvents=function(e,t){var i,n=[];for(i in this._events){var a=this._events[i];a&&(!e&&!t||a.start_date<t&&a.end_date>e)&&n.push(a)}return n},P.getRenderedEvent=function(e){if(e){for(var t=P._rendered,i=0;i<t.length;i++){var n=t[i];if(n.getAttribute("event_id")==e)return n}return null}},P.showEvent=function(e,t){e&&"object"==typeof e&&(t=e.mode,a=e.section,e=e.section);var i,n,a,o,r="number"==typeof e||"string"==typeof e?P.getEvent(e):e;t=t||P._mode,!r||this.checkEvent("onBeforeEventDisplay")&&!this.callEvent("onBeforeEventDisplay",[r,t])||(n=P.config.scroll_hour,P.config.scroll_hour=r.start_date.getHours(),o=P.config.preserve_scroll,P.config.preserve_scroll=!1,i=r.color,e=r.textColor,P.config.highlight_displayed_event&&(r.color=P.config.displayed_event_color,r.textColor=P.config.displayed_event_text_color),P.setCurrentView(new Date(r.start_date),t),r.color=i,r.textColor=e,P.config.scroll_hour=n,P.config.preserve_scroll=o,P.matrix&&P.matrix[t]&&(n=(e=P.getView()).y_property,(o=P.getEvent(r.id))&&(a||(a=o[n],Array.isArray(a)?a=a[0]:"string"==typeof a&&P.config.section_delimiter&&-1<a.indexOf(P.config.section_delimiter)&&(a=a.split(P.config.section_delimiter)[0])),n=e.posFromSection(a),a=e.posFromDate(o.start_date),a-=((o=P.$container.querySelector(".dhx_timeline_data_wrapper")).offsetWidth-e.dx)/2,n=n-o.offsetHeight/2+e.dy/2,e.scrollTo({left:a,top:n}))),P.callEvent("onAfterEventDisplay",[r,t]))},P._append_drag_marker=function(e){var t,i;e.parentNode||(t=P._els.dhx_cal_data[0].lastChild,(i=P._getClassName(t)).indexOf("dhx_scale_holder")<0&&t.previousSibling&&(t=t.previousSibling),i=P._getClassName(t),t&&0===i.indexOf("dhx_scale_holder")&&t.appendChild(e))},P._update_marker_position=function(e,t){t=P._calc_event_y(t,0);e.style.top=t.top+"px",e.style.height=t.height+"px"},P.highlightEventPosition=function(e){var t=document.createElement("div");t.setAttribute("event_id",e.id),this._rendered.push(t),this._update_marker_position(t,e);var i=this.templates.drag_marker_class(e.start_date,e.end_date,e),e=this.templates.drag_marker_content(e.start_date,e.end_date,e);t.className="dhx_drag_marker",i&&(t.className+=" "+i),e&&(t.innerHTML=e),this._append_drag_marker(t)},P._loaded={},P._load=function(e,t){function i(e){P.on_load(e),P.callEvent("onLoadEnd",[])}if(e=e||this._load_url){if(e+=(-1==e.indexOf("?")?"?":"&")+"timeshift="+(new Date).getTimezoneOffset(),this.config.prevent_cache&&(e+="&uid="+this.uid()),t=t||this._date,this._load_mode){var n=this.templates.load_format;for(t=this.date[this._load_mode+"_start"](new Date(t.valueOf()));t>this._min_date;)t=this.date.add(t,-1,this._load_mode);for(var a=t,o=!0;a<this._max_date;)a=this.date.add(a,1,this._load_mode),this._loaded[n(t)]&&o?t=this.date.add(t,1,this._load_mode):o=!1;for(var r=a;a=r,t<(r=this.date.add(a,-1,this._load_mode))&&this._loaded[n(r)];);if(a<=t)return!1;for(P.$ajax.get(e+"&from="+n(t)+"&to="+n(a),i);t<a;)this._loaded[n(t)]=!0,t=this.date.add(t,1,this._load_mode)}else P.$ajax.get(e,i);return this.callEvent("onXLS",[]),this.callEvent("onLoadStart",[]),!0}},P._parsers={},P._parsers.xml={canParse:function(e,t){if(t.responseXML&&t.responseXML.firstChild)return!0;try{var i=P.$ajax.parse(t.responseText),n=P.$ajax.xmltop("data",i);if(n&&"data"===n.tagName)return!0}catch(e){}return!1},parse:function(e){if(e.xmlDoc.responseXML||(e.xmlDoc.responseXML=P.$ajax.parse(e.xmlDoc.responseText)),"data"!=(f=P.$ajax.xmltop("data",e.xmlDoc)).tagName)return null;var t=f.getAttribute("dhx_security");t&&(window.dhtmlx&&(dhtmlx.security_key=t),P.security_key=t);for(var i=P.$ajax.xpath("//coll_options",e.xmlDoc),n=0;n<i.length;n++){var a=i[n].getAttribute("for"),o=P.serverList[a];o||(P.serverList[a]=o=[]),o.splice(0,o.length);for(var r=P.$ajax.xpath(".//item",i[n]),s=0;s<r.length;s++){for(var l=r[s].attributes,d={key:r[s].getAttribute("value"),label:r[s].getAttribute("label")},_=0;_<l.length;_++){var h=l[_];"value"!=h.nodeName&&"label"!=h.nodeName&&(d[h.nodeName]=h.nodeValue)}o.push(d)}}i.length&&P.callEvent("onOptionsLoad",[]);for(var c=P.$ajax.xpath("//userdata",e.xmlDoc),n=0;n<c.length;n++){var u=P._xmlNodeToJSON(c[n]);P._userdata[u.name]=u.text}for(var m=[],f=P.$ajax.xpath("//event",e.xmlDoc),n=0;n<f.length;n++){var p=m[n]=P._xmlNodeToJSON(f[n]);P._init_event(p)}return m}},P.json=P._parsers.json={canParse:function(e){if(e&&"object"==typeof e)return!0;if("string"==typeof e)try{var t=JSON.parse(e);return"[object Object]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)}catch(e){return!1}return!1},parse:function(e){var t;"string"==typeof e&&(e=JSON.parse(e)),t=("[object Array]"===Object.prototype.toString.call(e)?e:e?e.data:[])||[],e.dhx_security&&(window.dhtmlx&&(dhtmlx.security_key=e.dhx_security),P.security_key=e.dhx_security);var i,n=e&&e.collections?e.collections:{},a=!1;for(i in n)if(n.hasOwnProperty(i)){var a=!0,o=n[i],r=P.serverList[i];r||(P.serverList[i]=r=[]),r.splice(0,r.length);for(var s=0;s<o.length;s++){var l,d=o[s],_={key:d.value,label:d.label};for(l in d)if(d.hasOwnProperty(l)){if("value"==l||"label"==l)continue;_[l]=d[l]}r.push(_)}}a&&P.callEvent("onOptionsLoad",[]);for(var h=[],c=0;c<t.length;c++){var u=t[c];P._init_event(u),h.push(u)}return h}},P.ical=P._parsers.ical={canParse:function(e){return"string"==typeof e&&new RegExp("^BEGIN:VCALENDAR").test(e)},parse:function(e){var t=e.match(RegExp(this.c_start+"[^\f]*"+this.c_end,""));if(t.length){t[0]=t[0].replace(/[\r\n]+ /g,""),t[0]=t[0].replace(/[\r\n]+(?=[a-z \t])/g," "),t[0]=t[0].replace(/\;[^:\r\n]*:/g,":");for(var i,n=[],a=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");null!==(i=a.exec(t));){for(var o,r={},s=/[^\r\n]+[\r\n]+/g;null!==(o=s.exec(i[1]));)this.parse_param(o.toString(),r);r.uid&&!r.id&&(r.id=r.uid),n.push(r)}return n}},parse_param:function(e,t){var i,n=e.indexOf(":");-1!=n&&(i=e.substr(0,n).toLowerCase(),n=e.substr(n+1).replace(/\\\,/g,",").replace(/[\r\n]+$/,""),"summary"==i?i="text":"dtstart"==i?(i="start_date",n=this.parse_date(n,0,0)):"dtend"==i&&(i="end_date",n=this.parse_date(n,0,0)),t[i]=n)},parse_date:function(e,t,i){var n=e.split("T"),a=!1;n[1]&&(t=n[1].substr(0,2),i=n[1].substr(2,2),a=!("Z"!=n[1][6]));var o=n[0].substr(0,4),e=parseInt(n[0].substr(4,2),10)-1,n=n[0].substr(6,2);return P.config.server_utc||a?new Date(Date.UTC(o,e,n,t,i)):new Date(o,e,n,t,i)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"},P.on_load=function(e){this.callEvent("onBeforeParse",[]);var t,i,n=!1,a=!1;for(i in this._parsers){var o=this._parsers[i];if(o.canParse(e.xmlDoc.responseText,e.xmlDoc)){try{var r=e.xmlDoc.responseText;"xml"===i&&(r=e),(t=o.parse(r))||(n=!0)}catch(e){n=!0}a=!0;break}}if(!a)if(this._process&&this[this._process])try{t=this[this._process].parse(e.xmlDoc.responseText)}catch(e){n=!0}else n=!0;(n||e.xmlDoc.status&&400<=e.xmlDoc.status)&&(this.callEvent("onLoadError",[e.xmlDoc]),t=[]),this._process_loading(t),this.callEvent("onXLE",[]),this.callEvent("onParse",[])},P._process_loading=function(e){this._loading=!0,this._not_render=!0;for(var t=0;t<e.length;t++)this.callEvent("onEventLoading",[e[t]])&&this.addEvent(e[t]);this._not_render=!1,this._render_wait&&this.render_view_data(),this._loading=!1,this._after_call&&this._after_call(),this._after_call=null},P._init_event=function(e){e.text=e.text||e._tagvalue||"",e.start_date=P._init_date(e.start_date),e.end_date=P._init_date(e.end_date)},P._init_date=function(e){return e?"string"==typeof e?P._helpers.parseDate(e):new Date(e):null},P.json={},P.json.parse=function(e){var t;"string"==typeof e&&(e=JSON.parse(e)),t=("[object Array]"===Object.prototype.toString.call(e)?e:e?e.data:[])||[],e.dhx_security&&(window.dhtmlx&&(dhtmlx.security_key=e.dhx_security),P.security_key=e.dhx_security);var i,n=e&&e.collections?e.collections:{},a=!1;for(i in n)if(n.hasOwnProperty(i)){var a=!0,o=n[i],r=P.serverList[i];r||(P.serverList[i]=r=[]),r.splice(0,r.length);for(var s=0;s<o.length;s++){var l,d=o[s],_={key:d.value,label:d.label};for(l in d)if(d.hasOwnProperty(l)){if("value"==l||"label"==l)continue;_[l]=d[l]}r.push(_)}}a&&P.callEvent("onOptionsLoad",[]);for(var h=[],c=0;c<t.length;c++){var u=t[c];P._init_event(u),h.push(u)}return h},P.parse=function(e,t){this._process=t,this.on_load({xmlDoc:{responseText:e}})},P.load=function(e,t){"string"==typeof t&&(this._process=t,t=arguments[2]),this._load_url=e,this._after_call=t,this._load(e,this._date)},P.setLoadMode=function(e){this._load_mode=e="all"==e?"":e},P.serverList=function(e,t){return this.serverList[e]=t?t.slice(0):this.serverList[e]||[],this.serverList[e]},P._userdata={},P._xmlNodeToJSON=function(e){for(var t={},i=0;i<e.attributes.length;i++)t[e.attributes[i].name]=e.attributes[i].value;for(i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];1==n.nodeType&&(t[n.tagName]=n.firstChild?n.firstChild.nodeValue:"")}return t.text||(t.text=e.firstChild?e.firstChild.nodeValue:""),t},P.attachEvent("onXLS",function(){var e;!0===this.config.show_loading&&((e=this.config.show_loading=document.createElement("div")).className="dhx_loading",e.style.left=Math.round((this._x-128)/2)+"px",e.style.top=Math.round((this._y-15)/2)+"px",this._obj.appendChild(e))}),P.attachEvent("onXLE",function(){var e=this.config.show_loading;e&&"object"==typeof e&&(e.parentNode&&e.parentNode.removeChild(e),this.config.show_loading=!0)}),P._lightbox_controls={},P.formSection=function(e){for(var t=this.config.lightbox.sections,i=0;i<t.length&&t[i].name!=e;i++);var n=t[i];P._lightbox||P.getLightbox();var a=document.getElementById(n.id),o=a.nextSibling,r={section:n,header:a,node:o,getValue:function(e){return P.form_blocks[n.type].get_value(o,e||{},n)},setValue:function(e,t){return P.form_blocks[n.type].set_value(o,e,t||{},n)}},a=P._lightbox_controls["get_"+n.type+"_control"];return a?a(r):r},P._lightbox_controls.get_template_control=function(e){return e.control=e.node,e},P._lightbox_controls.get_select_control=function(e){return e.control=e.node.getElementsByTagName("select")[0],e},P._lightbox_controls.get_textarea_control=function(e){return e.control=e.node.getElementsByTagName("textarea")[0],e},P._lightbox_controls.get_time_control=function(e){return e.control=e.node.getElementsByTagName("select"),e},P._lightbox_controls.defaults={template:{height:30},textarea:{height:200},select:{height:23},time:{height:20}},P.form_blocks={template:{render:function(e){var t=P._lightbox_controls.defaults.template,t=t?t.height:30;return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+(e.height||t||30)+"px;'></div>"},set_value:function(e,t,i,n){e.innerHTML=t||""},get_value:function(e,t,i){return e.innerHTML||""},focus:function(e){}},textarea:{render:function(e){var t=P._lightbox_controls.defaults.textarea,t=t?t.height:200;return"<div class='dhx_cal_ltext' style='height:"+(e.height||t||"130")+"px;'><textarea></textarea></div>"},set_value:function(e,t,i){P.form_blocks.textarea._get_input(e).value=t||""},get_value:function(e,t){return P.form_blocks.textarea._get_input(e).value},focus:function(e){e=P.form_blocks.textarea._get_input(e);P._focus(e,!0)},_get_input:function(e){return e.getElementsByTagName("textarea")[0]}},select:{render:function(e){for(var t=P._lightbox_controls.defaults.select,t=t?t.height:23,i="<div class='dhx_cal_ltext' style='height:"+((e.height||t||"23")+"px")+";'><select style='width:100%;'>",n=0;n<e.options.length;n++)i+="<option value='"+e.options[n].key+"'>"+e.options[n].label+"</option>";return i+"</select></div>"},set_value:function(e,t,i,n){e=e.firstChild;!e._dhx_onchange&&n.onchange&&(e.onchange=n.onchange,e._dhx_onchange=!0),void 0===t&&(t=(e.options[0]||{}).value),e.value=t||""},get_value:function(e,t){return e.firstChild.value},focus:function(e){e=e.firstChild;P._focus(e,!0)}},time:{render:function(e){e.time_format||(e.time_format=["%H:%i","%d","%m","%Y"]),e._time_format_order={};var t=e.time_format,i=P.config,n=P.date.date_part(P._currentDate()),a=1440,o=0;P.config.limit_time_select&&(a=60*i.last_hour+1,o=60*i.first_hour,n.setHours(i.first_hour));for(var r="",s=0;s<t.length;s++){var l=t[s];0<s&&(r+=" ");var d="",_="";switch(l){case"%Y":d="dhx_lightbox_year_select";e._time_format_order[3]=s,e.year_range&&(isNaN(e.year_range)?e.year_range.push&&(u=e.year_range[0],m=e.year_range[1]):h=e.year_range);for(var h=h||10,c=c||Math.floor(h/2),u=u||n.getFullYear()-c,m=m||u+h,f=u;f<m;f++)_+="<option value='"+f+"'>"+f+"</option>";break;case"%m":d="dhx_lightbox_month_select",e._time_format_order[2]=s;for(f=0;f<12;f++)_+="<option value='"+f+"'>"+this.locale.date.month_full[f]+"</option>";break;case"%d":d="dhx_lightbox_day_select",e._time_format_order[1]=s;for(f=1;f<32;f++)_+="<option value='"+f+"'>"+f+"</option>";break;case"%H:%i":d="dhx_lightbox_time_select",e._time_format_order[0]=s;var f=o,p=n.getDate();for(e._time_values=[];f<a;)_+="<option value='"+f+"'>"+this.templates.time_picker(n)+"</option>",e._time_values.push(f),n.setTime(n.valueOf()+60*this.config.time_step*1e3),f=24*(n.getDate()!=p?1:0)*60+60*n.getHours()+n.getMinutes()}_&&(l=P._waiAria.lightboxSelectAttrString(l),r+="<select class='"+d+"' "+(e.readonly?"disabled='disabled'":"")+l+">"+_+"</select> ")}i=P._lightbox_controls.defaults.select;return"<div style='height:"+((i?i.height:23)||30)+"px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+r+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>"+r+"</div>"},set_value:function(t,e,i,d){function n(e,t,i){for(var n=d._time_values,a=60*i.getHours()+i.getMinutes(),o=a,r=!1,s=0;s<n.length;s++){var l=n[s];if(l===a){r=!0;break}l<a&&(o=l)}e[t+h[0]].value=r?a:o,r||o||(e[t+h[0]].selectedIndex=-1),e[t+h[1]].value=i.getDate(),e[t+h[2]].value=i.getMonth(),e[t+h[3]].value=i.getFullYear()}var a,o,r,s,l=P.config,_=t.getElementsByTagName("select"),h=d._time_format_order;if(l.full_day&&(t._full_day||(r="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+P.locale.labels.full_day+"&nbsp;</label></input>",P.config.wide_form||(r=t.previousSibling.innerHTML+r),t.previousSibling.innerHTML=r,t._full_day=!0),(s=t.previousSibling.getElementsByTagName("input")[0]).checked=0===P.date.time_part(i.start_date)&&0===P.date.time_part(i.end_date),_[h[0]].disabled=s.checked,_[h[0]+_.length/2].disabled=s.checked,s.onclick=function(){var e;s.checked?(P.form_blocks.time.get_value(t,e={},d),a=P.date.date_part(e.start_date),(+(o=P.date.date_part(e.end_date))==+a||+a<=+o&&(0!==i.end_date.getHours()||0!==i.end_date.getMinutes()))&&(o=P.date.add(o,1,"day"))):o=a=null,_[h[0]].disabled=s.checked,_[h[0]+_.length/2].disabled=s.checked,n(_,0,a||i.start_date),n(_,4,o||i.end_date)}),l.auto_end_date&&l.event_duration){function c(){a=new Date(_[h[3]].value,_[h[2]].value,_[h[1]].value,0,_[h[0]].value),o=new Date(a.getTime()+60*P.config.event_duration*1e3),n(_,4,o)}for(var u=0;u<4;u++)_[u].onchange=c}n(_,0,i.start_date),n(_,4,i.end_date)},get_value:function(e,t,i){e=e.getElementsByTagName("select"),i=i._time_format_order;return t.start_date=new Date(e[i[3]].value,e[i[2]].value,e[i[1]].value,0,e[i[0]].value),t.end_date=new Date(e[i[3]+4].value,e[i[2]+4].value,e[i[1]+4].value,0,e[i[0]+4].value),e[i[3]].value&&e[i[3]+4].value||(i=P.getEvent(P._lightbox_id))&&(t.start_date=i.start_date,t.end_date=i.end_date),t.end_date<=t.start_date&&(t.end_date=P.date.add(t.start_date,P.config.time_step,"minute")),{start_date:new Date(t.start_date),end_date:new Date(t.end_date)}},focus:function(e){P._focus(e.getElementsByTagName("select")[0])}}},P._setLbPosition=function(e){var t,i,n;e&&(t=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,i=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,n=window.innerHeight||document.documentElement.clientHeight,e.style.top=t?Math.round(t+Math.max((n-e.offsetHeight)/2,0))+"px":Math.round(Math.max((n-e.offsetHeight)/2,0)+9)+"px",document.documentElement.scrollWidth>document.body.offsetWidth?e.style.left=Math.round(i+(document.body.offsetWidth-e.offsetWidth)/2)+"px":e.style.left=Math.round((document.body.offsetWidth-e.offsetWidth)/2)+"px")},P.showCover=function(e){e&&(e.style.display="block",this._setLbPosition(e)),P.config.responsive_lightbox&&(document.documentElement.classList.add("dhx_cal_overflow_container"),document.body.classList.add("dhx_cal_overflow_container")),this.show_cover()},P.showLightbox=function(e){var t;e&&(this.callEvent("onBeforeLightbox",[e])?(t=this.getLightbox(),this.showCover(t),this._fill_lightbox(e,t),this._waiAria.lightboxVisibleAttr(t),this.callEvent("onLightbox",[e])):this._new_event&&(this._new_event=null))},P._fill_lightbox=function(e,t){var i,n,a=this.getEvent(e),o=t.getElementsByTagName("span"),r=[];P.templates.lightbox_header?(r.push(""),n=P.templates.lightbox_header(a.start_date,a.end_date,a),r.push(n),o[1].innerHTML="",o[2].innerHTML=n):(i=this.templates.event_header(a.start_date,a.end_date,a),n=(this.templates.event_bar_text(a.start_date,a.end_date,a)||"").substr(0,70),r.push(i),r.push(n),o[1].innerHTML=i,o[2].innerHTML=n),this._waiAria.lightboxHeader(t,r.join(" "));for(var s=this.config.lightbox.sections,l=0;l<s.length;l++){var d=s[l],_=P._get_lightbox_section_node(d),h=this.form_blocks[d.type],c=void 0!==a[d.map_to]?a[d.map_to]:d.default_value;h.set_value.call(this,_,c,a,d),s[l].focus&&h.focus.call(this,_)}P._lightbox_id=e},P._get_lightbox_section_node=function(e){return document.getElementById(e.id).nextSibling},P._lightbox_out=function(e){for(var t=this.config.lightbox.sections,i=0;i<t.length;i++){var n=(n=document.getElementById(t[i].id))&&n.nextSibling,n=this.form_blocks[t[i].type].get_value.call(this,n,e,t[i]);"auto"!=t[i].map_to&&(e[t[i].map_to]=n)}return e},P._empty_lightbox=function(e){var t=P._lightbox_id,t=this.getEvent(t);this.getLightbox(),this._lame_copy(t,e),this.setEvent(t.id,t),this._edit_stop_event(t,!0),this.render_view_data()},P.hide_lightbox=function(e){P.endLightbox(!1,this.getLightbox())},P.hideLightbox=P.hide_lightbox,P.hideCover=function(e){e&&(e.style.display="none"),this.hide_cover(),P.config.responsive_lightbox&&(document.documentElement.classList.remove("dhx_cal_overflow_container"),document.body.classList.remove("dhx_cal_overflow_container"))},P.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},P.show_cover=function(){this._cover||(this._cover=document.createElement("div"),this._cover.className="dhx_cal_cover",document.body.appendChild(this._cover))},P.save_lightbox=function(){var e=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));this.checkEvent("onEventSave")&&!this.callEvent("onEventSave",[this._lightbox_id,e,this._new_event])||(this._empty_lightbox(e),this.hide_lightbox())},P.startLightbox=function(e,t){this._lightbox_id=e,this._custom_lightbox=!0,this._temp_lightbox=this._lightbox,this._lightbox=t,this.showCover(t)},P.endLightbox=function(e,t){var t=t||P.getLightbox(),i=P.getEvent(this._lightbox_id);i&&this._edit_stop_event(i,e),e&&P.render_view_data(),this.hideCover(t),this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1),this._temp_lightbox=this._lightbox_id=null,this._waiAria.lightboxHiddenAttr(t),this.callEvent("onAfterLightbox",[])},P.resetLightbox=function(){P._lightbox&&!P._custom_lightbox&&P._lightbox.parentNode.removeChild(P._lightbox),P._lightbox=null},P.cancel_lightbox=function(){this.callEvent("onEventCancel",[this._lightbox_id,this._new_event]),this.hide_lightbox()},P._init_lightbox_events=function(){this.getLightbox().onclick=function(e){var t=e?e.target:event.srcElement;if(!((t=!t.className?t.previousSibling:t)&&t.className&&-1<P._getClassName(t).indexOf("dhx_btn_set"))||(t=t.querySelector("[dhx_button]"))){var i,n,a=P._getClassName(t);if(t&&a)switch(a){case"dhx_save_btn":P.save_lightbox();break;case"dhx_delete_btn":var o=P.locale.labels.confirm_deleting;P._dhtmlx_confirm(o,P.locale.labels.title_confirm_deleting,function(){P.deleteEvent(P._lightbox_id),P._new_event=null,P.hide_lightbox()});break;case"dhx_cancel_btn":P.cancel_lightbox();break;default:t.getAttribute("dhx_button")?P.callEvent("onLightboxButton",[a,t,e]):(-1!=a.indexOf("dhx_custom_button")&&(-1!=a.indexOf("dhx_custom_button_")?(i=t.parentNode.getAttribute("index"),n=t.parentNode.parentNode):(i=t.getAttribute("index"),n=t.parentNode,t=t.firstChild)),i&&P.form_blocks[P.config.lightbox.sections[i].type].button_click(i,t,n,n.nextSibling))}}},this.getLightbox().onkeydown=function(e){var t=e||window.event,i=e.target||e.srcElement,n=(n=i.querySelector("[dhx_button]"))||i.parentNode.querySelector(".dhx_custom_button, .dhx_readonly");switch((e||t).keyCode){case 32:if((e||t).shiftKey)return;n&&n.click&&n.click();break;case P.keys.edit_save:if((e||t).shiftKey)return;n&&n.click?n.click():P.save_lightbox();break;case P.keys.edit_cancel:P.cancel_lightbox()}}},P.setLightboxSize=function(){var e,t=this._lightbox;t&&((e=t.childNodes[1]).style.height="0px",e.style.height=e.scrollHeight+"px",t.style.height=e.scrollHeight+P.xy.lightbox_additional_height+"px",e.style.height=e.scrollHeight+"px")},P._init_dnd_events=function(){P.event(document.body,"mousemove",P._move_while_dnd),P.event(document.body,"mouseup",P._finish_dnd),P._init_dnd_events=function(){}},P._move_while_dnd=function(e){var t;P._dnd_start_lb&&(document.dhx_unselectable||(document.body.className+=" dhx_unselectable",document.dhx_unselectable=!0),t=P.getLightbox(),e=e&&e.target?[e.pageX,e.pageY]:[event.clientX,event.clientY],t.style.top=P._lb_start[1]+e[1]-P._dnd_start_lb[1]+"px",t.style.left=P._lb_start[0]+e[0]-P._dnd_start_lb[0]+"px")},P._ready_to_dnd=function(e){var t=P.getLightbox();P._lb_start=[parseInt(t.style.left,10),parseInt(t.style.top,10)],P._dnd_start_lb=e&&e.target?[e.pageX,e.pageY]:[event.clientX,event.clientY]},P._finish_dnd=function(){P._lb_start&&(P._lb_start=P._dnd_start_lb=!1,document.body.className=document.body.className.replace(" dhx_unselectable",""),document.dhx_unselectable=!1)},P.getLightbox=function(){if(!this._lightbox){var e=document.createElement("div");e.className="dhx_cal_light",P.config.wide_form&&(e.className+=" dhx_cal_light_wide"),P.form_blocks.recurring&&(e.className+=" dhx_cal_light_rec"),P.config.rtl&&(e.className+=" dhx_cal_light_rtl"),P.config.responsive_lightbox&&(e.className+=" dhx_cal_light_responsive"),/msie|MSIE 6/.test(navigator.userAgent)&&(e.className+=" dhx_ie6"),e.style.visibility="hidden";for(var t=this._lightbox_template,i=this.config.buttons_left,n=0;n<i.length;n++)t+="<div "+this._waiAria.lightboxButtonAttrString(i[n])+" class='dhx_btn_set dhx_"+(P.config.rtl?"right":"left")+"_btn_set "+i[n]+"_set'><div dhx_button='1' class='"+i[n]+"'></div><div>"+P.locale.labels[i[n]]+"</div></div>";for(var i=this.config.buttons_right,a=P.config.rtl,n=0;n<i.length;n++)t+="<div "+this._waiAria.lightboxButtonAttrString(i[n])+" class='dhx_btn_set dhx_"+(a?"left":"right")+"_btn_set "+i[n]+"_set' style='float:"+(a?"left":"right")+";'><div dhx_button='1' class='"+i[n]+"'></div><div>"+P.locale.labels[i[n]]+"</div></div>";e.innerHTML=t+="</div>",P.config.drag_lightbox&&(e.firstChild.onmousedown=P._ready_to_dnd,e.firstChild.onselectstart=function(){return!1},e.firstChild.style.cursor="move",P._init_dnd_events()),this._waiAria.lightboxAttr(e),document.body.insertBefore(e,document.body.firstChild),this._lightbox=e;for(var o=this.config.lightbox.sections,t="",n=0;n<o.length;n++){var r,s,l=this.form_blocks[o[n].type];l&&(o[n].id="area_"+this.uid(),r="",o[n].button&&(r="<div "+P._waiAria.lightboxSectionButtonAttrString(this.locale.labels["button_"+o[n].button])+" class='dhx_custom_button' index='"+n+"'><div class='dhx_custom_button_"+o[n].button+"'></div><div>"+this.locale.labels["button_"+o[n].button]+"</div></div>"),this.config.wide_form&&(t+="<div class='dhx_wrap_section'>"),"string"!=typeof(s=this.locale.labels["section_"+o[n].name])&&(s=o[n].name),t+="<div id='"+o[n].id+"' class='dhx_cal_lsection'>"+r+"<label>"+s+"</label></div>"+l.render.call(this,o[n]),t+="</div>")}for(var d=e.getElementsByTagName("div"),n=0;n<d.length;n++){var _=d[n];if("dhx_cal_larea"==P._getClassName(_)){_.innerHTML=t;break}}P._bindLightboxLabels(o),this.setLightboxSize(),this._init_lightbox_events(this),e.style.display="none",e.style.visibility="visible"}return this._lightbox},P._bindLightboxLabels=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i.id&&document.getElementById(i.id)){for(var n=document.getElementById(i.id).querySelector("label"),a=P._get_lightbox_section_node(i);a&&!a.querySelector;)a=a.nextSibling;var o,r=!0;!a||(o=a.querySelector("input, select, textarea"))&&(i.inputId=o.id||"input_"+P.uid(),o.id||(o.id=i.inputId),n.setAttribute("for",i.inputId),r=!1),r&&P.form_blocks[i.type].focus&&(n.onclick=function(i){return function(){var e=P.form_blocks[i.type],t=P._get_lightbox_section_node(i);e&&e.focus&&e.focus.call(P,t)}}(i))}}},P.attachEvent("onEventIdChange",function(e,t){this._lightbox_id==e&&(this._lightbox_id=t)}),P._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span></div><div class='dhx_cal_larea'></div>",P._init_touch_events=function(){if(!this.config.touch||-1==navigator.userAgent.indexOf("Mobile")&&-1==navigator.userAgent.indexOf("iPad")&&-1==navigator.userAgent.indexOf("Android")&&-1==navigator.userAgent.indexOf("Touch")||window.MSStream||(this.xy.scroll_width=0,this._mobile=!0),this.config.touch){var t=!0;try{document.createEvent("TouchEvent")}catch(e){t=!1}t?this._touch_events(["touchmove","touchstart","touchend"],function(e){return e.touches&&1<e.touches.length?null:e.touches[0]?{target:e.target,pageX:e.touches[0].pageX,pageY:e.touches[0].pageY,clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}:e},function(){return!1}):window.PointerEvent||window.navigator.pointerEnabled?this._touch_events(["pointermove","pointerdown","pointerup"],function(e){return"mouse"==e.pointerType?null:e},function(e){return!e||"mouse"==e.pointerType}):window.navigator.msPointerEnabled&&this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(e){return e.pointerType==e.MSPOINTER_TYPE_MOUSE?null:e},function(e){return!e||e.pointerType==e.MSPOINTER_TYPE_MOUSE})}},P._touch_events=function(e,o,r){function t(e,t,i){e.addEventListener(t,function(e){return!!P._is_lightbox_open()||(r(e)?void 0:i(e))},{passive:!1})}function i(e){r(e)||(P._hide_global_tip(),_&&(P._on_mouse_up(o(e||event)),P._temp_touch_block=!1),P._drag_id=null,P._drag_mode=null,P._drag_pos=null,P._pointerDragId=null,clearTimeout(d),_=c=!1,h=!0)}var s,l,d,_,h,c,u=(-1!=navigator.userAgent.indexOf("Android")&&navigator.userAgent.indexOf("WebKit"),0);t(document.body,e[0],function(e){if(!r(e)){var t=o(e);if(t)return _?(function(e){if(!r(e)){var t=P.getState().drag_mode,o=!!P.matrix&&P.matrix[P._mode],i=P.render_view_data;"create"==t&&o&&(P.render_view_data=function(){for(var e=P.getState().drag_id,t=P.getEvent(e),i=o.y_property,n=P.getEvents(t.start_date,t.end_date),a=0;a<n.length;a++)n[a][i]!=t[i]&&(n.splice(a,1),a--);t._sorder=n.length-1,t._count=n.length,this.render_data([t],P.getState().mode)}),P._on_mouse_move(e),"create"==t&&o&&(P.render_view_data=i),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0}}(t),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,P._update_global_tip(),!1):(l=o(e),c?l?void((s.target!=l.target||5<Math.abs(s.pageX-l.pageX)||5<Math.abs(s.pageY-l.pageY))&&(h=!0,clearTimeout(d))):void(h=!0):void 0)}}),t(this._els.dhx_cal_data[0],"touchcancel",i),t(this._els.dhx_cal_data[0],"contextmenu",function(e){if(!r(e))return c?(e&&e.preventDefault&&e.preventDefault(),!((e||event).cancelBubble=!0)):void 0}),t(this._obj,e[1],function(e){var t;if(!r(e))if(P._pointerDragId=e.pointerId,_=h=!1,c=!0,t=l=o(e)){var i=new Date;if(!h&&!_&&i-u<250)return P._click.dhx_cal_data(t),window.setTimeout(function(){t.type="dblclick",P._on_dbl_click(t)},50),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,!(P._block_next_stop=!0);if(u=i,!h&&!_&&P.config.touch_drag){var n=P._locate_event(document.activeElement),a=P._locate_event(t.target),i=s?P._locate_event(s.target):null;if(n&&a&&n==a&&n!=i)return e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,P._ignore_next_click=!1,P._click.dhx_cal_data(t),s=t,!1;d=setTimeout(function(){_=!0;var e=s.target,t=P._getClassName(e);e&&-1!=t.indexOf("dhx_body")&&(e=e.previousSibling),P._on_mouse_down(s,e),P._drag_mode&&"create"!=P._drag_mode&&P.for_rendered(P._drag_id,function(e,t){e.style.display="none",P._rendered.splice(t,1)}),P.config.touch_tip&&P._show_global_tip(),P.updateEvent(P._drag_id)},P.config.touch_drag),s=t}}else h=!0}),t(this._els.dhx_cal_data[0],e[2],function(e){if(!r(e))return P.config.touch_swipe_dates&&!_&&function(e,t,i,n){if(e&&t){for(var a=e.target;a&&a!=P._obj;)a=a.parentNode;if(a==P._obj&&!(P.matrix&&P.matrix[P.getState().mode]&&P.matrix[P.getState().mode].scrollable)){var o=Math.abs(e.pageY-t.pageY),r=Math.abs(e.pageX-t.pageX);return o<n&&i<r&&(!o||3<r/o)&&(e.pageX>t.pageX?P._click.dhx_cal_next_button():P._click.dhx_cal_prev_button(),1)}}}(s,l,200,100)&&(P._block_next_stop=!0),_&&(P._ignore_next_click=!0,setTimeout(function(){P._ignore_next_click=!1},100)),i(e),P._block_next_stop?(P._block_next_stop=!1,e.preventDefault&&e.preventDefault(),!(e.cancelBubble=!0)):void 0}),P.event(document.body,e[2],i)},P._show_global_tip=function(){P._hide_global_tip();var e=P._global_tip=document.createElement("div");e.className="dhx_global_tip",P._update_global_tip(1),document.body.appendChild(e)},P._update_global_tip=function(e){var t,i=P._global_tip;i&&(t="",!P._drag_id||e||(e=P.getEvent(P._drag_id))&&(t="<div>"+(e._timed?P.templates.event_header(e.start_date,e.end_date,e):P.templates.day_date(e.start_date,e.end_date,e))+"</div>"),"create"==P._drag_mode||"new-size"==P._drag_mode?i.innerHTML=(P.locale.labels.drag_to_create||"Drag to create")+t:i.innerHTML=(P.locale.labels.drag_to_move||"Drag to move")+t)},P._hide_global_tip=function(){var e=P._global_tip;e&&e.parentNode&&(e.parentNode.removeChild(e),P._global_tip=0)},P._dp_init=function(i){i._methods=["_set_event_text_style","","_dp_change_event_id","_dp_hook_delete"],this._dp_change_event_id=function(e,t){P.getEvent(e)&&P.changeEventId(e,t)},this._dp_hook_delete=function(e,t){if(P.getEvent(e))return t&&e!=t&&("true_deleted"==this.getUserData(e,i.action_param)&&this.setUserData(e,i.action_param,"updated"),this.changeEventId(e,t)),this.deleteEvent(t,!0)},this.attachEvent("onEventAdded",function(e){!this._loading&&this._validId(e)&&i.setUpdated(e,!0,"inserted")}),this.attachEvent("onConfirmedBeforeEventDelete",function(e){if(this._validId(e)){var t=i.getState(e);return"inserted"==t||this._new_event?(i.setUpdated(e,!1),!0):"deleted"!=t&&("true_deleted"==t||(i.setUpdated(e,!0,"deleted"),!1))}}),this.attachEvent("onEventChanged",function(e){!this._loading&&this._validId(e)&&i.setUpdated(e,!0,"updated")}),P.attachEvent("onClearAll",function(){i._in_progress={},i._invalid={},i.updatedRows=[],i._waitMode=0});var a=function(e,t,i){for(var n in i=i||"",t=t||{},e)0!==n.indexOf("_")&&(e[n]&&e[n].getUTCFullYear?t[i+n]=this.obj._helpers.formatDate(e[n]):e[n]&&"object"==typeof e[n]?a.call(this,e[n],t,i+n+"."):t[i+n]=e[n]);return t},n=function(e){var t,i=P.utils.copy(e);for(t in i)0===t.indexOf("_")?delete i[t]:i[t]&&(i[t].getUTCFullYear?i[t]=this.obj._helpers.formatDate(i[t]):"object"==typeof i[t]&&(i[t]=n(i[t])));return i};i._getRowData=function(e,t){e=this.obj.getEvent(e);return("JSON"==this._tMode?n:a).call(this,e)},i._clearUpdateFlag=function(){},i.attachEvent("insertCallback",P._update_callback),i.attachEvent("updateCallback",P._update_callback),i.attachEvent("deleteCallback",function(e,t){this.obj.getEvent(t)?(this.obj.setUserData(t,this.action_param,"true_deleted"),this.obj.deleteEvent(t)):this.obj._add_rec_marker&&this.obj._update_callback(e,t)})},P._validId=function(e){return!0},P.setUserData=function(e,t,i){e?(e=this.getEvent(e))&&(e[t]=i):this._userdata[t]=i},P.getUserData=function(e,t){if(e){e=this.getEvent(e);return e?e[t]:null}return this._userdata[t]},P._set_event_text_style=function(e,t){P.getEvent(e)&&(this.for_rendered(e,function(e){e.style.cssText+=";"+t}),(e=this.getEvent(e))._text_style=t,this.event_updated(e))},P._update_callback=function(e,t){e=P._xmlNodeToJSON(e.firstChild);"none"==e.rec_type&&(e.rec_pattern="none"),e.text=e.text||e._tagvalue,e.start_date=P._helpers.parseDate(e.start_date),e.end_date=P._helpers.parseDate(e.end_date),P.addEvent(e),P._add_rec_marker&&P.setCurrentView()},P.getRootView=function(){return{view:{render:function(){return{tag:"div",type:1,attrs:{style:"width:100%;height:100%;"},hooks:{didInsert:function(){P.setCurrentView()}},body:[{el:this.el,type:1}]}},init:function(){var e=document.createElement("DIV");e.id="scheduler_"+P.uid(),e.style.width="100%",e.style.height="100%",e.classList.add("dhx_cal_container"),e.cmp="grid",e.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab"></div><div class="dhx_cal_tab" name="week_tab"></div><div class="dhx_cal_tab" name="month_tab"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',P.init(e),this.el=e}},type:4}},P._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]},P._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]},P._is_material_skin=function(){return P.skin?-1<(P.skin+"").indexOf("material"):(void 0===p&&((e=document.createElement("div")).style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.innerHTML="<div class='dhx_cal_container'><div class='dhx_cal_scale_placeholder'></div><div>",document.body.appendChild(e),e=window.getComputedStyle(e.querySelector(".dhx_cal_scale_placeholder")).getPropertyValue("position"),p="absolute"===e,setTimeout(function(){p=null},500)),p);var e},window.addEventListener("DOMContentLoaded",e),window.addEventListener("load",e),P._border_box_events=t,P._configure=function(e,t,i){for(var n in t)void 0===e[n]&&(e[n]=t[n][i])},P._skin_init=function(){if(!P.skin)for(var e=document.getElementsByTagName("link"),t=0;t<e.length;t++){var i=e[t].href.match("dhtmlxscheduler_([a-z]+).css");if(i){P.skin=i[1];break}}var n,a,o=0;!P.skin||"classic"!==P.skin&&"glossy"!==P.skin||(o=1),P._is_material_skin()&&(n=P.config.buttons_left.$inital,a=P.config.buttons_right.$inital,n&&P.config.buttons_left.slice().join()==n&&a&&P.config.buttons_right.slice().join()==a&&(a=P.config.buttons_left.slice(),P.config.buttons_left=P.config.buttons_right.slice(),P.config.buttons_right=a),P.xy.event_header_height=18,P.xy.week_agenda_scale_height=35,P.xy.map_icon_width=38,P._lightbox_controls.defaults.textarea.height=64,P._lightbox_controls.defaults.time.height="auto"),this._configure(P.config,P._skin_settings,o),this._configure(P.xy,P._skin_xy,o),"flat"===P.skin&&(P.xy.scale_height=35,P.templates.hour_scale=function(e){var t=(t=e.getMinutes())<10?"0"+t:t;return"<span class='dhx_scale_h'>"+e.getHours()+"</span><span class='dhx_scale_m'>&nbsp;"+t+"</span>"}),o||((o=P.config.minicalendar)&&(o.padding=14),P.templates.event_bar_date=function(e,t,i){return"• <b>"+P.templates.event_date(e)+"</b> "},P.attachEvent("onTemplatesReady",function(){var i=P.date.date_to_str("%d");P.templates._old_month_day||(P.templates._old_month_day=P.templates.month_day);var n=P.templates._old_month_day;if(P.templates.month_day=function(e){if("month"!=this._mode)return n.call(this,e);var t=i(e);return 1==e.getDate()&&(t=P.locale.date.month_full[e.getMonth()]+" "+t),t=+e==+P.date.date_part(this._currentDate())?P.locale.labels.dhx_cal_today_button+" "+t:t},P.config.fix_tab_position){var e=P._els.dhx_cal_navline[0].getElementsByTagName("div"),t=null,a=211,o=[14,75,136],r=14;P._is_material_skin()&&(o=[16,103,192],a=294,r=-1);for(var s=0;s<e.length;s++){var l=e[s],d=l.getAttribute("name");if(d){switch(l.style.right="auto",d){case"day_tab":l.style.left=o[0]+"px",l.className+=" dhx_cal_tab_first";break;case"week_tab":l.style.left=o[1]+"px";break;case"month_tab":l.style.left=o[2]+"px",l.className+=" dhx_cal_tab_last";break;default:l.style.left=a+"px",l.className+=" dhx_cal_tab_standalone",a=a+r+l.offsetWidth}l.className+=" "+d}else 0===(l.className||"").indexOf("dhx_minical_icon")&&l.parentNode==P._els.dhx_cal_navline[0]&&(t=l)}t&&(t.style.left=a+"px")}}),P._skin_init=function(){})},window.jQuery&&(w=jQuery,D=0,E=[],w.fn.dhx_scheduler=function(n){if("string"!=typeof n){var a=[];return this.each(function(){if(this&&this.getAttribute)if(this.getAttribute("dhxscheduler"))a.push(window[this.getAttribute("dhxscheduler")]);else{var e="scheduler";D&&(e="scheduler"+(D+1),window[e]=Scheduler.getSchedulerInstance());var t,i=window[e];for(t in this.setAttribute("dhxscheduler",e),n)"data"!=t&&(i.config[t]=n[t]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',this.className+=" dhx_cal_container"),i.init(this,i.config.date,i.config.mode),n.data&&i.parse(n.data),a.push(i),D++}}),1===a.length?a[0]:a}if(E[n])return E[n].apply(this,[]);w.error("Method "+n+" does not exist on jQuery.dhx_scheduler")}),v=P.setCurrentView,x=P.updateView,b=y=null,P.attachEvent("onSchedulerReady",function(){P.config.delay_render?(P.setCurrentView=S,P.updateView=M):(P.setCurrentView=v,P.updateView=x)});for(var O=0;O<Scheduler._schedulerPlugins.length;O++)Scheduler._schedulerPlugins[O](P);return P._internal_id=Scheduler._seed++,Scheduler.$syncFactory&&Scheduler.$syncFactory(P),P},window.Scheduler=Scheduler,window.scheduler=Scheduler.getSchedulerInstance(),dhtmlx&&dhtmlx.attaches&&(dhtmlx.attaches.attachScheduler=function(e,t,i,n){var i=i||'<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div>',a=document.createElement("DIV");return a.id="dhxSchedObj_"+this._genStr(12),a.innerHTML='<div id="'+a.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div>'+i+'</div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div></div>',document.body.appendChild(a.firstChild),this.attachObject(a.id,!1,!0),this.vs[this.av].sched=n,this.vs[this.av].schedId=a.id,n.setSizes=n.updateView,n.destructor=function(){},n.init(a.id,e,t),this.vs[this._viewRestore()].sched})}(),Scheduler.plugin(function(k){k.config.limit_start=null,k.config.limit_end=null,k.config.limit_view=!1,k.config.check_limits=!0,k.config.mark_now=!0,k.config.display_marked_timespans=!0,k._temp_limit_scope=function(){function n(e,t,i){var n="object"==typeof e?e:{days:e};return n.type=_,n.css="",t&&(i&&(n.sections=i),i=n,t=t,(e=e)instanceof Date&&t instanceof Date?(i.start_date=e,i.end_date=t):(i.days=e,i.zones=t),n=i),n}var t=null,_="dhx_time_block",v="default";k.blockTime=function(e,t,i){i=n(e,t,i);return k.addMarkedTimespan(i)},k.unblockTime=function(e,t,i){i=n(e,t=t||"fullday",i);return k.deleteMarkedTimespan(i)},k.attachEvent("onBeforeViewChange",function(e,t,i,n){function a(e,t){var i=k.config.limit_start,n=k.config.limit_end,t=k.date.add(e,1,t);return e.valueOf()>n.valueOf()||t<=i.valueOf()}return!k.config.limit_view||(!a(n=n||t,i=i||e)||t.valueOf()==n.valueOf())||(setTimeout(function(){var e=a(t,i)?k.config.limit_start:t;k.setCurrentView(a(e,i)?null:e,i)},1),!1)}),k.checkInMarkedTimespan=function(e,t,i){t=t||v;for(var n=!0,a=new Date(e.start_date.valueOf()),o=k.date.add(a,1,"day"),r=k._marked_timespans;a<e.end_date;a=k.date.date_part(o),o=k.date.add(a,1,"day")){var s=+k.date.date_part(new Date(a)),l=function(e,t,i,n,a){var o,r=k,s=[],l={_props:"map_to",matrix:"y_property"};for(o in l){var d=l[o];if(r[o])for(var _ in r[o]){var h=r[o][_][d];e[h]&&(s=r._add_timespan_zones(s,k._get_blocked_zones(t[_],e[h],i,n,a)))}}return r._add_timespan_zones(s,k._get_blocked_zones(t,"global",i,n,a))}(e,r,a.getDay(),s,t);if(l)for(var d=0;d<l.length;d+=2){var _=k._get_zone_minutes(a),h=e.end_date>o||e.end_date.getDate()!=a.getDate()?1440:k._get_zone_minutes(e.end_date),c=l[d],u=l[d+1];if(c<h&&_<u&&!(n="function"==typeof i&&i(e,_,h,c,u)))break}}return!n};var a=k.checkLimitViolation=function(e){if(!e)return!0;if(!k.config.check_limits)return!0;var r=k,t=r.config,i=[];if(e.rec_type)for(var n=k.getRecDates(e),a=0;a<n.length;a++){var o=k._copy_event(e);k._lame_copy(o,n[a]),i.push(o)}else i=[e];for(var s=!0,l=0;l<i.length;l++){var d=!0;(o=i[l])._timed=k.isOneDayEvent(o),d=(d=(d=!t.limit_start||!t.limit_end||o.start_date.valueOf()>=t.limit_start.valueOf()&&o.end_date.valueOf()<=t.limit_end.valueOf())&&!k.checkInMarkedTimespan(o,_,function(e,t,i,n,a){var o=!0;return t<=a&&n<=t&&((1440==a||i<a)&&(o=!1),e._timed&&r._drag_id&&"new-size"==r._drag_mode?(e.start_date.setHours(0),e.start_date.setMinutes(a)):o=!1),(n<=i&&i<a||t<n&&a<i)&&(e._timed&&r._drag_id&&"new-size"==r._drag_mode?(e.end_date.setHours(0),e.end_date.setMinutes(n)):o=!1),o}))||(r.checkEvent("onLimitViolation")?r.callEvent("onLimitViolation",[o.id,o]):d),s=s&&d}return s||(r._drag_id=null,r._drag_mode=null),s};k._get_blocked_zones=function(e,t,i,n,a){var o=[];if(e&&e[t])for(var t=e[t],r=this._get_relevant_blocked_zones(i,n,t,a),s=0;s<r.length;s++)o=this._add_timespan_zones(o,r[s].zones);return o},k._get_relevant_blocked_zones=function(e,t,i,n){return i[t]&&i[t][n]?i[t][n]:i[e]&&i[e][n]?i[e][n]:[]},k.attachEvent("onMouseDown",function(e){return!(e==_)}),k.attachEvent("onBeforeDrag",function(e){return!e||a(k.getEvent(e))}),k.attachEvent("onClick",function(e,t){return a(k.getEvent(e))}),k.attachEvent("onBeforeLightbox",function(e){e=k.getEvent(e);return t=[e.start_date,e.end_date],a(e)}),k.attachEvent("onEventSave",function(e,t,i){if(t.start_date&&t.end_date||(n=k.getEvent(e),t.start_date=new Date(n.start_date),t.end_date=new Date(n.end_date)),t.rec_type){var n=k._lame_clone(t);return k._roll_back_dates(n),a(n)}return a(t)}),k.attachEvent("onEventAdded",function(e){if(!e)return!0;e=k.getEvent(e);return!a(e)&&k.config.limit_start&&k.config.limit_end&&(e.start_date<k.config.limit_start&&(e.start_date=new Date(k.config.limit_start)),e.start_date.valueOf()>=k.config.limit_end.valueOf()&&(e.start_date=this.date.add(k.config.limit_end,-1,"day")),e.end_date<k.config.limit_start&&(e.end_date=new Date(k.config.limit_start)),e.end_date.valueOf()>=k.config.limit_end.valueOf()&&(e.end_date=this.date.add(k.config.limit_end,-1,"day")),e.start_date.valueOf()>=e.end_date.valueOf()&&(e.end_date=this.date.add(e.start_date,this.config.event_duration||this.config.time_step,"minute")),e._timed=this.isOneDayEvent(e)),!0}),k.attachEvent("onEventChanged",function(e){if(!e)return!0;e=k.getEvent(e);if(!a(e)){if(!t)return!1;e.start_date=t[0],e.end_date=t[1],e._timed=this.isOneDayEvent(e)}return!0}),k.attachEvent("onBeforeEventChanged",function(e,t,i){return a(e)}),k.attachEvent("onBeforeEventCreated",function(e){e=k.getActionData(e).date,e={_timed:!0,start_date:e,end_date:k.date.add(e,k.config.time_step,"minute")};return a(e)}),k.attachEvent("onViewChange",function(){k._mark_now()}),k.attachEvent("onAfterSchedulerResize",function(){return window.setTimeout(function(){k._mark_now()},1),!0}),k.attachEvent("onTemplatesReady",function(){k._mark_now_timer=window.setInterval(function(){k._is_initialized()&&k._mark_now()},6e4)}),k._mark_now=function(e){var t="dhx_now_time";this._els[t]||(this._els[t]=[]);var i=k._currentDate(),n=this.config;k._remove_mark_now(),!e&&n.mark_now&&i<this._max_date&&i>this._min_date&&i.getHours()>=n.first_hour&&i.getHours()<n.last_hour&&(n=this.locate_holder_day(i),this._els[t]=k._append_mark_now(n,i))},k._append_mark_now=function(e,t){var i="dhx_now_time",n=k._get_zone_minutes(t),a={zones:[n,n+1],css:i,type:i};if(!this._table_view){if(this._props&&this._props[this._mode]){for(var o,n=this._props[this._mode],i=n.size||n.options.length,r=1<n.days?(o=e=n.size&&n.options.length?(n.position+e)/n.options.length*n.size:e)+i:(o=0)+i,s=[],l=o;l<r;l++){var d=l;a.days=d;d=k._render_marked_timespan(a,null,d)[0];s.push(d)}return s}return a.days=e,k._render_marked_timespan(a,null,e)}if("month"==this._mode)return a.days=+k.date.date_part(t),k._render_marked_timespan(a,null,null)},k._remove_mark_now=function(){for(var e="dhx_now_time",t=this._els[e],i=0;i<t.length;i++){var n=t[i],a=n.parentNode;a&&a.removeChild(n)}this._els[e]=[]},k._marked_timespans={global:{}},k._get_zone_minutes=function(e){return 60*e.getHours()+e.getMinutes()},k._prepare_timespan_options=function(e){var t=[],i=[];if("fullweek"==e.days&&(e.days=[0,1,2,3,4,5,6]),e.days instanceof Array){for(var n=e.days.slice(),a=0;a<n.length;a++){var o=k._lame_clone(e);o.days=n[a],t.push.apply(t,k._prepare_timespan_options(o))}return t}if(!e||!(e.start_date&&e.end_date&&e.end_date>e.start_date||void 0!==e.days&&e.zones)&&!e.type)return t;"fullday"==e.zones&&(e.zones=[0,1440]),e.zones&&e.invert_zones&&(e.zones=k.invertZones(e.zones)),e.id=k.uid(),e.css=e.css||"",e.type=e.type||v;var r=e.sections;if(r){for(var s in r)if(r.hasOwnProperty(s)){var l=r[s];l instanceof Array||(l=[l]);for(a=0;a<l.length;a++)(_=k._lame_copy({},e)).sections={},_.sections[s]=l[a],i.push(_)}}else i.push(e);for(var d=0;d<i.length;d++){var _,h=i[d],c=h.start_date,u=h.end_date;if(c&&u)for(var m=k.date.date_part(new Date(c)),f=k.date.add(m,1,"day");m<u;){delete(_=k._lame_copy({},h)).start_date,delete _.end_date,_.days=m.valueOf();var p=m<c?k._get_zone_minutes(c):0,g=f<u||u.getDate()!=m.getDate()?1440:k._get_zone_minutes(u);_.zones=[p,g],t.push(_),m=f,f=k.date.add(f,1,"day")}else h.days instanceof Date&&(h.days=k.date.date_part(h.days).valueOf()),h.zones=e.zones.slice(),t.push(h)}return t},k._get_dates_by_index=function(e,t,i){var n=[];t=k.date.date_part(new Date(t||k._min_date)),i=new Date(i||k._max_date);for(var a=t.getDay(),e=0<=e-a?e-a:7-t.getDay()+e,o=k.date.add(t,e,"day");o<i;o=k.date.add(o,1,"week"))n.push(o);return n},k._get_css_classes_by_config=function(e){var t=[];return e.type==_&&(t.push(_),e.css&&t.push(_+"_reset")),t.push("dhx_marked_timespan",e.css),t.join(" ")},k._get_block_by_config=function(e){var t=document.createElement("div");return e.html&&("string"==typeof e.html?t.innerHTML=e.html:t.appendChild(e.html)),t},k._render_marked_timespan=function(e,t,i){var n=[],a=k.config,o=this._min_date,r=this._max_date,s=!1;if(!a.display_marked_timespans)return n;if(!i&&0!==i){if(e.days<7)i=e.days;else{var l=new Date(e.days),s=+l;if(!(+l<+r&&+o<=+l))return n;i=l.getDay()}var d=o.getDay();i<d?i=7-(d-i):i-=d}var _=e.zones,h=k._get_css_classes_by_config(e);if(k._table_view&&"month"==k._mode){var c=[],u=[];if(t)c.push(t),u.push(i);else for(var u=s?[s]:k._get_dates_by_index(i),m=0;m<u.length;m++)c.push(this._scales[u[m]]);for(m=0;m<c.length;m++){t=c[m],i=u[m];var f=Math.floor((this._correct_shift(i,1)-o.valueOf())/(864e5*this._cols.length)),p=this.locate_holder_day(i,!1)%this._cols.length;if(!this._ignores[p]){var g=this.config.rtl?this._colsS.col_length-1-p:p,v=k._get_block_by_config(e),p=Math.max(t.offsetHeight-1,0),x=Math.max(t.offsetWidth-1,0),y=this._colsS[g],f=this._colsS.heights[f]+(this._colsS.height?this.xy.month_scale_height+2:2)-1;v.className=h,v.style.top=f+"px",v.style.lineHeight=v.style.height=p+"px";for(var b=0;b<_.length;b+=2){var w=_[m];if((D=_[m+1])<=w)return[];(P=v.cloneNode(!0)).style.left=y+Math.round(w/1440*x)+"px",P.style.width=Math.round((D-w)/1440*x)+"px",t.appendChild(P),n.push(P)}}}}else{l=i;if(this._ignores[this.locate_holder_day(i,!1)])return n;this._props&&this._props[this._mode]&&e.sections&&e.sections[this._mode]&&(l=(d=this._props[this._mode]).order[e.sections[this._mode]],s=d.order[e.sections[this._mode]],1<d.days?l=l*(d.size||d.options.length)+s:(l=s,d.size&&l>d.position+d.size&&(l=0))),t=t||k.locate_holder(l);for(m=0;m<_.length;m+=2){var D,P,w=Math.max(_[m],60*a.first_hour);if((D=Math.min(_[m+1],60*a.last_hour))<=w){if(m+2<_.length)continue;return[]}(P=k._get_block_by_config(e)).className=h;var E=24*this.config.hour_size_px+1;P.style.top=Math.round((60*w*1e3-36e5*this.config.first_hour)*this.config.hour_size_px/36e5)%E+"px",P.style.lineHeight=P.style.height=Math.max(Math.round(60*(D-w)*1e3*this.config.hour_size_px/36e5)%E,1)+"px",t.appendChild(P),n.push(P)}}return n},k._mark_timespans=function(){var e=this._els.dhx_cal_data[0],t=[];if(k._table_view&&"month"==k._mode)for(var i in this._scales){var n=new Date(+i);t.push.apply(t,k._on_scale_add_marker(this._scales[i],n))}else for(var n=new Date(k._min_date),a=0,o=e.childNodes.length;a<o;a++){var r=e.childNodes[a];r.firstChild&&-1<k._getClassName(r.firstChild).indexOf("dhx_scale_hour")||(t.push.apply(t,k._on_scale_add_marker(r,n)),n=k.date.add(n,1,"day"))}return t},k.markTimespan=function(e){var t=!1;this._els.dhx_cal_data||(k.get_elements(),t=!0);var i=k._marked_timespans_ids,n=k._marked_timespans_types,a=k._marked_timespans;k.deleteMarkedTimespan(),k.addMarkedTimespan(e);e=k._mark_timespans();return t&&(k._els=[]),k._marked_timespans_ids=i,k._marked_timespans_types=n,k._marked_timespans=a,e},k.unmarkTimespan=function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t];i.parentNode&&i.parentNode.removeChild(i)}},k._addMarkerTimespanConfig=function(e){var t="global",i=k._marked_timespans,n=e.id,a=k._marked_timespans_ids;a[n]||(a[n]=[]);var o,r=e.days,s=e.sections,l=e.type;if(e.id=n,s)for(var d in s)s.hasOwnProperty(d)&&(i[d]||(i[d]={}),o=s[d],(d=i[d])[o]||(d[o]={}),d[o][r]||(d[o][r]={}),d[o][r][l]||(d[o][r][l]=[],k._marked_timespans_types||(k._marked_timespans_types={}),k._marked_timespans_types[l]||(k._marked_timespans_types[l]=!0)),_=d[o][r][l],(e._array=_).push(e),a[n].push(e));else{i[t][r]||(i[t][r]={}),i[t][r][l]||(i[t][r][l]=[]),k._marked_timespans_types||(k._marked_timespans_types={}),k._marked_timespans_types[l]||(k._marked_timespans_types[l]=!0);var _=i[t][r][l];(e._array=_).push(e),a[n].push(e)}},k._marked_timespans_ids={},k.addMarkedTimespan=function(e){var t=k._prepare_timespan_options(e);if(t.length){for(var e=t[0].id,i=0;i<t.length;i++)k._addMarkerTimespanConfig(t[i]);return e}},k._add_timespan_zones=function(e,t){var i=e.slice();if(t=t.slice(),!i.length)return t;for(var n=0;n<i.length;n+=2)for(var a=i[n],o=i[n+1],r=n+2==i.length,s=0;s<t.length;s+=2){var l=t[s],d=t[s+1];if(o<d&&l<=o||l<a&&a<=d)i[n]=Math.min(a,l),i[n+1]=Math.max(o,d),n-=2;else{if(!r)continue;i.splice(n+(l<a?0:2),0,l,d)}t.splice(s--,2);break}return i},k._subtract_timespan_zones=function(e,t){for(var i=e.slice(),n=0;n<i.length;n+=2)for(var a=i[n],o=i[n+1],r=0;r<t.length;r+=2){var s=t[r],l=t[r+1];if(a<l&&s<o){var d=!1;s<=a&&o<=l&&i.splice(n,2),a<s&&(i.splice(n,2,a,s),d=!0),l<o&&i.splice(d?n+2:n,d?0:2,l,o),n-=2;break}}return i},k.invertZones=function(e){return k._subtract_timespan_zones([0,1440],e.slice())},k._delete_marked_timespan_by_id=function(e){var t=k._marked_timespans_ids[e];if(t)for(var i=0;i<t.length;i++)for(var n=t[i],a=n._array,o=0;o<a.length;o++)if(a[o]==n){a.splice(o,1);break}},k._delete_marked_timespan_by_config=function(e){var t,i,n,a=k._marked_timespans,o=e.sections,r=e.days,s=e.type||v;if(o)for(var l in o)o.hasOwnProperty(l)&&a[l]&&(i=o[l],a[l][i]&&(t=a[l][i]));else t=a.global;if(t)if(void 0!==r)t[r]&&t[r][s]&&(k._addMarkerTimespanConfig(e),k._delete_marked_timespans_list(t[r][s],e));else for(var d in t)t[d][s]&&(n=k._lame_clone(e),e.days=d,k._addMarkerTimespanConfig(n),k._delete_marked_timespans_list(t[d][s],e))},k._delete_marked_timespans_list=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],a=k._subtract_timespan_zones(n.zones,t.zones);if(a.length)n.zones=a;else{e.splice(i,1),i--;for(var o=k._marked_timespans_ids[n.id],r=0;r<o.length;r++)if(o[r]==n){o.splice(r,1);break}}}},k.deleteMarkedTimespan=function(e){if(arguments.length||(k._marked_timespans={global:{}},k._marked_timespans_ids={},k._marked_timespans_types={}),"object"!=typeof e)k._delete_marked_timespan_by_id(e);else{e.start_date&&e.end_date||(void 0!==e.days||e.type||(e.days="fullweek"),e.zones||(e.zones="fullday"));var t=[];if(e.type)t.push(e.type);else for(var i in k._marked_timespans_types)t.push(i);for(var n=k._prepare_timespan_options(e),a=0;a<n.length;a++)for(var o=n[a],r=0;r<t.length;r++){var s=k._lame_clone(o);s.type=t[r],k._delete_marked_timespan_by_config(s)}}},k._get_types_to_render=function(e,t){var i,n=e?k._lame_copy({},e):{};for(i in t||{})t.hasOwnProperty(i)&&(n[i]=t[i]);return n},k._get_configs_to_render=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push.apply(i,e[t]);return i},k._on_scale_add_marker=function(e,t){if(!k._table_view||"month"==k._mode){var i,n,a,o,r=t.getDay(),s=t.valueOf(),l=this._mode,d=k._marked_timespans,_=[],h=[];this._props&&this._props[l]&&(o=(a=(i=this._props[l]).options)[k._get_unit_index(i,t)],r=(t=1<i.days?(n=Math.round((t-k._min_date)/864e5),a=i.size||a.length,t=k.date.add(k._min_date,Math.floor(n/a),"day"),k.date.date_part(t)):k.date.date_part(new Date(this._date))).getDay(),s=t.valueOf(),d[l]&&d[l][o.key]&&(o=d[l][o.key],o=k._get_types_to_render(o[r],o[s]),_.push.apply(_,k._get_configs_to_render(o))));d=d.global,r=d[s]||d[r];_.push.apply(_,k._get_configs_to_render(r));for(var c=0;c<_.length;c++)h.push.apply(h,k._render_marked_timespan(_[c],e,t));return h}},k.attachEvent("onScaleAdd",function(){k._on_scale_add_marker.apply(k,arguments)}),k.dblclick_dhx_marked_timespan=function(e,t){k.callEvent("onScaleDblClick",[k.getActionData(e).date,t,e]),k.config.dblclick_create&&k.addEventNow(k.getActionData(e).date,null,e)}},k._temp_limit_scope()}),Scheduler.plugin(function(A){A._temp_matrix_scope=function(){var t=function(){var e,n={minMax:"[0;max]",maxMin:"[max;0]",nMaxMin:"[-max;0]"};function t(){var e=n.minMax,t=function(){var e=document.createElement("div");e.style.cssText="direction: rtl;overflow: auto;width:100px;height: 100px;position:absolute;top: -100500px;left: -100500px;";var t=document.createElement("div");return t.style.cssText="width: 100500px;height: 1px;",e.appendChild(t),e}();document.body.appendChild(t);e=0<t.scrollLeft?n.minMax:(t.scrollLeft=-50)===t.scrollLeft?n.nMaxMin:n.maxMin;return document.body.removeChild(t),e}function a(e,t){var i=o();return i===n.nMaxMin?e?-e:0:i===n.minMax?t-e:e}function o(){return e=e||t()}return{modes:n,getMode:o,normalizeValue:a,getScrollValue:function(e){var t=getComputedStyle(e).direction;if(t&&"ltr"!==t){t=e.scrollWidth-e.offsetWidth;return a(e.scrollLeft,t)}return e.scrollLeft},setScrollValue:function(e,t){var i=getComputedStyle(e).direction;i&&"ltr"!==i?(i=a(t,e.scrollWidth-e.offsetWidth),e.scrollLeft=i):e.scrollLeft=t}}};function g(e){for(var t={},i=e.y_unit_original||e.y_unit,n=0;n<i.length;n++)!function e(t,i){if((i[t.key]=t).children)for(var n=0;n<t.children.length;n++)e(t.children[n],i)}(i[n],t);return t}A.matrix={},A._merge=function(e,t){for(var i in t)void 0===e[i]&&(e[i]=t[i])},A.createTimelineView=function(r){A._skin_init(),A._merge(r,{scrollHelper:t(),column_width:100,autoscroll:{range_x:200,range_y:100,speed_x:20,speed_y:10},_is_new_view:!0,_section_autowidth:!0,_x_scroll:0,_y_scroll:0,_h_cols:{},_label_rows:[],section_autoheight:!0,name:"matrix",x:"time",y:"time",x_step:1,x_unit:"hour",y_unit:"day",y_step:1,x_start:0,x_size:24,y_start:0,y_size:7,render:"cell",dx:200,dy:50,event_dy:A.xy.bar_height-5,event_min_dy:A.xy.bar_height-5,resize_events:!0,fit_events:!0,show_unassigned:!1,second_scale:!1,round_position:!1,_logic:function(e,t,i){var n={};return n=A.checkEvent("onBeforeSectionRender")?A.callEvent("onBeforeSectionRender",[e,t,i]):n}}),r._original_x_start=r.x_start,"day"!=r.x_unit&&(r.first_hour=r.last_hour=0),r._start_correction=r.first_hour?60*r.first_hour*60*1e3:0,r._end_correction=r.last_hour?60*(24-r.last_hour)*60*1e3:0,A.checkEvent("onTimelineCreated")&&A.callEvent("onTimelineCreated",[r]),dhtmlxEventable(r);var n=A.render_data;A.render_data=function(e,t){if(this._mode!=r.name)return n.apply(this,arguments);if(t&&!r.show_unassigned&&"cell"!=r.render)for(var i=0;i<e.length;i++)this.clear_event(e[i]),this.render_timeline_event.call(this.matrix[this._mode],e[i],!0);else A._renderMatrix.call(r,!0,!0)},A.matrix[r.name]=r,A.templates[r.name+"_cell_value"]=function(e){return e?e.length:""},A.templates[r.name+"_cell_class"]=function(e){return""},A.templates[r.name+"_scalex_class"]=function(e){return""},A.templates[r.name+"_second_scalex_class"]=function(e){return""},A.templates[r.name+"_row_class"]=function(e,t){return t.folder_events_available&&e.children?"folder":""},A.templates[r.name+"_scaley_class"]=function(e,t,i){return""},A.templates[r.name+"_scale_label"]=function(e,t,i){return t},A.templates[r.name+"_tooltip"]=function(e,t,i){return i.text},A.templates[r.name+"_date"]=function(e,t){return e.getDay()==t.getDay()&&t-e<864e5||+e==+A.date.date_part(new Date(t))||+A.date.add(e,1,"day")==+t&&0===t.getHours()&&0===t.getMinutes()?A.templates.day_date(e):e.getDay()!=t.getDay()&&t-e<864e5?A.templates.day_date(e)+" &ndash; "+A.templates.day_date(t):A.templates.week_date(e,t)},A.templates[r.name+"_scale_date"]=A.date.date_to_str(r.x_date||A.config.hour_date),A.templates[r.name+"_second_scale_date"]=A.date.date_to_str(r.second_scale&&r.second_scale.x_date?r.second_scale.x_date:A.config.hour_date),A.date["add_"+r.name+"_private"]=function(e,t){var i=t,n=r.x_unit;return"minute"!=r.x_unit&&"hour"!=r.x_unit||(t=i,"hour"==r.x_unit&&(t*=60),t%1440||(i=t/1440,n="day")),A.date.add(e,i,n)},A.date["add_"+r.name]=function(e,t,i){var n,a,o=A.date["add_"+r.name+"_private"](e,(r.x_length||r.x_size)*r.x_step*t);return"minute"!=r.x_unit&&"hour"!=r.x_unit||(a=r.x_length||r.x_size,(n="hour"==r.x_unit?60*r.x_step:r.x_step)*a%1440&&(+A.date.date_part(new Date(e))==+A.date.date_part(new Date(o))?r.x_start+=t*a:(a=Math.round((1440/(a*n)-1)*a),r.x_start=0<t?r.x_start-a:a+r.x_start))),o},A.date[r.name+"_start"]=function(e){var t=(A.date[r.x_unit+"_start"]||A.date.day_start).call(A.date,e),i=t.getTimezoneOffset(),e=(t=A.date.add(t,r.x_step*r.x_start,r.x_unit)).getTimezoneOffset();return i!=e&&t.setTime(t.getTime()+6e4*(e-i)),t},r.scrollTo=A.bind(function(e){var t,i,n;e&&(i=e.date||e.left||e,t=-1,e.section?t=this.posFromSection(e.section):e.top&&(t=e.top),e="number"==typeof i?i:this.posFromDate(i),A.config.rtl&&(i=+A.$container.querySelector(".dhx_timeline_label_wrapper").style.height.replace("px",""),n=this._section_height[this.y_unit.length]+this._label_rows[this._label_rows.length-1].top,this.scrollHelper.getMode()==this.scrollHelper.modes.minMax&&(i<n||"tree"==this.render)&&(e-=M())),n=A.$container.querySelector(".dhx_timeline_data_wrapper"),this.scrollable||(n=A.$container.querySelector(".dhx_cal_data")),this.scrollable&&this.scrollHelper.setScrollValue(n,e),0<t&&(n.scrollTop=t))},r),r.getScrollPosition=A.bind(function(){return{left:this._x_scroll||0,top:this._y_scroll||0}},r),r.posFromDate=A.bind(function(e){return A._timeline_getX({start_date:e},!1,this)-1},r),r.posFromSection=A.bind(function(e){var t=this.order[e];if(void 0===t)return-1;var i,n=0;for(i in this.order)this.order[i]<t&&(n+=this._section_height[i]);return n},r),r.selectEvents=A.bind(function(e){var t=e.section,i=e.date,e=e.selectNested;return i?function(e,t,i,n){var a=A._timeline_smart_render.getPreparedEvents(n),o=[],r=[],s=n.order[e],e=n.y_unit[s];if(!e)return[];t=A._get_date_index(n,t);return a.$matrix?(o=a.$matrix[s][t]||[],i&&a.$matrix.$tree&&a.$matrix.$tree[e.key]&&(r=a.$matrix.$tree[e.key][t]||[]),o.concat(r)):a[s]||[]}(t,i,e,this):t?function(e,t,i){var n=A._timeline_smart_render.getPreparedEvents(i),a=i.order[e],o=i.y_unit[a];if(!o)return[];var r=[e];t&&!function e(t,i){i=i||[];if(t.children)for(var n=0;n<t.children.length;n++)i.push(t.children[n].key),e(t.children[n],i);return i}(o,r);for(var s=[],l=0;l<r.length;l++)if(void 0!==(a=i.order[r[l]])&&n[a])s=s.concat(n[a]);else if(n.undefined)for(var d=0;d<n.undefined.length;d++){var _=n.undefined[d];_[i.y_property]==r[l]&&s.push(_)}return s}(t,e,this):void 0},r),r.setRange=A.bind(function(e,t){var i=A.date[this.name+"_start"](new Date(e)),t=function(e,t,i){for(var n=0,a=A.date[i.name+"_start"](new Date(e)),o=i.x_step,r=i.x_unit;a<t;)n++,a=A.date.add(a,o,r);return n}(e,t,this);this.x_size=t,A.setCurrentView(i,this.name)},r),A.callEvent("onOptionsLoad",[r]),A[r.name+"_view"]=function(e){e?A._set_timeline_dates(r):A._renderMatrix.apply(r,arguments)};var e=new Date;A.date.add(e,r.x_step,r.x_unit).valueOf(),e.valueOf();A["mouse_"+r.name]=function(e){var t=this._drag_event;this._drag_id&&(t=this.getEvent(this._drag_id)),r.scrollable&&!e.converted?(e.converted=1,e.x+=-r.dx+r._x_scroll,A.config.rtl&&(i=+A.$container.querySelector(".dhx_timeline_label_wrapper").style.height.replace("px",""),n=r._section_height[r.y_unit.length]+r._label_rows[r._label_rows.length-1].top,e.x+=A.xy.scale_width,r.scrollHelper.getMode()==r.scrollHelper.modes.minMax&&(i<n||"tree"==r.render)&&(e.x+=M())),e.y+=r._y_scroll):A.config.rtl?e.x-=r.dx-A.xy.scale_width:e.x-=r.dx;var i,n,a=A._timeline_drag_date(r,e.x);if(e.x=0,e.force_redraw=!0,e.custom=!0,"move"==this._drag_mode&&this._drag_id&&this._drag_event&&(t=this.getEvent(this._drag_id),i=this._drag_event,e._ignores=this._ignores_detected||r._start_correction||r._end_correction,void 0===i._move_delta&&(i._move_delta=(t.start_date-a)/6e4,this.config.preserve_length&&e._ignores&&(i._move_delta=this._get_real_event_length(t.start_date,a,r),i._event_length=this._get_real_event_length(t.start_date,t.end_date,r))),a=this.config.preserve_length&&e._ignores?(i._event_length,n=this._get_fictional_event_length(a,i._move_delta,r,!0),new Date(a-n)):A.date.add(a,i._move_delta,"minute")),"resize"==this._drag_mode&&t&&(this.config.timeline_swap_resize&&this._drag_id&&(this._drag_from_start&&+a>+t.end_date?this._drag_from_start=!1:!this._drag_from_start&&+a<+t.start_date&&(this._drag_from_start=!0)),e.resize_from_start=this._drag_from_start,!this.config.timeline_swap_resize&&this._drag_id&&this._drag_from_start&&+a>=+A.date.add(t.end_date,-A.config.time_step,"minute")&&(a=A.date.add(t.end_date,-A.config.time_step,"minute"))),r.round_position)switch(this._drag_mode){case"move":this.config.preserve_length||(a=A._timeline_get_rounded_date.call(r,a,!1),"day"==r.x_unit&&(e.custom=!1));break;case"resize":this._drag_event&&(null!==this._drag_event._resize_from_start&&void 0!==this._drag_event._resize_from_start||(this._drag_event._resize_from_start=e.resize_from_start),e.resize_from_start=this._drag_event._resize_from_start,a=A._timeline_get_rounded_date.call(r,a,!this._drag_event._resize_from_start))}this._resolve_timeline_section(r,e),e.section&&this._update_timeline_section({pos:e,event:this.getEvent(this._drag_id),view:r}),e.y=Math.round((this._correct_shift(a,1)-this._min_date)/(6e4*this.config.time_step)),e.shift=this.config.time_step,r.round_position&&"new-size"==this._drag_mode&&a<=this._drag_start&&(e.shift=A.date.add(this._drag_start,r.x_step,r.x_unit)-this._drag_start);t=this._is_pos_changed(this._drag_pos,e);return this._drag_pos&&t&&(this._drag_event._dhx_changed=!0),t||this._drag_pos.has_moved||(e.force_redraw=!1),e}},A._prepare_timeline_events=function(e){var t=[];if("cell"==e.render)t=A._timeline_trace_events.call(e);else{for(var i=A.get_visible_events(),n=e.order,a=0;a<i.length;a++){var o=i[a],r=o[e.y_property],s=e.order[r];e.y_unit[s];if(e.show_unassigned&&!r){for(var l in n)if(n.hasOwnProperty(l)){t[s=n[l]]||(t[s]=[]);var d=A._lame_copy({},o);d[e.y_property]=l,t[s].push(d);break}}else t[s]||(t[s]=[]),t[s].push(o)}t.$matrix=A._timeline_trace_events.call(e)}return t},A._populate_timeline_rendered=function(e){A._rendered=[];for(var t=e.querySelectorAll("div[event_id]"),i=0;i<t.length;i++)A._rendered.push(t[i])},A._get_timeline_event_height=function(e,t){var i=e[t.y_property],n=t.event_dy;return"full"==t.event_dy&&(n=t.section_autoheight?t._section_height[i]-6:t.dy-3),n=t.resize_events?Math.max(Math.floor(n/(e._count||1)),t.event_min_dy):n},A._get_timeline_event_y=function(e,t){e=e||0,t=2+e*t+(e?2*e:0);return t=A.config.cascade_event_display?2+e*A.config.cascade_event_margin+(e?2*e:0):t},A.render_timeline_event=function(e,t){var i=e[this.y_property];if(!i)return"";var n=e._sorder,a=A._timeline_getX(e,!1,this),o=A._timeline_getX(e,!0,this),r=A._get_timeline_event_height(e,this),s=r-2;e._inner||"full"!=this.event_dy||(s=(s+2)*(e._count-n)-2),s+=3;var l=A._get_timeline_event_y(e._sorder,r),d=r+l+2;(!this._events_height[i]||this._events_height[i]<d)&&(this._events_height[i]=d);var _="dhx_cal_event_line "+((_=A.templates.event_class(e.start_date,e.end_date,e))||"");A.getState().select_id==e.id&&(_+=" dhx_cal_event_selected"),e._no_drag_move&&(_+=" no_drag_move");n=e.color?"background:"+e.color+";":"",r=e.textColor?"color:"+e.textColor+";":"",d=A.templates.event_bar_text(e.start_date,e.end_date,e),o="<div "+A._waiAria.eventBarAttrString(e)+" event_id='"+e.id+"' class='"+_+"' style='"+n+r+"position:absolute; top:"+l+"px; height: "+s+"px; "+(A.config.rtl?"right:":"left:")+a+"px; width:"+Math.max(0,o-a)+"px;"+(e._text_style||"")+"'>";if(A.config.drag_resize&&!A.config.readonly&&(a="dhx_event_resize",s=s+1,o+=(e._no_resize_start?"":"<div class='"+a+" "+a+"_start' style='height: "+s+"px;'></div>")+(e._no_resize_end?"":"<div class='"+a+" "+a+"_end' style='height: "+s+"px;'></div>")),o+=d+"</div>",!t)return o;t=document.createElement("div");t.innerHTML=o;i=this._scales[i];i&&(A._rendered.push(t.firstChild),i.appendChild(t.firstChild))};function S(e){return String(e).replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function M(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var i=e.offsetWidth;t.style.overflow="scroll";e=e.offsetWidth;return i==e&&(e=t.clientWidth),document.body.removeChild(t),i-e}function k(e){return A._helpers.formatDate(e)}function O(e,t){e=e.querySelector(".dhx_timeline_data_wrapper");return e=!t.scrollable?A.$container.querySelector(".dhx_cal_data"):e}function N(){return A.$container.querySelector(".dhx_cal_data .dhx_timeline_label_col")}A._timeline_trace_events=function(){return function(e,t){for(var i=[],n=0;n<t.y_unit.length;n++)i[n]=[];i[c]||(i[c]=[]);var a=g(t),o="tree"==t.render;function r(e,t,i,n){e[t]||(e[t]=[]);for(var a=i;a<=n;a++)e[t][a]||(e[t][a]=[]),e[t][a].push(_)}o&&(i.$tree={});for(var s,l,d=t.y_property,n=0;n<e.length;n++){var _=e[n],h=_[d];s=h;var c=l=void 0===(l=(l=t).order[s])?"$_"+s:l,u=A._get_date_index(t,_.start_date),m=A._get_date_index(t,_.end_date);_.end_date.valueOf()==t._trace_x[m].valueOf()&&--m,i[c]||(i[c]=[]),r(i,c,u,m);var f=a[h];if(o&&f&&f.$parent)for(;f.$parent;){var p=a[f.$parent];r(i.$tree,p.key,u,m),f=p}}return i}(A.get_visible_events(),this)},A._timeline_getX=function(e,t,i){var n=0,a=i._step,o=i.round_position,r=0,s=t?e.end_date:e.start_date,l=(s=s.valueOf()>A._max_date.valueOf()?A._max_date:s)-A._min_date_timeline;if(0<l){var d=A._get_date_index(i,s);A._ignores[d]&&(o=!0);for(var _=0;_<d;_++)n+=A._cols[_];e=A._timeline_get_rounded_date.apply(i,[s,!1]);o?+e<+s&&t&&(r=A._cols[d]):(l=s-e,i.first_hour||i.last_hour?((l-=i._start_correction)<0&&(l=0),(r=Math.round(l/a))>A._cols[d]&&(r=A._cols[d])):r=Math.round(l/a))}A._border_box_events();return n+=t?0===l||o?r-2:r:r+1},A._timeline_get_rounded_date=function(e,t){var i=A._get_date_index(this,e),n=this._trace_x[i];return t&&+e!=+this._trace_x[i]&&(n=this._trace_x[i+1]||A.date.add(this._trace_x[i],this.x_step,this.x_unit)),new Date(n)},A._timeline_skip_ignored=function(e){if(A._ignores_detected)for(var t,i,n,a,o=0;o<e.length;o++){for(a=e[o],n=!1,t=A._get_date_index(this,a.start_date),i=A._get_date_index(this,a.end_date);t<i;){if(!A._ignores[t]){n=!0;break}t++}n||t!=i||A._ignores[i]||+a.end_date>+this._trace_x[i]&&(n=!0),n||(e.splice(o,1),o--)}},A._timeline_calculate_event_positions=function(e){if(e&&"cell"!=this.render){A._timeline_skip_ignored.call(this,e),e.sort(this.sort||function(e,t){return e.start_date.valueOf()==t.start_date.valueOf()?e.id>t.id?1:-1:e.start_date>t.start_date?1:-1});for(var t=[],i=e.length,n=-1,a=null,o=0;o<i;o++){var r=e[o];r._inner=!1;var s=this.round_position?A._timeline_get_rounded_date.apply(this,[r.start_date,!1]):r.start_date;for(this.round_position?A._timeline_get_rounded_date.apply(this,[r.end_date,!0]):r.end_date;t.length;){if(!(t[t.length-1].end_date.valueOf()<=s.valueOf()))break;t.splice(t.length-1,1)}for(var l=!1,d=0;d<t.length;d++){var _=t[d];if(_.end_date.valueOf()<=s.valueOf()){l=!0,r._sorder=_._sorder,t.splice(d,1),r._inner=!0;break}}if(t.length&&(t[t.length-1]._inner=!0),!l)if(t.length)if(t.length<=t[t.length-1]._sorder){if(t[t.length-1]._sorder)for(var h=0;h<t.length;h++){for(var c=!1,u=0;u<t.length;u++)if(t[u]._sorder==h){c=!0;break}if(!c){r._sorder=h;break}}else r._sorder=0;r._inner=!0}else{for(var m=t[0]._sorder,f=1;f<t.length;f++)t[f]._sorder>m&&(m=t[f]._sorder);r._sorder=m+1,n<r._sorder&&(n=r._sorder,a=r),r._inner=!1}else r._sorder=0;t.push(r),t.length>(t.max_count||0)?(t.max_count=t.length,r._count=t.length):r._count=r._count||1}for(var p=0;p<e.length;p++)e[p]._count=t.max_count,A._register_copy&&A._register_copy(e[p]);(a||e[0])&&A.render_timeline_event.call(this,a||e[0],!1)}},A._timeline_get_events_html=function(e){var t="";if(e&&"cell"!=this.render)for(var i=0;i<e.length;i++)t+=A.render_timeline_event.call(this,e[i],!1);return t},A._timeline_update_events_html=function(e){var t="";if(e&&"cell"!=this.render){var i=A.getView(),n={};e.forEach(function(e){n[e.id+"_"+e[i.y_property]]=!0}),A._rendered.forEach(function(e){var t;e.parentNode&&(t=e.parentNode.getAttribute("data-section-id"),n[e.getAttribute("event_id")+"_"+t]&&e.parentNode.removeChild(e))});for(var a=0;a<e.length;a++)t+=A.render_timeline_event.call(this,e[a],!1)}return t},A._timeline_get_block_stats=function(e,t){var i={};return t._sch_height=e.offsetHeight,i.style_data_wrapper=(A.config.rtl?"padding-right:":"padding-left:")+t.dx+"px;",i.style_label_wrapper="width: "+t.dx+"px;",t.scrollable?(i.style_data_wrapper+="height:"+(t._sch_height-1)+"px;",void 0===t.html_scroll_width&&(t.html_scroll_width=M()),t._section_autowidth?t.custom_scroll_width=0:t.custom_scroll_width=t.html_scroll_width,i.style_label_wrapper+="height:"+(t._sch_height-1-t.custom_scroll_width)+"px;"):(i.style_data_wrapper+="height:"+(t._sch_height-1)+"px;",i.style_label_wrapper+="height:"+(t._sch_height-1)+"px;overflow:visible;"),i},A._timeline_get_cur_row_stats=function(e,t){var i,n=e._logic(e.render,e.y_unit[t],e);return A._merge(n,{height:e.dy}),e.section_autoheight&&(i=e.scrollable?e._sch_height-A.xy.scroll_width:e._sch_height,e.y_unit.length*n.height<i&&(n.height=Math.max(n.height,Math.floor((i-1)/e.y_unit.length)))),e._section_height[e.y_unit[t].key]=n.height,n.td_className||(n.td_className="dhx_matrix_scell"+(A.templates[e.name+"_scaley_class"](e.y_unit[t].key,e.y_unit[t].label,e.y_unit[t])?" "+A.templates[e.name+"_scaley_class"](e.y_unit[t].key,e.y_unit[t].label,e.y_unit[t]):"")),n.td_content||(n.td_content=A.templates[e.name+"_scale_label"](e.y_unit[t].key,e.y_unit[t].label,e.y_unit[t])),A._merge(n,{tr_className:"",style_height:"height:"+n.height+"px;",style_width:"width:"+e.dx+"px;",summ_width:"width:"+e._summ+"px;",table_className:""}),n},A._timeline_get_fit_events_stats=function(e,t,i){var n;return e.fit_events&&(n=e._events_height[e.y_unit[t].key]||0,i.height=n>i.height?n:i.height,i.style_height="height:"+i.height+"px;",i.style_line_height="line-height:"+(i.height-1)+"px;",e._section_height[e.y_unit[t].key]=i.height),i.style_height="height:"+i.height+"px;",i.style_line_height="line-height:"+(i.height-1)+"px;",e._section_height[e.y_unit[t].key]=i.height,i},A._timeline_set_scroll_pos=function(e,t){e=e.querySelector(".dhx_timeline_data_wrapper");e.scrollTop=t._y_scroll||0,t.scrollHelper.setScrollValue(e,t._x_scroll||0),t.scrollHelper.getMode()!=t.scrollHelper.modes.maxMin&&e.scrollLeft==t._summ-e.offsetWidth+t.dx&&(e.scrollLeft+=M())},A._timeline_save_scroll_pos=function(e,t,i,n){e._y_scroll=t||0,e._x_scroll=i||0},A._timeline_get_html_for_cell_data_row=function(e,t,i,n,a){var o="";return a.template&&(o+=" "+(a.template(a.section,a.view)||"")),"<div class='dhx_timeline_data_row"+o+"' data-section-id='"+S(n)+"' data-section-index='"+e+"' style='"+t.summ_width+t.style_height+" position:absolute; top:"+i+"px;'>"},A._timeline_get_html_for_cell_ignores=function(e){return'<div class="dhx_matrix_cell dhx_timeline_data_cell" style="'+e.style_height+e.style_line_height+';display:none"></div>'},A._timeline_get_html_for_cell=function(e,t,i,n,a,o){var r=i._trace_x[e],s=i.y_unit[t],l=A._cols[e],d=k(r),t=A.templates[i.name+"_cell_value"](n,r,s);return"<div data-col-id='"+e+"' data-col-date='"+d+"' class='dhx_matrix_cell dhx_timeline_data_cell "+A.templates[i.name+"_cell_class"](n,r,s)+"' style='width:"+l+"px;"+a.style_height+a.style_line_height+(A.config.rtl?" right:":"  left:")+o+"px;'><div style='width:auto'>"+t+"</div></div>"},A._timeline_get_html_for_bar_matrix_line=function(e,t,i,n){return"<div style='"+t.summ_width+" "+t.style_height+" position:absolute; top:"+i+"px;' data-section-id='"+S(n)+"' data-section-index='"+e+"' class='dhx_matrix_line'>"},A._timeline_get_html_for_bar_data_row=function(e,t){var i=e.table_className;return t.template&&(i+=" "+(t.template(t.section,t.view)||"")),"<div class='dhx_timeline_data_row "+i+"' style='"+e.summ_width+" "+e.style_height+"' >"},A._timeline_get_html_for_bar_ignores=function(){return""},A._timeline_get_html_for_bar=function(e,t,i,n,a,o){var r=k(i._trace_x[e]),s=i.y_unit[t],l="";i.cell_template&&(l=A.templates[i.name+"_cell_value"](n,i._trace_x[e],s,o));var d="line-height:"+i._section_height[s.key]+"px;";return"MonthlyView"===A._mode&&(l=A.templates[i.name+"_cell_value"](i._trace_x[e],i.y_unit[t])||""),"<div class='dhx_matrix_cell dhx_timeline_data_cell "+A.templates[i.name+"_cell_class"](n,i._trace_x[e],s,o)+"' style='width:"+A._cols[e]+"px; "+(A.config.rtl?"right:":"left:")+a+"px;'  data-col-id='"+e+"' data-col-date='"+r+"' ><div style='width:auto; height:100%;position:relative;"+d+"'>"+l+"</div></div>"},A._timeline_render_scale_header=function(e,t){var i,n=A.$container.querySelector(".dhx_timeline_scale_header");n&&n.parentNode.removeChild(n),t&&(n=document.createElement("div"),i="dhx_timeline_scale_header",e.second_scale&&(i+=" dhx_timeline_second_scale"),t=A.xy.scale_height,n.className=i,n.style.cssText=["width:"+(e.dx-1)+"px","height:"+t+"px","line-height:"+t+"px","top:"+(A.xy.nav_height+2)+"px",A.config.rtl?"right:0":"left:0"].join(";"),n.innerHTML=A.locale.labels[e.name+"_scale_header"]||"",A.$container.appendChild(n))},A._timeline_y_scale=function(e){var t=A._timeline_get_block_stats(e,this),i=this.scrollable?" dhx_timeline_scrollable_data":"",n="<div class='dhx_timeline_table_wrapper'>",a="<div class='dhx_timeline_label_wrapper' style='"+t.style_label_wrapper+"'><div class='dhx_timeline_label_col'>",o="<div class='dhx_timeline_data_wrapper"+i+"' style='"+t.style_data_wrapper+"'><div class='dhx_timeline_data_col'>";A._load_mode&&A._load(),A._timeline_smart_render.clearPreparedEventsCache(void 0);var r=A._timeline_smart_render.getPreparedEvents(this);A._timeline_smart_render.cachePreparedEvents(r);for(var s=0,l=0;l<A._cols.length;l++)s+=A._cols[l];i=new Date,t=A._cols.length-A._ignores_detected,i=(A.date.add(i,this.x_step*t,this.x_unit)-i-(this._start_correction+this._end_correction)*t)/s;this._step=i,this._summ=s;var d=A._colsS.heights=[],_=[];this._events_height={},this._section_height={};var h=!(this._label_rows=[]),c=0,u=null;(this.scrollable||this.smart_rendering)&&(u=A._timeline_smart_render.getViewPort(this.scrollHelper,this._sch_height)),A._timeline_smart_render._rendered_labels_cache=[],A._timeline_smart_render._rendered_events_cache=[];for(var m=!!u,f=this.scrollable?!1!==this.smart_rendering&&!!m:!!this.smart_rendering&&m,p=[],g=0,v=0;v<this.y_unit.length;v++){A._timeline_calculate_event_positions.call(this,r[v]);var x=A._timeline_get_cur_row_stats(this,v);x=A._timeline_get_fit_events_stats(this,v,x),p.push(x),g+=x.height}u&&g<u.scrollTop&&(u.scrollTop=Math.max(0,g-u.height));for(v=0;v<this.y_unit.length;v++){var x=p[v],y=this.y_unit[v],b="<div class='dhx_timeline_label_row "+x.tr_className+"' style='top:"+c+"px;"+x.style_height+x.style_line_height+"'data-row-index='"+v+"' data-row-id='"+S(y.key)+"'><div class='"+x.td_className+"' style='"+x.style_width+" height:"+x.height+"px;' "+A._waiAria.label(x.td_content)+">"+x.td_content+"</div></div>";if(f&&this._label_rows.push({div:b,top:c,section:y}),f&&(A._timeline_smart_render.isInYViewPort({top:c,bottom:c+x.height},u)||(h=!0)),c+=x.height,h)h=!1;else{a+=b,f&&A._timeline_smart_render._rendered_labels_cache.push(v);var w={view:this,section:y,template:A.templates[this.name+"_row_class"]},D=0;if("cell"==this.render){o+=A._timeline_get_html_for_cell_data_row(v,x,c-x.height,y.key,w);for(var P=0;P<A._cols.length;P++)A._ignores[P]&&!f?o+=A._timeline_get_html_for_cell_ignores(x):f&&m&&!A._timeline_smart_render.isInXViewPort({left:D,right:D+A._cols[P]},u)||(o+=A._timeline_get_html_for_cell(P,v,this,r[v][P],x,D)),D+=A._cols[P];o+="</div>"}else{o+=A._timeline_get_html_for_bar_matrix_line(v,x,c-x.height,y.key);b=r[v];f&&m&&(b=A._timeline_smart_render.getVisibleEventsForRow(this,u,r,v)),o+=A._timeline_get_events_html.call(this,b),o+=A._timeline_get_html_for_bar_data_row(x,w);for(P=0;P<A._cols.length;P++)A._ignores[P]?o+=A._timeline_get_html_for_bar_ignores():f&&m&&!A._timeline_smart_render.isInXViewPort({left:D,right:D+A._cols[P]},u)||(o+=A._timeline_get_html_for_bar(P,v,this,r[v],D)),D+=A._cols[P];o+="</div></div>"}}x.sectionKey=y.key,_.push(x)}n+=a+"</div></div>",n+=o+"</div></div>",n+="</div>",this._matrix=r,e.innerHTML=n,f&&(A.$container.querySelector(".dhx_timeline_data_col").style.height=c+"px"),A._populate_timeline_rendered(e),this._scales={};for(var l=0,E=_.length;l<E;l++){d.push(_[l].height);var k=_[l].sectionKey;A._timeline_finalize_section_add(this,k,e)}f&&A._timeline_smart_render&&(A._timeline_smart_render._rendered_events_cache=[]),(f||this.scrollable)&&function(m,f,p,g){f._is_ev_creating=!1;var v=O(m,f),x=A._els.dhx_cal_header[0];function e(e){var t;(e=e||window.event).shiftKey||(t=e.deltaY||e.detail||-e.wheelDelta,v.scrollTop+=t=t<0?-100:100,e.preventDefault&&e.preventDefault())}var n,y,r,t=m.querySelector(".dhx_timeline_label_wrapper");t&&(t.addEventListener?"onwheel"in document?t.addEventListener("wheel",e):"onmousewheel"in document&&t.addEventListener("mousewheel",e):t.attachEvent("onmousewheel",e),t.$eventsAttached||(t.$eventsAttached=!0,n={pageX:0,pageY:0},t.addEventListener("touchstart",function(e){var t=e;e.touches&&(t=e.touches[0]),n={pageX:t.pageX,pageY:t.pageY}}),t.addEventListener("touchmove",function(e){var t=e;e.touches&&(t=e.touches[0]);var i=n.pageY-t.pageY;n={pageX:t.pageX,pageY:t.pageY},i&&(v.scrollTop+=i),e&&e.preventDefault&&e.preventDefault()}))),v.onscroll=function(e){var t,i,n=O(m,f),a=n.scrollTop,o=f.scrollHelper.getScrollValue(n),r=A._timeline_smart_render.getViewPort(f.scrollHelper,0,o,a),s=N();if(f.scrollable&&(s.style.top=-a+"px"),!1!==f.smart_rendering){o===f._x_scroll&&!f._is_ev_creating||(f.second_scale?A._timeline_smart_render.updateHeader(f,r,x.children[1]):A._timeline_smart_render.updateHeader(f,r,x.children[0])),A.config.rtl?(t=+A.$container.querySelector(".dhx_timeline_label_wrapper").style.height.replace("px",""),i=f._section_height[f.y_unit.length]+f._label_rows[f._label_rows.length-1].top,f.scrollHelper.getMode()==f.scrollHelper.modes.minMax&&(t<i||"tree"==f.render)?x.style.right=-1-o-M()+"px":x.style.right=-1-o+"px",x.style.left="unset"):x.style.left=-1-o+"px",(f._options_changed||a!==f._y_scroll||f._is_ev_creating)&&A._timeline_smart_render.updateLabels(f,r,s),f._is_ev_creating=!1,A._timeline_smart_render.updateGridCols(f,r),A._timeline_smart_render.updateGridRows(f,r);o=!1;"cell"!=f.render&&(window.requestAnimationFrame?(o=!0,y&&cancelAnimationFrame(y),y=requestAnimationFrame(function(){f.name===A.getState().mode&&(A._timeline_smart_render.updateEvents(f,r),y=0,f.callEvent("onScroll",[f.scrollHelper.getScrollValue(v),v.scrollTop]))})):A._timeline_smart_render.updateEvents(f,r));var l=0;f._scales={};for(var d,_=0,h=(d="cell"===f.render?n.querySelectorAll(".dhx_timeline_data_col .dhx_timeline_data_row"):n.querySelectorAll(".dhx_timeline_data_col .dhx_matrix_line")).length;_<h;_++){var c=d[_].getAttribute("data-section-id"),u=f.order[c];p[u]=g[u].height,f._scales[c]=d[_]}for(_=0,h=p.length;_<h;_++)l+=p[_];A.$container.querySelector(".dhx_timeline_data_col").style.height=l+"px";a=n.scrollTop,s=f.scrollHelper.getScrollValue(n),n=f._summ-A.$container.querySelector(".dhx_cal_data").offsetWidth+f.dx+f.custom_scroll_width;A._timeline_save_scroll_pos(f,a,s,n),o||f.callEvent("onScroll",[s,a]),f._is_new_view=!1}},v.$eventsAttached||(v.$eventsAttached=!0,r={pageX:0,pageY:0},v.addEventListener("touchstart",function(e){var t=e;e.touches&&(t=e.touches[0]),r={pageX:t.pageX,pageY:t.pageY}}),v.addEventListener("touchmove",function(e){var t=e;e.touches&&(t=e.touches[0]);var i,n=N(),a=r.pageX-t.pageX,o=r.pageY-t.pageY;return r={pageX:t.pageX,pageY:t.pageY},!a&&!o||A.getState().drag_id||(i=Math.abs(a),t=Math.abs(o),i/(i=Math.sqrt(a*a+o*o))<.42?a=0:t/i<.42&&(o=0),f.scrollHelper.setScrollValue(v,f.scrollHelper.getScrollValue(v)+a),v.scrollTop+=o,f.scrollable&&o&&(n.style.top=-v.scrollTop+"px")),e&&e.preventDefault&&e.preventDefault(),!1})),f.scroll_position&&f._is_new_view?f.scrollTo(f.scroll_position):A._timeline_set_scroll_pos(m,f),f._is_ev_creating=!0}(e,this,d,_)},A._timeline_finalize_section_add=function(e,t,i){i=e._scales[t]=i.querySelector(".dhx_timeline_data_col [data-section-id='"+String(t).replace(/'/g,"\\'").replace(/"/g,'\\"')+"']");i&&A.callEvent("onScaleAdd",[i,t])},A.attachEvent("onBeforeViewChange",function(e,t,i,n){if(A.matrix[i]){var a=A.matrix[i];if(a.scrollable){if("tree"==a.render&&e===i&&t===n)return!0;a._x_scroll=a._y_scroll=0,A.$container.querySelector(".dhx_timeline_scrollable_data")&&A._timeline_set_scroll_pos(A._els.dhx_cal_data[0],a)}}return!0}),A._timeline_x_dates=function(e){var t=A._min_date,i=A._max_date;A._process_ignores(t,this.x_size,this.x_unit,this.x_step,e);this.x_size,e&&A._ignores_detected;for(var n=0,a=0;+t<+i;)if(this._trace_x[a]=new Date(t),"month"==this.x_unit&&A.date[this.x_unit+"_start"]&&(t=A.date[this.x_unit+"_start"](new Date(t))),t=A.date.add(t,this.x_step,this.x_unit),A.date[this.x_unit+"_start"]&&(t=A.date[this.x_unit+"_start"](t)),A._ignores[a]||n++,a++,e)if(n<this.x_size&&!(+t<+i))i=A.date["add_"+this.name+"_private"](i,(this.x_length||this.x_size)*this.x_step);else if(n>=this.x_size){A._max_date=t;break}return{total:a,displayed:n}},A._timeline_x_scale=function(e){var t=A.xy.scale_height,i=this._header_resized||A.xy.scale_height;A._cols=[],A._colsS={height:0},this._trace_x=[];var n=A.config.preserve_scale_length,a=A._timeline_x_dates.call(this,n),o=A._x-this.dx-A.xy.scroll_width;this.scrollable&&0<this.column_width&&(o<(n=this.column_width*a.displayed)&&(o=n,this._section_autowidth=!1));var r=[this.dx];A._els.dhx_cal_header[0].style.width=r[0]+o+"px";A._min_date_timeline=A._min_date;for(var s,l=a.displayed,d=a.total,_=0;_<d;_++)A._ignores[_]?(A._cols[_]=0,l++):A._cols[_]=Math.floor(o/(l-_)),o-=A._cols[_],r[_+1]=r[_]+A._cols[_];if(e.innerHTML="<div></div>",this.second_scale){for(var h=this.second_scale.x_unit,c=[this._trace_x[0]],u=[],m=[this.dx,this.dx],f=0,p=0;p<this._trace_x.length;p++){var g=this._trace_x[p];A._timeline_is_new_interval(h,g,c[f])&&(c[++f]=g,m[f+1]=m[f]);g=f+1;u[f]=A._cols[p]+(u[f]||0),m[g]+=A._cols[p]}e.innerHTML="<div></div><div></div>";var v=e.firstChild;v.style.height=i+"px";a=e.lastChild;a.style.position="relative",a.className="dhx_bottom_scale_container";for(var x=0;x<c.length;x++){var y=c[x],b=A.templates[this.name+"_second_scalex_class"](y),w=document.createElement("div");w.className="dhx_scale_bar dhx_second_scale_bar"+(b?" "+b:""),A.set_xy(w,u[x]-1,i-3,m[x],0),w.innerHTML=A.templates[this.name+"_second_scale_date"](y),v.appendChild(w)}}A.xy.scale_height=i,e=e.lastChild,this._h_cols={};for(var D,P=0;P<this._trace_x.length;P++)A._ignores[P]||(s=this._trace_x[P],A._render_x_header(P,r[P],s,e),(D=A.templates[this.name+"_scalex_class"](s))&&(e.lastChild.className+=" "+D),e.lastChild.setAttribute("data-col-id",P),e.lastChild.setAttribute("data-col-date",k(s)),D=e.lastChild.cloneNode(!0),this._h_cols[P]={div:D,left:r[P]});A.xy.scale_height=t;var E=this._trace_x;e.onclick=function(e){var t=A._timeline_locate_hcell(e);t&&A.callEvent("onXScaleClick",[t.x,E[t.x],e||event])},e.ondblclick=function(e){var t=A._timeline_locate_hcell(e);t&&A.callEvent("onXScaleDblClick",[t.x,E[t.x],e||event])}},A._timeline_is_new_interval=function(e,t,i){switch(e){case"hour":return t.getHours()!=i.getHours()||A._timeline_is_new_interval("day",t,i);case"day":return!(t.getDate()==i.getDate()&&t.getMonth()==i.getMonth()&&t.getFullYear()==i.getFullYear());case"week":return!(A.date.week_start(new Date(t)).valueOf()==A.date.week_start(new Date(i)).valueOf());case"month":return!(t.getMonth()==i.getMonth()&&t.getFullYear()==i.getFullYear());case"year":return!(t.getFullYear()==i.getFullYear());default:return!1}},A._timeline_reset_scale_height=function(e){!this._header_resized||e&&this.second_scale||(A.xy.scale_height/=2,this._header_resized=!1,(e=A._els.dhx_cal_header[0]).className=e.className.replace(/ dhx_second_cal_header/gi,""))},A._timeline_set_full_view=function(e){var t,i;A._timeline_reset_scale_height.call(this,e),e&&(this.second_scale&&!this._header_resized&&(this._header_resized=A.xy.scale_height,A.xy.scale_height*=2,A._els.dhx_cal_header[0].className+=" dhx_second_cal_header"),A.set_sizes(),A._init_matrix_tooltip(),i=A._min_date,A._timeline_x_scale.call(this,A._els.dhx_cal_header[0]),A.$container.querySelector(".dhx_timeline_scrollable_data")&&(t=A._timeline_smart_render.getViewPort(this.scrollHelper),(t=A._timeline_smart_render.getVisibleHeader(this,t))&&(this.second_scale?A._els.dhx_cal_header[0].children[1].innerHTML=t:A._els.dhx_cal_header[0].children[0].innerHTML=t)),A._timeline_y_scale.call(this,A._els.dhx_cal_data[0]),A._min_date=i,(i=A._getNavDateElement())&&(i.innerHTML=A.templates[this.name+"_date"](A._min_date,A._max_date)),A._mark_now&&A._mark_now(),A._timeline_reset_scale_height.call(this,e)),A._timeline_render_scale_header(this,e),A._timeline_hideToolTip()},A._timeline_hideToolTip=function(){A._tooltip&&(A._tooltip.style.display="none",A._tooltip.date="")},A._timeline_showToolTip=function(e,t,i){if("cell"==e.render){var n=t.x+"_"+t.y,a=e._matrix[t.y][t.x];if(!a)return A._timeline_hideToolTip();if(a.sort(function(e,t){return e.start_date>t.start_date?1:-1}),A._tooltip){if(A._tooltip.date==n)return;A._tooltip.innerHTML=""}else{var o=A._tooltip=document.createElement("div");o.className="dhx_year_tooltip",A.config.rtl&&(o.className+=" dhx_tooltip_rtl"),document.body.appendChild(o),o.onclick=A._click.dhx_cal_data}for(var r="",s=0;s<a.length;s++){var l=a[s].color?"background-color:"+a[s].color+";":"",d=a[s].textColor?"color:"+a[s].textColor+";":"";r+="<div class='dhx_tooltip_line' event_id='"+a[s].id+"' style='"+l+d+"'>",r+="<div class='dhx_tooltip_date'>"+(a[s]._timed?A.templates.event_date(a[s].start_date):"")+"</div>",r+="<div class='dhx_event_icon icon_details'>&nbsp;</div>",r+=A.templates[e.name+"_tooltip"](a[s].start_date,a[s].end_date,a[s])+"</div>"}A._tooltip.style.display="",A._tooltip.style.top="0px",A.config.rtl&&0<=i.left-A._tooltip.offsetWidth||document.body.offsetWidth-t.src.offsetWidth-i.left-A._tooltip.offsetWidth<0?A._tooltip.style.left=i.left-A._tooltip.offsetWidth+"px":A._tooltip.style.left=i.left+t.src.offsetWidth+"px",A._tooltip.date=n,A._tooltip.innerHTML=r,document.body.offsetHeight-i.top-A._tooltip.offsetHeight<0?A._tooltip.style.top=i.top-A._tooltip.offsetHeight+t.src.offsetHeight+"px":A._tooltip.style.top=i.top+"px"}},A._matrix_tooltip_handler=function(e){var t=A.matrix[A._mode];if(t&&"cell"==t.render){if(t){var i=A._locate_cell_timeline(e);(e=e||event).target||e.srcElement;if(i)return A._timeline_showToolTip(t,i,A.$domHelpers.getOffset(i.src))}A._timeline_hideToolTip()}},A._init_matrix_tooltip=function(){A._detachDomEvent(A._els.dhx_cal_data[0],"mouseover",A._matrix_tooltip_handler),A.event(A._els.dhx_cal_data[0],"mouseover",A._matrix_tooltip_handler)},A._set_timeline_dates=function(e){A._min_date=A.date[e.name+"_start"](new Date(A._date)),A._max_date=A.date["add_"+e.name+"_private"](A._min_date,e.x_size*e.x_step),A.date[e.x_unit+"_start"]&&(A._max_date=A.date[e.x_unit+"_start"](A._max_date)),A._table_view=!0},A._renderMatrix=function(e,t){t||(A._els.dhx_cal_data[0].scrollTop=0),A._set_timeline_dates(this),A._timeline_set_full_view.call(this,e)},A._timeline_html_index=function(e){for(var t=e.parentNode.childNodes,i=-1,n=0;n<t.length;n++)if(t[n]==e){i=n;break}var a=i;if(A._ignores_detected)for(var o in A._ignores)A._ignores[o]&&+o<=a&&a++;return a},A._timeline_locate_hcell=function(e){for(var t=(e=e||event).target||e.srcElement;t&&"DIV"!=t.tagName;)t=t.parentNode;if(t&&"DIV"==t.tagName&&"dhx_scale_bar"==A._getClassName(t).split(" ")[0])return{x:A._timeline_html_index(t),y:-1,src:t,scale:!0}},A._locate_cell_timeline=function(e){for(var t=(e=e||event).target||e.srcElement,i={},n=A.matrix[A._mode],a=A.getActionData(e),o=A._ignores,r=0,s=0;s<n._trace_x.length-1&&!(+a.date<n._trace_x[s+1]);s++)o[s]||r++;i.x=0===r?0:s,i.y=n.order[a.section];A._isRender("cell");e=0;if(n.scrollable&&"cell"===n.render){if(!n._scales[a.section]||!n._scales[a.section].querySelector(".dhx_matrix_cell"))return;var l=n._scales[a.section].querySelector(".dhx_matrix_cell");if(!l)return;l=l.offsetLeft;if(0<l){for(var d=A._timeline_drag_date(n,l),_=0;_<n._trace_x.length-1&&!(+d<n._trace_x[_+1]);_++);e=_}}i.src=n._scales[a.section]?n._scales[a.section].querySelectorAll(".dhx_matrix_cell")[s-e]:null;l=!1,e=function(e,t){if(e.closest)return e.closest(t);if(e.matches||e.msMatchesSelector||e.webkitMatchesSelector){var i=e;if(!document.documentElement.contains(i))return null;do{if((i.matches||i.msMatchesSelector||i.webkitMatchesSelector).call(i,t))return i}while(null!==(i=i.parentElement||i.parentNode)&&1===i.nodeType);return null}return window.console.error("Your browser is not supported"),null}(t,".dhx_matrix_scell");return e&&(t=e,l=!0),l?(i.x=-1,i.src=t,i.scale=!0):i.x=s,i};var a=A._click.dhx_cal_data;A._click.dhx_marked_timespan=A._click.dhx_cal_data=function(e){var t,i=a.apply(this,arguments),n=A.matrix[A._mode];return!n||(t=A._locate_cell_timeline(e))&&(t.scale?A.callEvent("onYScaleClick",[t.y,n.y_unit[t.y],e||event]):(A.callEvent("onCellClick",[t.x,t.y,n._trace_x[t.x],(n._matrix[t.y]||{})[t.x]||[],e||event]),A._timeline_set_scroll_pos(A._els.dhx_cal_data[0],n))),i},A.dblclick_dhx_matrix_cell=function(e){var t,i=A.matrix[A._mode];!i||(t=A._locate_cell_timeline(e))&&(t.scale?A.callEvent("onYScaleDblClick",[t.y,i.y_unit[t.y],e||event]):A.callEvent("onCellDblClick",[t.x,t.y,i._trace_x[t.x],(i._matrix[t.y]||{})[t.x]||[],e||event]))};var i=A.dblclick_dhx_marked_timespan||function(){};A.dblclick_dhx_marked_timespan=function(e){return A.matrix[A._mode]?A.dblclick_dhx_matrix_cell(e):i.apply(this,arguments)},A.dblclick_dhx_matrix_scell=function(e){return A.dblclick_dhx_matrix_cell(e)},A._isRender=function(e){return A.matrix[A._mode]&&A.matrix[A._mode].render==e},A.attachEvent("onCellDblClick",function(e,t,i,n,a){var o,r;this.config.readonly||"dblclick"==a.type&&!this.config.dblclick_create||(o=A.matrix[A._mode],(r={}).start_date=o._trace_x[e],r.end_date=o._trace_x[e+1]||A.date.add(o._trace_x[e],o.x_step,o.x_unit),o._start_correction&&(r.start_date=new Date(+r.start_date+o._start_correction)),o._end_correction&&(r.end_date=new Date(r.end_date-o._end_correction)),r[o.y_property]=o.y_unit[t].key,A.addEventNow(r,null,a))}),A.attachEvent("onBeforeDrag",function(e,t,i){return!A._isRender("cell")}),A.attachEvent("onEventChanged",function(e,t){t._timed=this.isOneDayEvent(t)}),A.attachEvent("onBeforeEventChanged",function(e,t,i,n){return e&&(e._move_delta=void 0),n&&(n._move_delta=void 0),!0}),A._is_column_visible=function(e){var t=A.matrix[A._mode],e=A._get_date_index(t,e);return!A._ignores[e]};var D=A._render_marked_timespan;A._render_marked_timespan=function(e,t,i,n,a){if(!A.config.display_marked_timespans)return[];if(!A.matrix||!A.matrix[A._mode])return D.apply(A,[e,t,i]);if(!A._isRender("cell")){var o=A._lame_copy({},A.matrix[A._mode]);o.round_position=!1;var r=[],s=[],l=[],d=e.sections?e.sections.units||e.sections.timeline:null;if(i)l=[t],s=[i];else{var _=o.order;if(d)_.hasOwnProperty(d)&&(s.push(d),l.push(o._scales[d]));else if(o._scales)for(var h in _)_.hasOwnProperty(h)&&o._scales[h]&&(s.push(h),l.push(o._scales[h]))}n=n?new Date(n):A._min_date,a=a?new Date(a):A._max_date;if(n.valueOf()<A._min_date.valueOf()&&(n=new Date(A._min_date)),a.valueOf()>A._max_date.valueOf()&&(a=new Date(A._max_date)),o._trace_x){for(var c=0;c<o._trace_x.length&&!A._is_column_visible(o._trace_x[c]);c++);if(c!=o._trace_x.length){var u=[];6<e.days?(d=new Date(e.days),A.date.date_part(new Date(n))<=+d&&+d<=+a&&u.push(d)):u.push.apply(u,A._get_dates_by_index(e.days));for(var m=e.zones,f=A._get_css_classes_by_config(e),p=0;p<s.length;p++){t=l[p],i=s[p];for(c=0;c<u.length;c++)for(var g=u[c],v=0;v<m.length;v+=2){var x=m[v],y=m[v+1],b=new Date(+g+60*x*1e3),w=new Date(+g+60*y*1e3),b=new Date(b.valueOf()+1e3*(b.getTimezoneOffset()-g.getTimezoneOffset())*60);n<(w=new Date(w.valueOf()+1e3*(w.getTimezoneOffset()-g.getTimezoneOffset())*60))&&b<a&&((x=A._get_block_by_config(e)).className=f,y=A._timeline_getX({start_date:b},!1,o)-1,b=A._timeline_getX({start_date:w},!1,o)-1,w=Math.max(1,b-y-1),b=o._section_height[i]-1||o.dy-1,x.style.cssText="height: "+b+"px; "+(A.config.rtl?"right: ":"left: ")+y+"px; width: "+w+"px; top: 0;",t.insertBefore(x,t.firstChild),r.push(x))}}return r}}}};var o=A._append_mark_now;A._append_mark_now=function(e,t){if(A.matrix&&A.matrix[A._mode]){var i=A._currentDate(),n=A._get_zone_minutes(i),n={days:+A.date.date_part(i),zones:[n,n+1],css:"dhx_matrix_now_time",type:"dhx_now_time"};return A._render_marked_timespan(n)}return o.apply(A,[e,t])};var r=A._mark_timespans;A._mark_timespans=function(){if(A.matrix&&A.matrix[A.getState().mode]){for(var e=[],t=A.matrix[A.getState().mode],i=t.y_unit,n=0;n<i.length;n++){var a=i[n].key,o=t._scales[a],a=A._on_scale_add_marker(o,a);e.push.apply(e,a)}return e}return r.apply(this,arguments)};var p=A._on_scale_add_marker;A._on_scale_add_marker=function(e,t){if(A.matrix&&A.matrix[A._mode]){var i=[],n=A._marked_timespans;if(n&&A.matrix&&A.matrix[A._mode])for(var a=A._mode,o=A._min_date,r=A._max_date,s=n.global,l=A.date.date_part(new Date(o));l<r;l=A.date.add(l,1,"day")){var d,_=+l,h=l.getDay(),c=[],u=s[_]||s[h];c.push.apply(c,A._get_configs_to_render(u)),n[a]&&n[a][t]&&(d=[],u=A._get_types_to_render(n[a][t][h],n[a][t][_]),d.push.apply(d,A._get_configs_to_render(u)),d.length&&(c=d));for(var m=0;m<c.length;m++){var f=c[m];f.days<7?(i.push.apply(i,A._render_marked_timespan(f,e,t,l,A.date.add(l,1,"day"))),0):i.push.apply(i,A._render_marked_timespan(f,e,t,l,A.date.add(l,1,"day")))}}return i}return p.apply(this,arguments)},A._resolve_timeline_section=function(e,t){for(var i=0,n=0;i<this._colsS.heights.length&&!((n+=this._colsS.heights[i])>t.y);i++);e.y_unit[i]||(i=e.y_unit.length-1),this._drag_event&&!this._drag_event._orig_section&&(this._drag_event._orig_section=e.y_unit[i].key),t.fields={},0<=i&&e.y_unit[i]&&(t.section=t.fields[e.y_property]=e.y_unit[i].key)},A._update_timeline_section=function(e){var t=e.view,i=e.event,n=e.pos;i&&(i[t.y_property]!=n.section&&(e=this._get_timeline_event_height(i,t),i._sorder=this._get_dnd_order(i._sorder,e,t._section_height[n.section])),i[t.y_property]=n.section)},A._get_date_index=function(e,t){for(var i=e._trace_x,n=0,a=i.length-1,o=t.valueOf();3<a-n;){var r=n+Math.floor((a-n)/2);i[r].valueOf()>o?a=r:n=r}for(var s=n;s<=a&&+t>=+i[s+1];)s++;return s},A._timeline_drag_date=function(e,t){var e=e,i=t;if(!e._trace_x.length)return new Date(A.getState().date);for(var n,a,o,r,s=0,l=0;l<=this._cols.length-1;l++)if(i<(s+=a=this._cols[l])){n=(n=(i-(s-a))/a)<0?0:n;break}if(e.round_position&&(o=1,(o=(t=A.getState().drag_mode)&&"move"!=t&&"create"!=t?.5:o)<=n&&l++,n=0),0===l&&this._ignores[0])for(l=1,n=0;this._ignores[l];)l++;else if(l==this._cols.length&&this._ignores[l-1]){for(l=this._cols.length-1,n=0;this._ignores[l];)l--;l++}return l>=e._trace_x.length?(r=A.date.add(e._trace_x[e._trace_x.length-1],e.x_step,e.x_unit),e._end_correction&&(r=new Date(r-e._end_correction))):(o=n*a*e._step+e._start_correction,r=new Date(+e._trace_x[l]+o)),r},A.attachEvent("onBeforeTodayDisplayed",function(){for(var e in A.matrix){e=A.matrix[e];e.x_start=e._original_x_start}return!0}),A.attachEvent("onOptionsLoad",function(){for(var e in A.matrix){var t=A.matrix[e];t.order={},A.callEvent("onOptionsLoadStart",[]);for(e=0;e<t.y_unit.length;e++)t.order[t.y_unit[e].key]=e;A.callEvent("onOptionsLoadFinal",[]),A._date&&t.name==A._mode&&(t._options_changed=!0,A.setCurrentView(A._date,A._mode),setTimeout(function(){t._options_changed=!1}))}}),A.attachEvent("onEventIdChange",function(){var e=A.getView();e&&A.matrix[e.name]&&A._timeline_smart_render&&(A._timeline_smart_render.clearPreparedEventsCache(),A._timeline_smart_render.getPreparedEvents(e))}),A.attachEvent("onBeforeDrag",function(e,t,i){return"resize"==t&&(i=i.target||i.srcElement,A._getClassName(i).indexOf("dhx_event_resize_end")<0?A._drag_from_start=!0:A._drag_from_start=!1),!0});var s=null,l=null;function e(e){s&&clearInterval(s),A._schedulerOuter=A.$container.querySelector(".dhx_timeline_data_wrapper");var r={pageX:(e.touches?e.touches[0]:e).pageX,pageY:(e.touches?e.touches[0]:e).pageY};s=setInterval(function(){var e,t,i,n,a,o;e=r,A.getState().drag_id?(t=A.matrix[A._mode])&&(i=A._schedulerOuter,n=function(e,t){var i=A.matrix[A._mode],n={},a={},o=t;for(n.x=(e.touches?e.touches[0]:e).pageX,n.y=(e.touches?e.touches[0]:e).pageY,a.left=o.offsetLeft+i.dx,a.top=o.offsetTop;o;)a.left+=o.offsetLeft,a.top+=o.offsetTop,o=o.offsetParent;return{x:n.x-a.left,y:n.y-a.top}}(e,i),a=i.offsetWidth-t.dx,o=i.offsetHeight,e=n.x,i=n.y,n=t.autoscroll||{},A._merge(n,{range_x:200,range_y:100,speed_x:20,speed_y:10}),a=d(e,a,l?l.x:0,n.range_x),t.scrollable||(a=0),!(o=d(i,o,l?l.y:0,n.range_y))&&!a||l||(l={x:e,y:i},o=a=0),a*=n.speed_x,o*=n.speed_y,a&&o&&(Math.abs(a/5)>Math.abs(o)?o=0:Math.abs(o/5)>Math.abs(a)&&(a=0)),a||o?(l.started=!0,function(e,t){var i=A._schedulerOuter;t&&(i.scrollTop+=t);e&&(i.scrollLeft+=e)}(a,o)):clearInterval(s)):(clearInterval(s),l=null)},10)}function d(e,t,i,n){return e<n&&(!l||l.started||e<i)?-1:t-e<n&&(!l||l.started||i<e)?1:0}var n=A.attachEvent("onSchedulerReady",function(){A.matrix&&(A.event(document.body,"mousemove",e),A.detachEvent(n))});A._timeline_smart_render={_prepared_events_cache:null,_rendered_events_cache:[],_rendered_header_cache:[],_rendered_labels_cache:[],_rows_to_delete:[],_rows_to_add:[],_cols_to_delete:[],_cols_to_add:[],getViewPort:function(e,t,i,n){var a=A.$container.querySelector(".dhx_cal_data"),o=a.getBoundingClientRect(),r=A.$container.querySelector(".dhx_timeline_scrollable_data");r&&void 0===i&&(i=e.getScrollValue(r)),void 0===n&&(n=(r||a).scrollTop);var s,l={};for(s in o)l[s]=o[s];return l.scrollLeft=i||0,l.scrollTop=n||0,t&&(o.height=t),l},isInXViewPort:function(e,t){var i=t.scrollLeft,t=t.width+t.scrollLeft;return e.left<t+100&&e.right>i-100},isInYViewPort:function(e,t){var i=t.scrollTop,t=t.height+t.scrollTop;return e.top<t+100&&e.bottom>i-100},getVisibleHeader:function(e,t){var i,n="";for(i in this._rendered_header_cache=[],e._h_cols){var a=e._h_cols[i];this.isInXViewPort({left:a.left,right:a.left+A._cols[i]},t)&&(n+=a.div.outerHTML,this._rendered_header_cache.push(a.div.getAttribute("data-col-id")))}return n},updateHeader:function(e,t,i){this._cols_to_delete=[],this._cols_to_add=[];for(var n=A.$container.querySelectorAll(".dhx_cal_header > div"),a=n[n.length-1].querySelectorAll(".dhx_scale_bar"),o=[],r=0;r<a.length;r++)o.push(a[r].getAttribute("data-col-id"));if(this.getVisibleHeader(e,t)){for(var s=this._rendered_header_cache.slice(),l=[],r=0,d=o.length;r<d;r++){var _=s.indexOf(o[r]);-1<_?s.splice(_,1):l.push(o[r])}l.length&&(this._cols_to_delete=l.slice(),this._deleteHeaderCells(l,e,i)),s.length&&(this._cols_to_add=s.slice(),this._addHeaderCells(s,e,i))}},_deleteHeaderCells:function(e,t,i){for(var n=0;n<e.length;n++){var a=i.querySelector('[data-col-id="'+e[n]+'"]');a&&i.removeChild(a)}},_addHeaderCells:function(e,t,i){for(var n="",a=0;a<e.length;a++)n+=t._h_cols[e[a]].div.outerHTML;i.insertAdjacentHTML("beforeEnd",n)},getVisibleLabels:function(e,t){if(e._label_rows.length){var i="";this._rendered_labels_cache=[];for(var n=0;n<e._label_rows.length;n++)this.isInYViewPort({top:e._label_rows[n].top,bottom:e._label_rows[n].top+e._section_height[e.y_unit[n].key]},t)&&(i+=e._label_rows[n].div,this._rendered_labels_cache.push(n));return i}},updateLabels:function(e,t,i){this._rows_to_delete=[],this._rows_to_add=[];var n=this._rendered_labels_cache.slice();if(n.length||(this.getVisibleLabels(e,t),n=this._rendered_labels_cache.slice()),this.getVisibleLabels(e,t)){for(var a=this._rendered_labels_cache.slice(),o=[],r=0,s=n.length;r<s;r++){var l=a.indexOf(n[r]);-1<l?a.splice(l,1):o.push(n[r])}o.length&&(this._rows_to_delete=o.slice(),this._deleteLabelCells(o,e,i)),a.length&&(this._rows_to_add=a.slice(),this._addLabelCells(a,e,i))}},_deleteLabelCells:function(e,t,i){for(var n=0;n<e.length;n++){var a=i.querySelector('[data-row-index="'+e[n]+'"]');a&&i.removeChild(a)}},_addLabelCells:function(e,t,i){for(var n="",a=0;a<e.length;a++)n+=t._label_rows[e[a]].div;i.insertAdjacentHTML("beforeEnd",n)},clearPreparedEventsCache:function(){this.cachePreparedEvents(null)},cachePreparedEvents:function(e){this._prepared_events_cache=e,this._prepared_events_coordinate_cache=e},getPreparedEvents:function(e){var t;return this._prepared_events_cache?t=this._prepared_events_cache:((t=A._prepare_timeline_events(e)).$coordinates={},this.cachePreparedEvents(t)),t},updateEvents:function(e,t){var i=this.getPreparedEvents(e),n=this._rendered_events_cache.slice();this._rendered_events_cache=[];var a=A.$container.querySelector(".dhx_cal_data .dhx_timeline_data_col");if(a){for(var o=0;o<this._rendered_labels_cache.length;o++){var r=this._rendered_labels_cache[o],s=[],l=n[r]?n[r].slice():[];A._timeline_calculate_event_positions.call(e,i[r]);for(var d=A._timeline_smart_render.getVisibleEventsForRow(e,t,i,r),_=0,h=d.length;_<h;_++){var c=l.indexOf(d[_].id);-1<c?l.splice(c,1):s.push(d[_])}var u=a.querySelector('[data-section-index="'+r+'"]');l.length&&this._deleteEvents(l,e,u),s.length&&this._addEvents(s,e,u,r)}A._populate_timeline_rendered(A.$container),e._matrix=i}},_deleteEvents:function(e,t,i){for(var n=0;n<e.length;n++){var a=i.querySelector('[event_id="'+e[n]+'"]');a&&(a.classList.contains("dhx_in_move")||i.removeChild(a))}},_addEvents:function(e,t,i,n){e=A._timeline_update_events_html.call(t,e);i.insertAdjacentHTML("beforeEnd",e)},getVisibleEventsForRow:function(e,t,i,n){var a=[];if("cell"==e.render)a=i;else{var o=i[n];if(o)for(var r=0,s=o.length;r<s;r++){var l,d,_=o[r],h=n+"_"+_.id;i.$coordinates&&i.$coordinates[h]?(l=i.$coordinates[h].xStart,d=i.$coordinates[h].xEnd):(l=A._timeline_getX(_,!1,e),d=A._timeline_getX(_,!0,e),i.$coordinates&&(i.$coordinates[h]={xStart:l,xEnd:d})),A._timeline_smart_render.isInXViewPort({left:l,right:d},t)&&(a.push(_),this._rendered_events_cache[n]||(this._rendered_events_cache[n]=[]),this._rendered_events_cache[n].push(_.id))}}return a},getVisibleRowCellsHTML:function(e,t,i,n,a){for(var o="",r=this._rendered_header_cache,s=0;s<r.length;s++){var l=r[s],d=e._h_cols[l].left-e.dx;A._ignores[l]?"cell"==e.render?o+=A._timeline_get_html_for_cell_ignores(i):o+=A._timeline_get_html_for_bar_ignores():"cell"==e.render?o+=A._timeline_get_html_for_cell(l,a,e,n[a][l],i,d):o+=A._timeline_get_html_for_bar(l,a,e,n[a],d)}return o},getVisibleTimelineRowsHTML:function(e,t,i,n){var a="",o=A._timeline_get_cur_row_stats(e,n),o=A._timeline_get_fit_events_stats(e,n,o),r=e._label_rows[n],s=A.templates[e.name+"_row_class"],s={view:e,section:r.section,template:s};return"cell"==e.render?(a+=A._timeline_get_html_for_cell_data_row(n,o,r.top,r.section.key,s),a+=this.getVisibleRowCellsHTML(e,t,o,i,n),a+="</div>"):(a+=A._timeline_get_html_for_bar_matrix_line(n,o,r.top,r.section.key,s),a+=A._timeline_get_html_for_bar_data_row(o,s),a+=this.getVisibleRowCellsHTML(e,t,o,i,n),a+="</div></div>"),a},updateGridRows:function(e,t){this._rows_to_delete.length&&this._deleteGridRows(this._rows_to_delete),this._rows_to_add.length&&this._addGridRows(this._rows_to_add,e,t)},_deleteGridRows:function(e){var t=A.$container.querySelector(".dhx_cal_data .dhx_timeline_data_col");if(t){for(var i=0;i<e.length;i++){var n=t.querySelector('[data-section-index="'+e[i]+'"]');t.removeChild(n)}this._rows_to_delete=[]}},_addGridRows:function(e,t,i){var n=A.$container.querySelector(".dhx_cal_data .dhx_timeline_data_col");if(n){for(var a=this.getPreparedEvents(t),o="",r=0;r<e.length;r++)o+=this.getVisibleTimelineRowsHTML(t,i,a,e[r]);n.insertAdjacentHTML("beforeEnd",o);for(r=0;r<e.length;r++)A._timeline_finalize_section_add(t,t.y_unit[e[r]].key,n);A._mark_now&&A._mark_now(),this._rows_to_add=[]}},updateGridCols:function(e,t){for(var i=this._rendered_header_cache,n={},a={},o=0;o<i.length;o++)a[i[o]]=!0;var r=A.$container.querySelector(".dhx_timeline_data_row");if(r)for(var s=r.querySelectorAll("[data-col-id]"),o=0;o<s.length;o++)n[s[o].getAttribute("data-col-id")]=!0;var l=[],d=[];for(o in n)a[o]||l.push(o);for(o in a)n[o]||d.push(o);l.length&&this._deleteGridCols(l,e),d.length&&this._addGridCols(d,e,t)},_deleteGridCols:function(e,t){var i=A.$container.querySelector(".dhx_cal_data .dhx_timeline_data_col");if(i){for(var n=0;n<this._rendered_labels_cache.length;n++){var a="cell"==t.render?i.querySelector('[data-section-index="'+this._rendered_labels_cache[n]+'"]'):i.querySelector('[data-section-index="'+this._rendered_labels_cache[n]+'"] .dhx_timeline_data_row ');if(a)for(var o=0;o<e.length;o++){var r=a.querySelector('[data-col-id="'+e[o]+'"]');r&&a.removeChild(r)}}this._cols_to_delete=[]}},_addGridCols:function(e,t,i){var n=A.$container.querySelector(".dhx_cal_data .dhx_timeline_data_col");if(n){for(var a=this.getPreparedEvents(t),o=0;o<this._rendered_labels_cache.length;o++){var r=this._rendered_labels_cache[o],s="",l=A._timeline_get_cur_row_stats(t,r),l=A._timeline_get_fit_events_stats(t,r,l),d="cell"==t.render?n.querySelector('[data-section-index="'+r+'"]'):n.querySelector('[data-section-index="'+r+'"] .dhx_timeline_data_row');if(d){for(var _,h=0;h<e.length;h++)d.querySelector('[data-col-id="'+e[h]+'"]')||(_=this.getVisibleGridCell(t,i,l,a,r,e[h]))&&(s+=_);d.insertAdjacentHTML("beforeEnd",s)}}this._cols_to_add=[]}},getVisibleGridCell:function(e,t,i,n,a,o){if(e._h_cols[o]){var r="",s=e._h_cols[o].left-e.dx;return"cell"==e.render?A._ignores[o]||(r+=A._timeline_get_html_for_cell(o,a,e,n[a][o],i,s)):A._ignores[o]||(r+=A._timeline_get_html_for_bar(o,a,e,n[a],s)),r}}}},A._temp_matrix_scope()}),Scheduler.plugin(function(d){var r;d.attachEvent("onTimelineCreated",function(e){"tree"==e.render&&(e.y_unit_original=e.y_unit,e.y_unit=d._getArrayToDisplay(e.y_unit_original),d.attachEvent("onOptionsLoadStart",function(){e.y_unit=d._getArrayToDisplay(e.y_unit_original)}),d.form_blocks[e.name]={render:function(e){return"<div class='dhx_section_timeline' style='overflow: hidden; height: "+e.height+"px'></div>"},set_value:function(e,t,i,n){var a=d._getArrayForSelect(d.matrix[n.type].y_unit_original,n.type);e.innerHTML="";var o=document.createElement("select");e.appendChild(o);var r=e.getElementsByTagName("select")[0];!r._dhx_onchange&&n.onchange&&(r.onchange=n.onchange,r._dhx_onchange=!0);for(var s=0;s<a.length;s++){var l=document.createElement("option");l.value=a[s].key,l.value==i[d.matrix[n.type].y_property]&&(l.selected=!0),l.innerHTML=a[s].label,r.appendChild(l)}},get_value:function(e,t,i){return e.firstChild.value},focus:function(e){}})}),d.attachEvent("onBeforeSectionRender",function(e,t,i){var n,a,o,r,s,l={};return"tree"==e&&(s="dhx_matrix_scell",e=t.children?(n=i.folder_dy||i.dy,i.folder_dy&&!i.section_autoheight&&(o="height:"+i.folder_dy+"px;"),a="dhx_row_folder",s+=" folder",t.open?s+=" opened":s+=" closed",r="<div class='dhx_scell_expand'>"+(t.open?"-":"+")+"</div>",i.folder_events_available?"dhx_data_table folder_events":"dhx_data_table folder"):(n=i.dy,a="dhx_row_item",s+=" item",r="","dhx_data_table"),l={height:n,style_height:o,tr_className:a,td_className:s+=d.templates[i.name+"_scaley_class"](t.key,t.label,t)?" "+d.templates[i.name+"_scaley_class"](t.key,t.label,t):"",td_content:"<div class='dhx_scell_level"+t.level+"'>"+r+"<div class='dhx_scell_name'>"+(d.templates[i.name+"_scale_label"](t.key,t.label,t)||t.label)+"</div></div>",table_className:e}),l}),d.attachEvent("onBeforeEventChanged",function(e,t,i){if(d._isRender("tree"))for(var n=d._get_event_sections?d._get_event_sections(e):[e[d.matrix[d._mode].y_property]],a=0;a<n.length;a++){var o=d.getSection(n[a]);if(o&&o.children&&!d.matrix[d._mode].folder_events_available)return i||(e[d.matrix[d._mode].y_property]=r),!1}return!0}),d.attachEvent("onBeforeDrag",function(e,t,i){if(d._isRender("tree")){var n,i=d._locate_cell_timeline(i);if(i&&(n=d.matrix[d._mode].y_unit[i.y].key,d.matrix[d._mode].y_unit[i.y].children&&!d.matrix[d._mode].folder_events_available))return!1;i=d.getEvent(e),e=d.matrix[d._mode].y_property;r=i&&i[e]?i[e]:n}return!0}),d._getArrayToDisplay=function(e){function s(e,t,i,n){for(var a=t||0,o=0;o<e.length;o++){var r=e[o];r.level=a,r.$parent=i||null,r.children&&void 0===r.key&&(r.key=d.uid()),n||l.push(r),r.children&&s(r.children,a+1,r.key,n||!r.open)}}var l=[];return s(e),l},d._getArrayForSelect=function(e,i){function n(e){for(var t=0;t<e.length;t++)!d.matrix[i].folder_events_available&&e[t].children||a.push(e[t]),e[t].children&&n(e[t].children)}var a=[];return n(e),a},d._toggleFolderDisplay=function(e,t,i){function o(e,t,i,n){for(var a=0;a<t.length&&(t[a].key!=e&&!n||!t[a].children||(t[a].open=void 0!==i?i:!t[a].open,r=!0,n||!r));a++)t[a].children&&o(e,t[a].children,i,n)}var r,n=d.getSection(e);void 0!==t||i||(t=!n.open),d.callEvent("onBeforeFolderToggle",[n,t,i])&&(o(e,d.matrix[d._mode].y_unit_original,t,i),d.matrix[d._mode].y_unit=d._getArrayToDisplay(d.matrix[d._mode].y_unit_original),d.callEvent("onOptionsLoad",[]),d.callEvent("onAfterFolderToggle",[n,t,i]))},d.attachEvent("onCellClick",function(e,t,i,n,a){d._isRender("tree")&&(d.matrix[d._mode].folder_events_available||void 0!==d.matrix[d._mode].y_unit[t]&&d.matrix[d._mode].y_unit[t].children&&d._toggleFolderDisplay(d.matrix[d._mode].y_unit[t].key))}),d.attachEvent("onYScaleClick",function(e,t,i){d._isRender("tree")&&t.children&&d._toggleFolderDisplay(t.key)}),d.getSection=function(e){if(d._isRender("tree")){function n(e,t){for(var i=0;i<t.length;i++)t[i].key==e&&(a=t[i]),t[i].children&&n(e,t[i].children)}var a;return n(e,d.matrix[d._mode].y_unit_original),a||null}},d.deleteSection=function(e){if(d._isRender("tree")){function n(e,t){for(var i=0;i<t.length&&(t[i].key==e&&(t.splice(i,1),a=!0),!a);i++)t[i].children&&n(e,t[i].children)}var a=!1;return n(e,d.matrix[d._mode].y_unit_original),d.matrix[d._mode].y_unit=d._getArrayToDisplay(d.matrix[d._mode].y_unit_original),d.callEvent("onOptionsLoad",[]),a}},d.deleteAllSections=function(){d._isRender("tree")&&(d.matrix[d._mode].y_unit_original=[],d.matrix[d._mode].y_unit=d._getArrayToDisplay(d.matrix[d._mode].y_unit_original),d.callEvent("onOptionsLoad",[]))},d.addSection=function(e,a){if(d._isRender("tree")){function o(e,t,i){if(a)for(var n=0;n<i.length&&(i[n].key==t&&i[n].children&&(i[n].children.push(e),r=!0),!r);n++)i[n].children&&o(e,t,i[n].children);else i.push(e),r=!0}var r=!1;return o(e,a,d.matrix[d._mode].y_unit_original),d.matrix[d._mode].y_unit=d._getArrayToDisplay(d.matrix[d._mode].y_unit_original),d.callEvent("onOptionsLoad",[]),r}},d.openAllSections=function(){d._isRender("tree")&&d._toggleFolderDisplay(1,!0,!0)},d.closeAllSections=function(){d._isRender("tree")&&d._toggleFolderDisplay(1,!1,!0)},d.openSection=function(e){d._isRender("tree")&&d._toggleFolderDisplay(e,!0)},d.closeSection=function(e){d._isRender("tree")&&d._toggleFolderDisplay(e,!1)}}),Scheduler.plugin(function(O){O.templates.calendar_month=O.date.date_to_str("%F %Y"),O.templates.calendar_scale_date=O.date.date_to_str("%D"),O.templates.calendar_date=O.date.date_to_str("%d"),O.config.minicalendar={mark_events:!0},O._synced_minicalendars=[],O.renderCalendar=function(e,t,i){var n,a,o=null,r=e.date||O._currentDate();if("string"==typeof r&&(r=this.templates.api_date(r)),t?(o=this._render_calendar(t.parentNode,r,e,t),O.unmarkCalendar(o)):(n=e.container,a=e.position,"string"==typeof n&&(n=document.getElementById(n)),(a="string"==typeof a?document.getElementById(a):a)&&void 0===a.left&&void 0===a.right&&(a={top:(t=O.$domHelpers.getOffset(a)).top+a.offsetHeight,left:t.left}),n=n||O._get_def_cont(a),(o=this._render_calendar(n,r,e)).onclick=function(e){var t=(e=e||event).target||e.srcElement,e=O.$domHelpers;!e.closest(t,".dhx_month_head")||e.closest(t,".dhx_after")||e.closest(t,".dhx_before")||(t=e.closest(t,"[data-cell-date]").getAttribute("data-cell-date"),t=O.templates.parse_date(t),O.unmarkCalendar(this),O.markCalendar(this,t,"dhx_calendar_click"),this._last_date=t,this.conf.handler&&this.conf.handler.call(O,t,this))}),O.config.minicalendar.mark_events)for(var s=O.date.month_start(r),l=O.date.add(s,1,"month"),d=this.getEvents(s,l),_=this["filter_"+this._mode],h={},c=0;c<d.length;c++){var u=d[c];if(!_||_(u.id,u)){var m=u.start_date;for(m.valueOf()<s.valueOf()&&(m=s),m=O.date.date_part(new Date(m.valueOf()));m<u.end_date&&(h[+m]||(h[+m]=!0,this.markCalendar(o,m,"dhx_year_event")),!((m=this.date.add(m,1,"day")).valueOf()>=l.valueOf())););}}return this._markCalendarCurrentDate(o),(o.conf=e).sync&&!i&&this._synced_minicalendars.push(o),o.conf._on_xle_handler||(o.conf._on_xle_handler=O.attachEvent("onXLE",function(){O.updateCalendar(o,o.conf.date)})),this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&o.setAttribute("role","application"),o},O._get_def_cont=function(e){return this._def_count||(this._def_count=document.createElement("div"),this._def_count.className="dhx_minical_popup",this._def_count.onclick=function(e){(e||event).cancelBubble=!0},document.body.appendChild(this._def_count)),e.left&&(this._def_count.style.left=e.left+"px"),e.right&&(this._def_count.style.right=e.right+"px"),e.top&&(this._def_count.style.top=e.top+"px"),e.bottom&&(this._def_count.style.bottom=e.bottom+"px"),this._def_count._created=new Date,this._def_count},O._locateCalendar=function(e,t){if(+(t="string"==typeof t?O.templates.api_date(t):t)>+e._max_date||+t<+e._min_date)return null;for(var i=e.querySelector(".dhx_year_body").childNodes[0],n=0,a=new Date(e._min_date);+this.date.add(a,1,"week")<=+t;)a=this.date.add(a,1,"week"),n++;e=O.config.start_on_monday,e=(t.getDay()||(e?7:0))-(e?1:0);return i.rows[n].cells[e].firstChild},O.markCalendar=function(e,t,i){t=this._locateCalendar(e,t);t&&(t.className+=" "+i)},O.unmarkCalendar=function(e,t,i){var n;i=i||"dhx_calendar_click",(t=t||e._last_date)&&(n=this._locateCalendar(e,t))&&(n.className=(n.className||"").replace(RegExp(i,"g")))},O._week_template=function(e){for(var t=e||250,i=0,n=document.createElement("div"),a=this.date.week_start(O._currentDate()),o=0;o<7;o++)this._cols[o]=Math.floor(t/(7-o)),this._render_x_header(o,i,a,n),a=this.date.add(a,1,"day"),t-=this._cols[o],i+=this._cols[o];return n.lastChild.className+=" dhx_scale_bar_last",n},O.updateCalendar=function(e,t){e.conf.date=t,this.renderCalendar(e.conf,e,!0)},O._mini_cal_arrows=["&nbsp;","&nbsp;"],O._render_calendar=function(e,t,n,i){var a=O.templates,o=this._cols;this._cols=[];var r=this._mode;this._mode="calendar";var s=this._colsS;this._colsS={height:0};var l=new Date(this._min_date),d=new Date(this._max_date),_=new Date(O._date),h=a.month_day,c=this._ignores_detected;this._ignores_detected=0,a.month_day=a.calendar_date,t=this.date.month_start(t);var u,m=this._week_template(e.offsetWidth-1-this.config.minicalendar.padding);i?u=i:(u=document.createElement("div")).className="dhx_cal_container dhx_mini_calendar",u.setAttribute("date",this._helpers.formatDate(t)),u.innerHTML="<div class='dhx_year_month'></div><div class='dhx_year_grid"+(O.config.rtl?" dhx_grid_rtl'>":"'>")+"<div class='dhx_year_week'>"+(m?m.innerHTML:"")+"</div><div class='dhx_year_body'></div></div>";var f=u.querySelector(".dhx_year_month"),p=u.querySelector(".dhx_year_week"),g=u.querySelector(".dhx_year_body");if(f.innerHTML=this.templates.calendar_month(t),n.navigation)for(var v=function(e,t){t=O.date.add(e._date,t,"month");O.updateCalendar(e,t),O._date.getMonth()==e._date.getMonth()&&O._date.getFullYear()==e._date.getFullYear()&&O._markCalendarCurrentDate(e)},x=["dhx_cal_prev_button","dhx_cal_next_button"],y=["left:1px;top:2px;position:absolute;","left:auto; right:1px;top:2px;position:absolute;"],b=[-1,1],w=[O.locale.labels.prev,O.locale.labels.next],D=0;D<2;D++){var P=document.createElement("div");P.className=x[D],O._waiAria.headerButtonsAttributes(P,w[D]),P.style.cssText=y[D],P.innerHTML=this._mini_cal_arrows[D],f.appendChild(P),P.onclick=function(i){return function(){if(n.sync)for(var e=O._synced_minicalendars,t=0;t<e.length;t++)v(e[t],i);else O.config.rtl&&(i=-i),v(u,i)}}(b[D])}u._date=new Date(t),u.week_start=(t.getDay()-(this.config.start_on_monday?1:0)+7)%7;m=u._min_date=this.date.week_start(t);u._max_date=this.date.add(u._min_date,6,"week"),this._reset_month_scale(g,t,m,6),i||e.appendChild(u),p.style.height=p.childNodes[0].offsetHeight-1+"px";e=O.uid();O._waiAria.minicalHeader(f,e),O._waiAria.minicalGrid(u.querySelector(".dhx_year_grid"),e),O._waiAria.minicalRow(p);for(var E=p.querySelectorAll(".dhx_scale_bar"),k=0;k<E.length;k++)O._waiAria.minicalHeadCell(E[k]);for(var S=g.querySelectorAll("td"),M=new Date(m),k=0;k<S.length;k++)O._waiAria.minicalDayCell(S[k],new Date(M)),M=O.date.add(M,1,"day");return O._waiAria.minicalHeader(f,e),this._cols=o,this._mode=r,this._colsS=s,this._min_date=l,this._max_date=d,O._date=_,a.month_day=h,this._ignores_detected=c,u},O.destroyCalendar=function(e,t){(e=!e&&this._def_count&&this._def_count.firstChild&&(t||500<(new Date).valueOf()-this._def_count._created.valueOf())?this._def_count.firstChild:e)&&(e.onclick=null,e.innerHTML="",e.parentNode&&e.parentNode.removeChild(e),this._def_count&&(this._def_count.style.top="-1000px"),e.conf&&e.conf._on_xle_handler&&O.detachEvent(e.conf._on_xle_handler))},O.isCalendarVisible=function(){return!!(this._def_count&&0<parseInt(this._def_count.style.top,10))&&this._def_count},O._attach_minical_events=function(){O.event(document.body,"click",function(){O.destroyCalendar()}),O._attach_minical_events=function(){}},O.attachEvent("onTemplatesReady",function(){O._attach_minical_events()}),O.templates.calendar_time=O.date.date_to_str("%d-%m-%Y"),O.form_blocks.calendar_time={render:function(e){var t="<input class='dhx_readonly' type='text' readonly='true'>",i=O.config,n=this.date.date_part(O._currentDate()),a=1440,o=0;i.limit_time_select&&(o=60*i.first_hour,a=60*i.last_hour+1),n.setHours(o/60),e._time_values=[],t+=" <select class='dhx_lightbox_time_select'>";for(var r=o;r<a;r+=+this.config.time_step)t+="<option value='"+r+"'>"+this.templates.time_picker(n)+"</option>",e._time_values.push(r),n=this.date.add(n,this.config.time_step,"minute");return O.config.full_day,"<div style='height:30px;padding-top:0; font-size:inherit;' class='dhx_section_time dhx_lightbox_minical'>"+(t+="</select>")+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>"+t+"</div>"},set_value:function(i,e,n,s){function a(e,t,i){u(e,t,i),e.value=O.templates.calendar_time(t),e._date=O.date.date_part(new Date(t))}function t(e){for(var t=s._time_values,i=60*e.getHours()+e.getMinutes(),n=i,a=!1,o=0;o<t.length;o++){var r=t[o];if(r===i){a=!0;break}r<i&&(n=r)}return a||n?a?i:n:-1}var o,r,l,d,_,h=i.getElementsByTagName("input"),c=i.getElementsByTagName("select"),u=function(t,e,i){t.onclick=function(){O.destroyCalendar(null,!0),O.renderCalendar({position:t,date:new Date(this._date),navigation:!0,handler:function(e){t.value=O.templates.calendar_time(e),t._date=new Date(e),O.destroyCalendar(),O.config.event_duration&&O.config.auto_end_date&&0===i&&_()}})}};O.config.full_day&&(i._full_day||(d="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+O.locale.labels.full_day+"&nbsp;</label></input>",O.config.wide_form||(d=i.previousSibling.innerHTML+d),i.previousSibling.innerHTML=d,i._full_day=!0),l=i.previousSibling.getElementsByTagName("input")[0],d=0===O.date.time_part(n.start_date)&&0===O.date.time_part(n.end_date),l.checked=d,c[0].disabled=l.checked,c[1].disabled=l.checked,l.onclick=function(){!0===l.checked&&(O.form_blocks.calendar_time.get_value(i,t={}),o=O.date.date_part(t.start_date),(+(r=O.date.date_part(t.end_date))==+o||+o<=+r&&(0!==n.end_date.getHours()||0!==n.end_date.getMinutes()))&&(r=O.date.add(r,1,"day")));var e=o||n.start_date,t=r||n.end_date;a(h[0],e),a(h[1],t),c[0].value=60*e.getHours()+e.getMinutes(),c[1].value=60*t.getHours()+t.getMinutes(),c[0].disabled=l.checked,c[1].disabled=l.checked}),O.config.event_duration&&O.config.auto_end_date&&(_=function(){o=O.date.add(h[0]._date,c[0].value,"minute"),r=new Date(o.getTime()+60*O.config.event_duration*1e3),h[1].value=O.templates.calendar_time(r),h[1]._date=O.date.date_part(new Date(r)),c[1].value=60*r.getHours()+r.getMinutes()},c[0].onchange=_),a(h[0],n.start_date,0),a(h[1],n.end_date,1),u=function(){},c[0].value=t(n.start_date),c[1].value=t(n.end_date)},get_value:function(e,t){var i=e.getElementsByTagName("input"),e=e.getElementsByTagName("select");return t.start_date=O.date.add(i[0]._date,e[0].value,"minute"),t.end_date=O.date.add(i[1]._date,e[1].value,"minute"),t.end_date<=t.start_date&&(t.end_date=O.date.add(t.start_date,O.config.time_step,"minute")),{start_date:new Date(t.start_date),end_date:new Date(t.end_date)}},focus:function(e){}},O.linkCalendar=function(t,i){function e(){var e=O._date,e=new Date(e.valueOf());return(e=i?i(e):e).setDate(1),O.updateCalendar(t,e),!0}O.attachEvent("onViewChange",e),O.attachEvent("onXLE",e),O.attachEvent("onEventAdded",e),O.attachEvent("onEventChanged",e),O.attachEvent("onEventDeleted",e),e()},O._markCalendarCurrentDate=function(e){var t=O.getState(),i=t.min_date,n=t.max_date,t=t.mode,a=O.date.month_start(new Date(e._date)),o=O.date.add(a,1,"month");if(!({month:!0,year:!0,agenda:!0,grid:!0}[t]||i.valueOf()<=a.valueOf()&&n.valueOf()>=o.valueOf()))for(var r=i;r.valueOf()<n.valueOf();)a.valueOf()<=r.valueOf()&&r<o&&O.markCalendar(e,r,"dhx_calendar_click"),r=O.date.add(r,1,"day")},O.attachEvent("onEventCancel",function(){O.destroyCalendar(null,!0)})}),Scheduler.plugin(function(l){window.dhtmlXTooltip=l.dhtmlXTooltip=l.tooltip={},dhtmlXTooltip.config={className:"dhtmlXTooltip tooltip",timeout_to_display:50,timeout_to_hide:50,delta_x:15,delta_y:-20},dhtmlXTooltip.tooltip=document.createElement("div"),dhtmlXTooltip.tooltip.className=dhtmlXTooltip.config.className,l._waiAria.tooltipAttr(dhtmlXTooltip.tooltip),dhtmlXTooltip.show=function(e,t){var i,n,a,o,r;this._mobile&&!l.config.touch_tooltip||(i=dhtmlXTooltip,n=(r=this.tooltip).style,i.tooltip.className=i.config.className,a=this.position(e),o=e.target||e.srcElement,this.isTooltip(o)||(e=a.x+(i.config.delta_x||0),o=a.y-(i.config.delta_y||0),n.visibility="hidden",n.removeAttribute?(n.removeAttribute("right"),n.removeAttribute("bottom")):(n.removeProperty("right"),n.removeProperty("bottom")),n.left="0",n.top="0",l.config.rtl&&(r.className+=" dhtmlXTooltip_rtl"),this.tooltip.innerHTML=t,document.body.appendChild(this.tooltip),r=this.tooltip.offsetWidth,t=this.tooltip.offsetHeight,document.documentElement.clientWidth-e-r<0?(n.removeAttribute?n.removeAttribute("left"):n.removeProperty("left"),n.right=document.documentElement.clientWidth-e+2*(i.config.delta_x||0)+"px"):n.left=e<0?a.x+Math.abs(i.config.delta_x||0)+"px":e+"px",document.documentElement.clientHeight-o-t<0?(n.removeAttribute?n.removeAttribute("top"):n.removeProperty("top"),n.bottom=document.documentElement.clientHeight-o-2*(i.config.delta_y||0)+"px"):n.top=o<0?a.y+Math.abs(i.config.delta_y||0)+"px":o+"px",l._waiAria.tooltipVisibleAttr(this.tooltip),n.visibility="visible",this.tooltip.onmouseleave=function(e){e=e||window.event;for(var t=l.dhtmlXTooltip,i=e.relatedTarget;i!=l._obj&&i;)i=i.parentNode;i!=l._obj&&t.delay(t.hide,t,[],t.config.timeout_to_hide)},l.callEvent("onTooltipDisplayed",[this.tooltip,this.tooltip.event_id])))},dhtmlXTooltip._clearTimeout=function(){this.tooltip._timeout_id&&window.clearTimeout(this.tooltip._timeout_id)},dhtmlXTooltip.hide=function(){var e;this.tooltip.parentNode&&(l._waiAria.tooltipHiddenAttr(this.tooltip),e=this.tooltip.event_id,this.tooltip.event_id=null,this.tooltip.onmouseleave=null,this.tooltip.parentNode.removeChild(this.tooltip),l.callEvent("onAfterTooltip",[e])),this._clearTimeout()},dhtmlXTooltip.delay=function(t,i,n,e){this._clearTimeout(),this.tooltip._timeout_id=setTimeout(function(){var e=t.apply(i,n);return t=i=n=null,e},e||this.config.timeout_to_display)},dhtmlXTooltip.isTooltip=function(e){for(var t=!1;e&&!t;)t=e.className==this.tooltip.className,e=e.parentNode;return t},dhtmlXTooltip.position=function(e){return{x:(e=e||window.event).clientX,y:e.clientY}},l.attachEvent("onMouseMove",function(e,t){var i,n=window.event||t,a=n.target||n.srcElement,o=dhtmlXTooltip,t=o.isTooltip(a),a=o.isTooltipTarget&&o.isTooltipTarget(a);if(e&&l.getState().editor_id!=e||t||a){if(e||o.tooltip.event_id){var r=l.getEvent(e)||l.getEvent(o.tooltip.event_id);if(!r)return;if(o.tooltip.event_id=r.id,!(r=l.templates.tooltip_text(r.start_date,r.end_date,r)))return o.hide()}if(a&&(r=""),l.$env.isIE)for(var s in i={pageX:void 0,pageY:void 0,clientX:void 0,clientY:void 0,target:void 0,srcElement:void 0})i[s]=n[s];l.callEvent("onBeforeTooltip",[e])&&r&&o.delay(o.show,o,[i||n,r])}else o.delay(o.hide,o,[],o.config.timeout_to_hide)}),l.attachEvent("onBeforeDrag",function(){return dhtmlXTooltip.hide(),!0}),l.attachEvent("onEventDeleted",function(){return dhtmlXTooltip.hide(),!0})}),Scheduler.plugin(function(u){u.attachEvent("onTemplatesReady",function(){function n(e,t,i,n){for(var a=t.getElementsByTagName(e),o=i.getElementsByTagName(e),r=o.length-1;0<=r;r--){var s,i=o[r];n?((s=document.createElement("span")).className="dhx_text_disabled",s.innerHTML=n(a[r]),i.parentNode.insertBefore(s,i),i.parentNode.removeChild(i)):(i.disabled=!0,t.checked&&(i.checked=!0))}}var _;u.form_blocks.recurring&&(_=u.form_blocks.recurring.set_value);var h=u.config.buttons_left.slice(),c=u.config.buttons_right.slice();u.attachEvent("onBeforeLightbox",function(e){this.config.readonly_form||this.getEvent(e).readonly?this.config.readonly_active=!0:(this.config.readonly_active=!1,u.config.buttons_left=h.slice(),u.config.buttons_right=c.slice(),u.form_blocks.recurring&&(u.form_blocks.recurring.set_value=_));var t=this.config.lightbox.sections;if(this.config.readonly_active){for(var i=0;i<t.length;i++)"recurring"==t[i].type&&this.config.readonly_active&&u.form_blocks.recurring&&(u.form_blocks.recurring.set_value=function(e,t,i){var n=u.$domHelpers.closest(e,".dhx_wrap_section"),e="none";n.querySelector(".dhx_cal_lsection").display=e,n.querySelector(".dhx_form_repeat").display=e,n.style.display=e,u.setLightboxSize()});for(var n=["dhx_delete_btn","dhx_save_btn"],a=[u.config.buttons_left,u.config.buttons_right],i=0;i<n.length;i++)for(var o=n[i],r=0;r<a.length;r++){for(var s=a[r],l=-1,d=0;d<s.length;d++)if(s[d]==o){l=d;break}-1!=l&&s.splice(l,1)}}return this.resetLightbox(),!0});var a=u._fill_lightbox;u._fill_lightbox=function(){var e=this.getLightbox();this.config.readonly_active&&(e.style.visibility="hidden",e.style.display="block");var t,i=a.apply(this,arguments);return this.config.readonly_active&&(e.style.visibility="",e.style.display="none"),this.config.readonly_active&&(t=this.getLightbox(),(e=this._lightbox_r=t.cloneNode(!0)).id=u.uid(),e.className+=" dhx_cal_light_readonly",n("textarea",t,e,function(e){return e.value}),n("input",t,e,!1),n("select",t,e,function(e){return e.options.length?e.options[Math.max(e.selectedIndex||0,0)].text:""}),t.parentNode.insertBefore(e,t),o.call(this,e),u._lightbox&&u._lightbox.parentNode.removeChild(u._lightbox),this._lightbox=e,u.config.drag_lightbox&&(e.firstChild.onmousedown=u._ready_to_dnd),this.setLightboxSize(),e.onclick=function(e){e=e?e.target:event.srcElement,e=u.$domHelpers.closest(e,".dhx_btn_set");e&&e.querySelector(".dhx_cancel_btn")&&u.cancel_lightbox()},e.onkeydown=function(e){var t=e||window.event,i=e.target||e.srcElement,n=(n=i.querySelector("[dhx_button]"))||i.parentNode.querySelector(".dhx_custom_button, .dhx_readonly");switch((e||t).keyCode){case 32:if((e||t).shiftKey)return;n&&n.click&&n.click();break;case u.keys.edit_cancel:u.cancel_lightbox()}}),i};var o=u.showCover;u.showCover=function(){this.config.readonly_active||o.apply(this,arguments)};var e=u.hide_lightbox;u.hide_lightbox=function(){return this._lightbox_r&&(this._lightbox_r.parentNode.removeChild(this._lightbox_r),this._lightbox_r=this._lightbox=null),e.apply(this,arguments)}})}),Scheduler.plugin(function(d){!function(){var l=!0;d.attachEvent("onBeforeViewChange",function(e,t,i,n){l&&d._get_url_nav&&(((a=d._get_url_nav()).date||a.mode||a.event)&&(l=!1));var a=(d._obj.id||"scheduler")+"_settings";if(l){l=!1;var o=function(e){var t=e+"=";if(0<document.cookie.length){e=document.cookie.indexOf(t);if(-1!=e){e+=t.length;t=document.cookie.indexOf(";",e);return-1==t&&(t=document.cookie.length),document.cookie.substring(e,t)}}return""}(a);if(o){d._min_date||(d._min_date=n),(o=unescape(o).split("@"))[0]=this._helpers.parseDate(o[0]);var r=this.isViewExists(o[1])?o[1]:i,s=isNaN(+o[0])?n:o[0];return window.setTimeout(function(){d.setCurrentView(s,r)},1),!1}}return o=a,a="expires=Sun, 31 Jan 9999 22:00:00 GMT; SameSite=None; Secure",e=escape(this._helpers.formatDate(n||t)+"@"+(i||e)),document.cookie=o+"="+e+(a?"; "+a:""),!0});var i=d._load;d._load=function(){var e,t=arguments;d._date?i.apply(this,t):(e=this,window.setTimeout(function(){i.apply(e,t)},1))}}()}),Scheduler.plugin(function(h){h._get_url_nav=function(){for(var e={},t=(document.location.hash||"").replace("#","").split(","),i=0;i<t.length;i++){var n=t[i].split("=");2==n.length&&(e[n[0]]=n[1])}return e},h.attachEvent("onTemplatesReady",function(){function r(e){_=e,h.getEvent(e)&&h.showEvent(e)}var s=!0,l=h.date.str_to_date("%Y-%m-%d"),d=h.date.date_to_str("%Y-%m-%d"),_=h._get_url_nav().event||null;h.attachEvent("onAfterEventDisplay",function(e){return!(_=null)}),h.attachEvent("onBeforeViewChange",function(e,t,i,n){if(s){s=!1;var a=h._get_url_nav();if(a.event)try{if(h.getEvent(a.event))return setTimeout(function(){r(a.event)}),!1;var o=h.attachEvent("onXLE",function(){setTimeout(function(){r(a.event)}),h.detachEvent(o)})}catch(e){}if(a.date||a.mode){try{this.setCurrentView(a.date?l(a.date):null,a.mode||null)}catch(e){this.setCurrentView(a.date?l(a.date):null,i)}return!1}}e=["date="+d(n||t),"mode="+(i||e)];_&&e.push("event="+_);e="#"+e.join(",");return document.location.hash=e,!0})})}),Scheduler.plugin(function(h){h.config.multisection=!0,h.config.multisection_shift_all=!0,h.config.section_delimiter=",",h.attachEvent("onSchedulerReady",function(){h._inited_multisection_copies||(h.attachEvent("onEventIdChange",function(e,t){var i,n=this._multisection_copies;n&&n[e]&&!n[t]&&(i=n[e],delete n[e],n[t]=i)}),h._inited_multisection_copies=!0),h._register_copies_array=function(e){for(var t=0;t<e.length;t++)this._register_copy(e[t])},h._register_copy=function(e){var t;this._multisection_copies&&(this._multisection_copies[e.id]||(this._multisection_copies[e.id]={}),t=e[this._get_section_property()],this._multisection_copies[e.id][t]=e)},h._get_copied_event=function(e,t){if(!this._multisection_copies[e])return null;if(this._multisection_copies[e][t])return this._multisection_copies[e][t];var i=this._multisection_copies[e];if(h._drag_event&&h._drag_event._orig_section&&i[h._drag_event._orig_section])return i[h._drag_event._orig_section];var n,a=1/0,o=null;for(n in i)i[n]._sorder<a&&(o=i[n],a=i[n]._sorder);return o},h._clear_copied_events=function(){this._multisection_copies={}},h._restore_render_flags=function(e){for(var t=this._get_section_property(),i=0;i<e.length;i++){var n=e[i],a=h._get_copied_event(n.id,n[t]);if(a)for(var o in a)0===o.indexOf("_")&&(n[o]=a[o])}};var t=h._update_unit_section;h._update_unit_section=function(e){return h._update_sections(e,t)};var i=h._update_timeline_section;h._update_timeline_section=function(e){return h._update_sections(e,i)},h.isMultisectionEvent=function(e){return!(!e||!this._get_multisection_view())&&1<this._get_event_sections(e).length},h._get_event_sections=function(e){e=e[this._get_section_property()]||"";return this._parse_event_sections(e)},h._parse_event_sections=function(e){return e instanceof Array?e:e.toString().split(h.config.section_delimiter)},h._clear_copied_events(),h._split_events=function(e){var t=[],i=this._get_multisection_view(),n=this._get_section_property();if(i)for(var a=0;a<e.length;a++){var o=this._get_event_sections(e[a]);if(1<o.length)for(var r,s=0;s<o.length;s++)void 0!==i.order[o[s]]&&((r=h._copy_event(e[a]))[n]=o[s],t.push(r));else t.push(e[a])}else t=e;return t},h._get_multisection_view=function(){return!!this.config.multisection&&h._get_section_view()};var n=h.get_visible_events;h.get_visible_events=function(e){this._clear_copied_events();var t=n.apply(this,arguments);if(this._get_multisection_view()){for(var t=this._split_events(t),i=0;i<t.length;i++)this.is_visible_events(t[i])||(t.splice(i,1),i--);this._register_copies_array(t)}return t},h._rendered_events={};var a=h.render_view_data;h.render_view_data=function(e,t){return this._get_multisection_view()&&e&&(e=this._split_events(e),this._restore_render_flags(e)),a.apply(this,[e,t])},h._update_sections=function(e,t){var i=e.view,n=e.event,a=e.pos;if(h.isMultisectionEvent(n)){if(h._drag_event._orig_section||(h._drag_event._orig_section=a.section),h._drag_event._orig_section!=a.section){var o=i.order[a.section]-i.order[h._drag_event._orig_section];if(o){var r,s=this._get_event_sections(n),l=[],d=!0;if(h.config.multisection_shift_all)for(var _=0;_<s.length;_++){if(null===(r=h._shift_sections(i,s[_],o))){l=s,d=!1;break}l[_]=r}else for(_=0;_<s.length;_++){if(s[_]==a.section){l=s,d=!1;break}if(s[_]==h._drag_event._orig_section){if(null===(r=h._shift_sections(i,s[_],o))){l=s,d=!1;break}l[_]=r}else l[_]=s[_]}d&&(h._drag_event._orig_section=a.section),n[h._get_section_property()]=l.join(h.config.section_delimiter)}}}else t.apply(h,[e])},h._shift_sections=function(e,t,i){for(var n=null,a=e.y_unit||e.options,o=0;o<a.length;o++)if(a[o].key==t){n=o;break}i=a[n+i];return i?i.key:null};var s=h._get_blocked_zones;h._get_blocked_zones=function(e,t,i,n,a){if(t&&this.config.multisection){t=this._parse_event_sections(t);for(var o=[],r=0;r<t.length;r++)o=o.concat(s.apply(this,[e,t[r],i,n,a]));return o}return s.apply(this,arguments)};var l=h._check_sections_collision;h._check_sections_collision=function(e,t){if(this.config.multisection&&this._get_section_view()){e=this._split_events([e]),t=this._split_events([t]);for(var i=!1,n=0,a=e.length;n<a&&!i;n++)for(var o=0,r=t.length;o<r;o++)if(l.apply(this,[e[n],t[o]])){i=!0;break}return i}return l.apply(this,arguments)}})}),void 0===window.dhx4&&(window.dhx4={version:"4.0.3",skin:null,skinDetect:function(e){var t=document.createElement("DIV");t.className=e+"_skin_detect",document.body.firstChild?document.body.insertBefore(t,document.body.firstChild):document.body.appendChild(t);e=t.offsetWidth;return t.parentNode.removeChild(t),t=null,{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[e]||null},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var e,t=this.first();for(e in this.data)t=Math.max(t,this.data[e]);return t},reserve:function(e){return this.data[e]=this.last()+this.step,this.data[e]},clear:function(e){null!=this.data[e]&&(this.data[e]=null,delete this.data[e])}},s2b:function(e){return 1==e||"true"==e||"1"==e||"yes"==e||"y"==e},trim:function(e){return String(e).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")},template:function(e,i,n){return e.replace(/#([a-zA-Z0-9_-]{1,})#/g,function(e,t){return 0<t.length&&void 0!==i[t]?1==n?window.dhx4.trim(i[t]):String(i[t]):""})},absLeft:function(e){return"string"==typeof e&&(e=document.getElementById(e)),this._aOfs(e).left},absTop:function(e){return"string"==typeof e&&(e=document.getElementById(e)),this._aOfs(e).top},_aOfsSum:function(e){for(var t=0,i=0;e;)t+=parseInt(e.offsetTop),i+=parseInt(e.offsetLeft),e=e.offsetParent;return{top:t,left:i}},_aOfsRect:function(e){var t=e.getBoundingClientRect(),i=document.body,n=document.documentElement,a=window.pageYOffset||n.scrollTop||i.scrollTop,o=window.pageXOffset||n.scrollLeft||i.scrollLeft,e=n.clientTop||i.clientTop||0,i=n.clientLeft||i.clientLeft||0,e=t.top+a-e,i=t.left+o-i;return{top:Math.round(e),left:Math.round(i)}},_aOfs:function(e){return e.getBoundingClientRect?this._aOfsRect(e):this._aOfsSum(e)},_isObj:function(e){return null!=e&&"object"==typeof e&&void 0===e.length},_copyObj:function(e){if(this._isObj(e)){var t={};for(i in e)"object"==typeof e[i]&&null!=e[i]?t[i]=this._copyObj(e[i]):t[i]=e[i]}else for(var t=[],i=0;i<e.length;i++)"object"==typeof e[i]&&null!=e[i]?t[i]=this._copyObj(e[i]):t[i]=e[i];return t},screenDim:function(){var e=0<=navigator.userAgent.indexOf("MSIE"),t={};return t.left=document.body.scrollLeft,t.right=t.left+(window.innerWidth||document.body.clientWidth),t.top=Math.max((e?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),t.bottom=t.top+(e?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight),t},selectTextRange:function(e,t,i){var n=(e="string"==typeof e?document.getElementById(e):e).value.length;if(t=Math.max(Math.min(t,n),0),i=Math.min(i,n),e.setSelectionRange)try{e.setSelectionRange(t,i)}catch(e){}else if(e.createTextRange){e=e.createTextRange();e.moveStart("character",t),e.moveEnd("character",i-n);try{e.select()}catch(e){}}},transData:null,transDetect:function(){if(null==this.transData){this.transData={transProp:!1,transEv:null};var e,t={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(e in t)0==this.transData.transProp&&null!=document.documentElement.style[e]&&(this.transData.transProp=e,this.transData.transEv=t[e]);t=null}return this.transData}},window.dhx4.isIE=0<=navigator.userAgent.indexOf("MSIE")||0<=navigator.userAgent.indexOf("Trident"),window.dhx4.isIE6=null==window.XMLHttpRequest&&0<=navigator.userAgent.indexOf("MSIE"),window.dhx4.isIE7=0<=navigator.userAgent.indexOf("MSIE 7.0")&&navigator.userAgent.indexOf("Trident")<0,window.dhx4.isOpera=0<=navigator.userAgent.indexOf("Opera"),window.dhx4.isChrome=0<=navigator.userAgent.indexOf("Chrome"),window.dhx4.isKHTML=0<=navigator.userAgent.indexOf("Safari")||0<=navigator.userAgent.indexOf("Konqueror"),window.dhx4.isFF=0<=navigator.userAgent.indexOf("Firefox"),window.dhx4.isIPad=0<=navigator.userAgent.search(/iPad/gi)),void 0===window.dhx4.ajax&&(window.dhx4.ajax={cache:!1,method:"post",get:function(e,t){this._call("GET",e,null,!0,t)},getSync:function(e){return this._call("GET",e,null,!1)},post:function(e,t,i){t=1==arguments.length?"":2!=arguments.length||"function"!=typeof t&&"function"!=typeof window[t]?String(t):(i=t,""),this._call("POST",e,t,!0,i)},postSync:function(e,t){return t=null==t?"":String(t),this._call("POST",e,t,!1)},getLong:function(e,t){this._call("GET",e,null,!0,t,{url:e})},postLong:function(e,t,i){2!=arguments.length||"function"!=typeof t&&(window[t],!1)||(i=t,t=""),this._call("POST",e,t,!0,i,{url:e,postData:t})},_call:function(e,t,i,n,a,o){var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),s=null!=navigator.userAgent.match(/AppleWebKit/)&&null!=navigator.userAgent.match(/Qt/)&&null!=navigator.userAgent.match(/Safari/);if(1==n&&(r.onreadystatechange=function(){(4==r.readyState&&200==r.status||1==s&&3==r.readyState)&&window.setTimeout(function(){"function"==typeof a&&a.apply(window,[{xmlDoc:r}]),null!=o&&(void 0!==o.postData?dhx4.ajax.postLong(o.url,o.postData,a):dhx4.ajax.getLong(o.url,a)),r=a=null},1)}),"GET"==e&&1!=this.cache&&(t+=(0<=t.indexOf("?")?"&":"?")+"dhxr"+(new Date).getTime()),r.open(e,t,n),"POST"==e?(r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),1!=this.cache&&(i+=(0<i.length?"&":"")+"dhxr"+(new Date).getTime())):i=null,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(i),!n)return{xmlDoc:r}}}),void 0===window.dhx4._enableDataLoading&&(window.dhx4._enableDataLoading=function(obj,initObj,xmlToJson,xmlRootTag,mode){if("clear"==mode){for(var a in obj._dhxdataload)obj._dhxdataload[a]=null,delete obj._dhxdataload[a];return obj._loadData=null,obj._dhxdataload=null,obj.load=null,obj.loadStruct=null,void(obj=null)}if(obj._dhxdataload={initObj:initObj,xmlToJson:xmlToJson,xmlRootTag:xmlRootTag,onBeforeXLS:null},obj._loadData=function(data,loadParams,onLoad){2==arguments.length&&(onLoad=loadParams,loadParams=null);var obj=null;if(3==arguments.length&&(onLoad=arguments[2]),"string"==typeof data){var k=data.replace(/^\s{1,}/,"").replace(/\s{1,}$/,""),tag=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(tag.test(k.replace(/^<\?xml[^\?]*\?>\s*/,""))&&(window.DOMParser?obj=(new window.DOMParser).parseFromString(data,"text/xml"):void 0!==window.ActiveXObject&&(obj=new window.ActiveXObject("Microsoft.XMLDOM"),obj.async="false",obj.loadXML(data)),null!=obj&&(obj=this[this._dhxdataload.xmlToJson].apply(this,[obj]))),null==obj&&(null!=k.match(/^\{.*\}$/)||null!=k.match(/^\[.*\]$/))){try{eval("dhx4.temp="+k)}catch(e){dhx4.temp=null}obj=dhx4.temp,dhx4.temp=null}if(null==obj){this.callEvent("onXLS",[]);var params=[];if("function"==typeof this._dhxdataload.onBeforeXLS){var k=this._dhxdataload.onBeforeXLS.apply(this,[data]);if(null!=k&&"object"==typeof k&&(null!=k.url&&(data=k.url),null!=k.params))for(var a in k.params)params.push(a+"="+encodeURIComponent(k.params[a]))}var t=this,callBack=function(r){var obj=null;if(0<=(r.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)||null!=r.xmlDoc.responseText.replace(/^\s{1,}/,"").match(/^</))obj=t[t._dhxdataload.xmlToJson].apply(t,[r.xmlDoc.responseXML]);else{try{eval("dhx4.temp="+r.xmlDoc.responseText)}catch(e){dhx4.temp=null}obj=dhx4.temp,dhx4.temp=null}null!=obj&&t[t._dhxdataload.initObj].apply(t,[obj,data]),t.callEvent("onXLE",[]),null!=onLoad&&("function"==typeof onLoad?onLoad.apply(t,[]):"function"==typeof window[onLoad]&&window[onLoad].apply(t,[])),callBack=onLoad=null,t=null},params=params.join("&")+("string"==typeof loadParams?"&"+loadParams:"");return void("post"==dhx4.ajax.method?dhx4.ajax.post(data,params,callBack):"get"==dhx4.ajax.method&&dhx4.ajax.get(data+(data.indexOf("?"),"")+params,callBack))}}else obj="object"==typeof data.documentElement||void 0!==data.tagName&&void 0!==data.getElementsByTagName&&0<data.getElementsByTagName(this._dhxdataload.xmlRootTag).length?this[this._dhxdataload.xmlToJson].apply(this,[data]):window.dhx4._copyObj(data);null!=obj&&this[this._dhxdataload.initObj].apply(this,[obj]),null!=onLoad&&("function"==typeof onLoad?onLoad.apply(this,[]):"function"==typeof window[onLoad]&&window[onLoad].apply(this,[]),onLoad=null)},null!=mode){var k={struct:"loadStruct",data:"load"},a;for(a in mode)1==mode[a]&&(obj[k[a]]=function(){return this._loadData.apply(this,arguments)})}}),void 0===window.dhx4._eventable&&(window.dhx4._eventable=function(e,t){if("clear"==t)return e.detachAllEvents(),e.dhxevs=null,e.attachEvent=null,e.detachEvent=null,e.checkEvent=null,e.callEvent=null,e.detachAllEvents=null,void(e=null);e.dhxevs={data:{}},e.attachEvent=function(e,t){e=String(e).toLowerCase(),this.dhxevs.data[e]||(this.dhxevs.data[e]={});var i=window.dhx4.newId();return this.dhxevs.data[e][i]=t,i},e.detachEvent=function(e){for(var t in this.dhxevs.data){var i,n=0;for(i in this.dhxevs.data[t])i==e?(this.dhxevs.data[t][i]=null,delete this.dhxevs.data[t][i]):n++;0==n&&(this.dhxevs.data[t]=null,delete this.dhxevs.data[t])}},e.checkEvent=function(e){return e=String(e).toLowerCase(),null!=this.dhxevs.data[e]},e.callEvent=function(e,t){if(e=String(e).toLowerCase(),null==this.dhxevs.data[e])return!0;var i,n=!0;for(i in this.dhxevs.data[e])n=this.dhxevs.data[e][i].apply(this,t)&&n;return n},e.detachAllEvents=function(){for(var e in this.dhxevs.data){for(var t in this.dhxevs.data[e])this.dhxevs.data[e][t]=null,delete this.dhxevs.data[e][t];this.dhxevs.data[e]=null,delete this.dhxevs.data[e]}}}),dhtmlx=function(e){for(var t in e)dhtmlx[t]=e[t];return dhtmlx},dhtmlx.extend_api=function(e,n,t){var a=window[e];a&&(window[e]=function(e){if(e&&"object"==typeof e&&!e.tagName){var t,i=a.apply(this,n._init?n._init(e):arguments);for(t in dhtmlx)n[t]&&this[n[t]](dhtmlx[t]);for(t in e)n[t]?this[n[t]](e[t]):0==t.indexOf("on")&&this.attachEvent(t,e[t])}else i=a.apply(this,arguments);return n._patch&&n._patch(this),i||this},window[e].prototype=a.prototype,t&&dhtmlXHeir(window[e].prototype,t))},dhtmlxAjax={get:function(e,t){var i=new dtmlXMLLoaderObject(!0);return i.async=arguments.length<3,i.waitCall=t,i.loadXML(e),i},post:function(e,t,i){var n=new dtmlXMLLoaderObject(!0);return n.async=arguments.length<4,n.waitCall=i,n.loadXML(e,!0,t),n},getSync:function(e){return this.get(e,null,!0)},postSync:function(e,t){return this.post(e,t,null,!0)}},dtmlXMLLoaderObject.count=0,dtmlXMLLoaderObject.prototype.waitLoadFunction=function(e){var t=!0;return this.check=function(){e&&null!=e.onloadAction&&(e.xmlDoc.readyState&&4!=e.xmlDoc.readyState||t&&(t=!1,dtmlXMLLoaderObject.count++,"function"==typeof e.onloadAction&&e.onloadAction(e.mainObject,null,null,null,e),e.waitCall&&(e.waitCall.call(this,e),e.waitCall=null)))},this.check},dtmlXMLLoaderObject.prototype.getXMLTopNode=function(e,t){if(void 0===this.xmlDoc.status||this.xmlDoc.status<400){var i;if(i=this.xmlDoc.responseXML?(i=0==(i=this.xmlDoc.responseXML.getElementsByTagName(e)).length&&-1!=e.indexOf(":")?this.xmlDoc.responseXML.getElementsByTagName(e.split(":")[1]):i)[0]:this.xmlDoc.documentElement)return this._retry=!1,i;if(!this._retry&&_isIE){this._retry=!0;t=this.xmlDoc;return this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(e,t)}}return dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),document.createElement("DIV")},dtmlXMLLoaderObject.prototype.loadXMLString=function(e,t){var i;_isIE?(this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(e)):(i=new DOMParser,this.xmlDoc=i.parseFromString(e,"text/xml")),t||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))},dtmlXMLLoaderObject.prototype.loadXML=function(e,t,i,n){this.rSeed&&(e+=(-1!=e.indexOf("?")?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf()),this.filePath=e,!_isIE&&window.XMLHttpRequest?this.xmlDoc=new XMLHttpRequest:this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP"),this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)),this.xmlDoc.open(t?"POST":"GET",e,this.async),n?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):t&&this.xmlDoc.setRequestHeader("Content-type",this.contenttype||"application/x-www-form-urlencoded"),this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xmlDoc.send(i),this.async||new this.waitLoadFunction(this)()},dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,this.loadXML=null,this.loadXMLString=null,this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null},dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(e){for(var t={},i=0;i<e.attributes.length;i++)t[e.attributes[i].name]=e.attributes[i].value;t._tagvalue=e.firstChild?e.firstChild.nodeValue:"";for(i=0;i<e.childNodes.length;i++){var n=e.childNodes[i].tagName;n&&(t[n]||(t[n]=[]),t[n].push(this.xmlNodeToJSON(e.childNodes[i])))}return t},dhtmlDragAndDropObject.prototype.removeDraggableItem=function(e){e.onmousedown=null,e.dragStarter=null,e.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(e,t){e.onmousedown=this.preCreateDragCopy,e.dragStarter=t,this.addDragLanding(e,t)},dhtmlDragAndDropObject.prototype.addDragLanding=function(e,t){e.dragLanding=t},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(e){if(!e&&!window.event||2!=(e||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(e),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),e&&e.preventDefault&&e.preventDefault()),!1},dhtmlDragAndDropObject.prototype.callDrag=function(e){if(e=e||window.event,dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(e,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,e),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}var t,i;dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode&&(t=dragger.gldragNode,(t=dragger.gldragNode.old?dragger.gldragNode.old:t).parentNode.removeChild(t),i=dragger.dragNode.pWindow,t.pWindow&&t.pWindow.dhtmlDragAndDrop.lastLanding&&t.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(t.pWindow.dhtmlDragAndDrop.lastLanding),_isIE?((t=document.createElement("Div")).innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=t.childNodes[0]):dragger.dragNode=dragger.dragNode.cloneNode(!0),dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),i.dhtmlDragAndDrop.dragNode=dragger.dragNode),dragger.dragNode.style.left=e.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=e.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px",i=e.srcElement||e.target,dragger.checkLanding(i,e)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){if(window.name){for(var t,i=parent.frames[window.name].frameElement.offsetParent,n=0,a=0;i;)n+=i.offsetLeft,a+=i.offsetTop,i=i.offsetParent;if(parent.dhtmlDragAndDrop&&(n+=+(t=parent.dhtmlDragAndDrop.calculateFramePosition(1)).split("_")[0],a+=+t.split("_")[1]),e)return n+"_"+a;this.fx=n,this.fy=a}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(e,t){e&&e.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=e,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,t.clientX,t.clientY,t),this.lastLanding_scr=_isIE?t.srcElement:t.target):e&&"BODY"!=e.tagName?this.checkLanding(e.parentNode,t):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,t.clientX,t.clientY,t),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(e,t){dragger=window.dhtmlDragAndDrop,t||(dragger.stopFrameRoute(),t=dragger.lastLanding,dragger.lastLanding=null,t&&t.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,t,_isIE?event.srcElement:e.target)),dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(e){e&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var t=0;t<window.frames.length;t++)try{window.frames[t]!=e&&window.frames[t].dhtmlDragAndDrop&&window.frames[t].dhtmlDragAndDrop.stopFrameRoute(window)}catch(e){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(e){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(e,t){e&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=e.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=e.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=e.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=e.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&t&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=e&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(e){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=e&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!e||t?1:0)}catch(e){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),-1<navigator.userAgent.toLowerCase().indexOf("chrome")&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),525<_KHTMLrv?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||7<document.documentMode)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),dtmlXMLLoaderObject.prototype.doXPath=function(e,t,i,n){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(e,t);if(_isIE)return(t=t||(this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML))||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),null!=i&&t.setProperty("SelectionNamespaces","xmlns:xsl='"+i+"'"),"single"==n?t.selectSingleNode(e):t.selectNodes(e)||new Array(0);var a=t;(t=t||(this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML))||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),-1!=t.nodeName.indexOf("document")?a=t:t=(a=t).ownerDocument;var o=XPathResult.ANY_TYPE;"single"==n&&(o=XPathResult.FIRST_ORDERED_NODE_TYPE);var r=new Array,s=t.evaluate(e,a,function(e){return i},o,null);if(o==XPathResult.FIRST_ORDERED_NODE_TYPE)return s.singleNodeValue;for(var l=s.iterateNext();l;)r[r.length]=l,l=s.iterateNext();return r},_dhtmlxError.prototype.catchError=function(e,t){this.catches[e]=t},_dhtmlxError.prototype.throwError=function(e,t,i){return this.catches[e]?this.catches[e](e,t,i):this.catches.ALL?this.catches.ALL(e,t,i):(alert("Error type: "+e+"\nDescription: "+t),null)},window.dhtmlxError=new _dhtmlxError,dtmlXMLLoaderObject.prototype.doXPathOpera=function(e,t){var i=e.replace(/[\/]+/gi,"/").split("/"),n=null,a=1;if(!i.length)return[];if("."==i[0])n=[t];else{if(""!=i[0])return[];n=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(i[a].replace(/\[[^\]]*\]/g,"")),a++}for(;a<i.length;a++)n=this._getAllNamedChilds(n,i[a]);return n=-1!=i[a-1].indexOf("[")?this._filterXPath(n,i[a-1]):n},dtmlXMLLoaderObject.prototype._filterXPath=function(e,t){for(var i=new Array,t=t.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),n=0;n<e.length;n++)e[n].getAttribute(t)&&(i[i.length]=e[n]);return i},dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,t){var i=new Array;_isKHTML&&(t=t.toUpperCase());for(var n=0;n<e.length;n++)for(var a=0;a<e[n].childNodes.length;a++)_isKHTML?e[n].childNodes[a].tagName&&e[n].childNodes[a].tagName.toUpperCase()==t&&(i[i.length]=e[n].childNodes[a]):e[n].childNodes[a].tagName==t&&(i[i.length]=e[n].childNodes[a]);return i},dtmlXMLLoaderObject.prototype.xslDoc=null,dtmlXMLLoaderObject.prototype.setXSLParamValue=function(e,t,i){(i=i||this.xslDoc).responseXML&&(i=i.responseXML);i=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+e+"']",i,"http://www.w3.org/1999/XSL/Transform","single");null!=i&&(i.firstChild.nodeValue=t)},dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(t,i){if((t=t||this.xslDoc).responseXML&&(t=t.responseXML),(i=i||this.xmlDoc).responseXML&&(i=i.responseXML),_isIE){n=new ActiveXObject("Msxml2.DOMDocument.3.0");try{i.transformNodeToObject(t,n)}catch(e){n=i.transformNode(t)}}else{this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(t));var n=this.XSLProcessor.transformToDocument(i)}return n},dtmlXMLLoaderObject.prototype.doXSLTransToString=function(e,t){t=this.doXSLTransToObject(e,t);return"string"==typeof t?t:this.doSerialization(t)},dtmlXMLLoaderObject.prototype.doSerialization=function(e){return(e=e||this.xmlDoc).responseXML&&(e=e.responseXML),_isIE?e.xml:(new XMLSerializer).serializeToString(e)},dhtmlxEventable=function(obj){obj.attachEvent=function(e,t,i){return this[e="ev_"+e.toLowerCase()]||(this[e]=new this.eventCatcher(i||this)),e+":"+this[e].addEvent(t)},obj.callEvent=function(e,t){return!this[e="ev_"+e.toLowerCase()]||this[e].apply(this,t)},obj.checkEvent=function(e){return!!this["ev_"+e.toLowerCase()]},obj.eventCatcher=function(obj){var dhx_catch=[],z=function(){for(var e,t=!0,i=0;i<dhx_catch.length;i++)null!=dhx_catch[i]&&(e=dhx_catch[i].apply(obj,arguments),t=t&&e);return t};return z.addEvent=function(ev){return"function"!=typeof ev&&(ev=eval(ev)),ev?dhx_catch.push(ev)-1:!1},z.removeEvent=function(e){dhx_catch[e]=null},z},obj.detachEvent=function(e){0!=e&&this[(e=e.split(":"))[0]].removeEvent(e[1])},obj.detachAllEvents=function(){for(var e in this)0==e.indexOf("ev_")&&(this.detachEvent(e),this[e]=null)}},dhtmlXMenuObject.prototype._init=function(){1!=this._isInited&&(this.conf.dload?(this._dhxdataload.onBeforeXLS=function(){var e,t={params:{}};for(e in this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},this.loadStruct(this.conf.dload_url)):(this._initTopLevelMenu(),this._isInited=!0))},dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(e){var t,i=0;for(t in this.itemPull){var n=this.itemPull[t].parent,a=this.itemPull[t].type;null!=this.idPull[t]&&(n!=e||"item"!=a&&"radio"!=a&&"checkbox"!=a||"none"==this.idPull[t].style.display||i++)}return i},dhtmlXMenuObject.prototype._redefineComplexState=function(e){var t;this.idPrefix+this.topId!=e&&null!=this.idPull["polygon_"+e]&&null!=this.idPull[e]&&(0<(t=this._countVisiblePolygonItems(e))&&!this.itemPull[e].complex&&this._updateItemComplexState(e,!0,!1),0==t&&this.itemPull[e].complex&&this._updateItemComplexState(e,!1,!1))},dhtmlXMenuObject.prototype._updateItemComplexState=function(e,t,i){if(this.conf.context||"TopLevel"!=this._getItemLevelType(e.replace(this.idPrefix,""))){if(null!=this.idPull[e]&&null!=this.itemPull[e]&&(this.itemPull[e].complex=t,e!=this.idPrefix+this.topId)){var n=null,a=this.idPull[e].childNodes[this.conf.rtl?0:2];if(a.childNodes[0]&&0===String(a.childNodes[0].className).search("complex_arrow")&&(n=a.childNodes[0]),this.itemPull[e].complex){if(null==n){for((n=document.createElement("DIV")).className="complex_arrow",n.id="arrow_"+e;0<a.childNodes.length;)a.removeChild(a.childNodes[0]);a.appendChild(n)}this.conf.dload&&"get"==this.itemPull[e].loaded&&this.conf.dload_icon?"complex_arrow_loading"!=n.className&&(n.className="complex_arrow_loading"):n.className="complex_arrow"}else this.itemPull[e].complex||null==n||(a.removeChild(n),null!=this.itemPull[e].hotkey_backup&&this.setHotKey&&this.setHotKey(e.replace(this.idPrefix,""),this.itemPull[e].hotkey_backup))}}else this.itemPull[e].complex=t},dhtmlXMenuObject.prototype._getItemLevelType=function(e){return this.itemPull[this.idPrefix+e].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"},dhtmlXMenuObject.prototype.setIconsPath=function(e){this.conf.icons_path=e},dhtmlXMenuObject.prototype._updateItemImage=function(e,t){e=this.idPrefix+e;var i,n=this.itemPull[e].parent==this.idPrefix+this.topId&&!this.conf.context,a=null;if(n)for(var o=0;o<this.idPull[e].childNodes.length;o++)try{"dhtmlxMenu_TopLevel_Item_Icon"==this.idPull[e].childNodes[o].className&&(a=this.idPull[e].childNodes[o])}catch(e){}else{try{var a=this.idPull[e].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(e){}null!=a&&void 0!==a.className&&"sub_icon"==a.className||(a=null)}if(0<(i=(this.itemPull[e].type,this.itemPull[e]["enabled"==this.itemPull[e].state?"imgen":"imgdis"])).length)if(null!=a)a.src=this.conf.icons_path+i;else if(n)(a=document.createElement("IMG")).className="dhtmlxMenu_TopLevel_Item_Icon",a.src=this.conf.icons_path+i,a.border="0",a.id="image_"+e,!this.conf.rtl&&0<this.idPull[e].childNodes.length?this.idPull[e].insertBefore(a,this.idPull[e].childNodes[0]):this.idPull[e].appendChild(a);else{(a=document.createElement("IMG")).className="sub_icon",a.src=this.conf.icons_path+i,a.border="0",a.id="image_"+e;for(var r=this.idPull[e].childNodes[this.conf.rtl?2:0];0<r.childNodes.length;)r.removeChild(r.childNodes[0]);r.appendChild(a)}else null!=a&&((i=a.parentNode).removeChild(a),i.innerHTML="&nbsp;")},dhtmlXMenuObject.prototype._getAllParents=function(e){var t,i=new Array;for(t in this.itemPull)if(this.itemPull[t].parent==e&&(i[i.length]=this.itemPull[t].id,this.itemPull[t].complex))for(var n=this._getAllParents(this.itemPull[t].id),a=0;a<n.length;a++)i[i.length]=n[a];return i},dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){var e;this.conf.v_enabled||(e=window.dhx4.screenDim(),this.conf.v.x1=e.left,this.conf.v.x2=e.right,this.conf.v.y1=e.top,this.conf.v.y2=e.bottom)},dhtmlXMenuObject.prototype.getItemPosition=function(e){e=this.idPrefix+e;var t=-1;if(null==this.itemPull[e])return t;for(var i=this.itemPull[e].parent,n=null!=this.idPull["polygon_"+i]?this.idPull["polygon_"+i].tbd:this.cont,a=0;a<n.childNodes.length;a++)n.childNodes[a]!=this.idPull["separator_"+e]&&n.childNodes[a]!=this.idPull[e]||(t=a);return t},dhtmlXMenuObject.prototype.setItemPosition=function(e,t){var i,n,a;e=this.idPrefix+e,null!=this.idPull[e]&&(i=this.itemPull[e].parent==this.idPrefix+this.topId,n=this.idPull[e],a=this.getItemPosition(e.replace(this.idPrefix,"")),e=this.itemPull[e].parent,(e=null!=this.idPull["polygon_"+e]?this.idPull["polygon_"+e].tbd:this.cont).removeChild(e.childNodes[a]),t<0&&(t=0),(t=i&&t<1?1:t)<e.childNodes.length?e.insertBefore(n,e.childNodes[t]):e.appendChild(n))},dhtmlXMenuObject.prototype.getParentId=function(e){return e=this.idPrefix+e,null==this.itemPull[e]?null:(null!=this.itemPull[e].parent?this.itemPull[e].parent:this.topId).replace(this.idPrefix,"")},dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()},dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,!0),this._isInited=!1,this.idPrefix=this._genStr(12)+"_",this.itemPull={}},void 0===dhtmlXMenuObject.prototype.liveInst&&(dhtmlXMenuObject.prototype.liveInst={}),dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(e,t){var i=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var n=0;n<i.length;n++)i[n]!=e&&this._hidePolygon(i[n]),null!=this.idPull[i[n]]&&i[n]!=e&&(this.idPull[i[n]].className=this.idPull[i[n]].className.replace(/Selected/g,"Normal"));"enabled"==this.itemPull[this.idPrefix+e].state&&(this.idPull[this.idPrefix+e].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_Selected",this._addSubItemToSelected(this.idPrefix+e,"parent"),this.conf.selected="win"!=this.conf.mode||-1!=this.conf.selected?e:this.conf.selected,this.itemPull[this.idPrefix+e].complex&&-1!=this.conf.selected&&this._showPolygon(this.idPrefix+e,this.conf.dir_toplv))},dhtmlXMenuObject.prototype._initTopLevelMenu=function(){if(this.conf.dir_toplv="bottom",this.conf.dir_sublv=this.conf.rtl?"left":"right",this.conf.context)this.idPull[this.idPrefix+this.topId]=new Array(0,0),this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId);else for(var e=this._getMenuNodes(this.idPrefix+this.topId),t=0;t<e.length;t++)"item"==this.itemPull[e[t]].type&&this._renderToplevelItem(e[t],null),"separator"==this.itemPull[e[t]].type&&this._renderSeparator(e[t],null)},dhtmlXMenuObject.prototype._renderToplevelItem=function(e,t){var i,n,a=this,o=document.createElement("DIV");o.id=e,"enabled"==this.itemPull[e].state&&null!=this.itemPull[e].cssNormal?o.className=this.itemPull[e].cssNormal:o.className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[e].state?"Normal":"Disabled"),""!=this.itemPull[e].title&&((n=document.createElement("DIV")).className="top_level_text",n.innerHTML=this.itemPull[e].title,o.appendChild(n)),0<this.itemPull[e].tip.length&&(o.title=this.itemPull[e].tip),""==this.itemPull[e].imgen&&""==this.itemPull[e].imgdis||(i=this.itemPull[e]["enabled"==this.itemPull[e].state?"imgen":"imgdis"])&&((n=document.createElement("IMG")).border="0",n.id="image_"+e,n.src=this.conf.icons_path+i,n.className="dhtmlxMenu_TopLevel_Item_Icon",0<o.childNodes.length&&!this.conf.rtl?o.insertBefore(n,o.childNodes[0]):o.appendChild(n)),o.onselectstart=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},o.oncontextmenu=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},this.cont||(this.cont=document.createElement("DIV"),this.cont.dir="ltr",this.cont.className="right"==this.conf.align?"align_right":"align_left",this.base.appendChild(this.cont)),null!=(t=null!=t&&(t=++t<0?0:t)>this.cont.childNodes.length-1?null:t)?this.cont.insertBefore(o,this.cont.childNodes[t]):this.cont.appendChild(o),this.idPull[o.id]=o,this.itemPull[e].complex&&!this.conf.dload&&this._addSubMenuPolygon(this.itemPull[e].id,this.itemPull[e].id),o.onmouseover=function(){"web"==a.conf.mode&&window.clearTimeout(a.conf.tm_handler);var e=a._getSubItemToDeselectByPolygon("parent");a._removeSubItemFromSelected(-1,-1);for(var i,t,n=0;n<e.length;n++)e[n]!=this.id&&a._hidePolygon(e[n]),null!=a.idPull[e[n]]&&e[n]!=this.id&&(null!=a.itemPull[e[n]].cssNormal?a.idPull[e[n]].className=a.itemPull[e[n]].cssNormal:("sub_item_selected"==a.idPull[e[n]].className&&(a.idPull[e[n]].className="sub_item"),a.idPull[e[n]].className=a.idPull[e[n]].className.replace(/Selected/g,"Normal")));"enabled"==a.itemPull[this.id].state&&(this.className="dhtmlxMenu_"+a.conf.skin+"_TopLevel_Item_Selected",a._addSubItemToSelected(this.id,"parent"),a.conf.selected="win"!=a.conf.mode||-1!=a.conf.selected?this.id:a.conf.selected,a.conf.dload&&("no"==a.itemPull[this.id].loaded&&(this._dynLoadTM=(new Date).getTime(),a.itemPull[this.id].loaded="get",i=this.id.replace(a.idPrefix,""),a._dhxdataload.onBeforeXLS=function(){var e,t={params:{}};for(e in t.params[this.conf.dload_pid]=i,this.conf.dload_params)t.params[e]=this.conf.dload_params[e];return t},a.loadStruct(a.conf.dload_url)),a.conf.top_mode&&"web"==a.conf.mode&&!a.conf.context&&(this._mouseOver=!0)),a.conf.dload&&(!a.conf.dload||a.itemPull[this.id].loaded&&"yes"!=a.itemPull[this.id].loaded)||a.itemPull[this.id].complex&&-1!=a.conf.selected&&(a.conf.top_mode&&"web"==a.conf.mode&&!a.conf.context?(this._mouseOver=!0,t=this.id,this._menuOpenTM=window.setTimeout(function(){a._showPolygon(t,a.conf.dir_toplv)},a.conf.top_tmtime)):a._showPolygon(this.id,a.conf.dir_toplv))),a._doOnTouchMenu(this.id.replace(a.idPrefix,""))},o.onmouseout=function(){a.itemPull[this.id].complex&&-1!=a.conf.selected||"enabled"!=a.itemPull[this.id].state||(null!=a.itemPull[this.id].cssNormal?o.className=a.itemPull[this.id].cssNormal:o.className="dhtmlxMenu_"+a.conf.skin+"_TopLevel_Item_Normal"),"web"==a.conf.mode&&(window.clearTimeout(a.conf.tm_handler),a.conf.tm_handler=window.setTimeout(function(){a._clearAndHide()},a.conf.tm_sec,"JavaScript")),a.conf.top_mode&&"web"==a.conf.mode&&!a.conf.context&&(this._mouseOver=!1,window.clearTimeout(this._menuOpenTM))},o.onclick=function(e){if("web"==a.conf.mode&&window.clearTimeout(a.conf.tm_handler),"web"==a.conf.mode||"disabled"!=a.itemPull[this.id].state){(e=e||event).cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,"win"==a.conf.mode&&a.itemPull[this.id].complex&&((a.conf.selected==this.id?!(a.conf.selected=-1):(a.conf.selected=this.id,!0))?a._showPolygon(this.id,a.conf.dir_toplv):a._hidePolygon(this.id));var t=a.itemPull[this.id].complex?"c":"-",i="enabled"!=a.itemPull[this.id].state?"d":"-",e={ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey};return a._doOnClick(this.id.replace(a.idPrefix,""),t+i+"t",e),!1}},"dhx_terrace"==this.conf.skin&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addSubMenuPolygon=function(e,t){this._renderSublevelPolygon(e,t);for(var i=this._getMenuNodes(t),n=0;n<i.length;n++)"separator"==this.itemPull[i[n]].type?this._renderSeparator(i[n],null):this._renderSublevelItem(i[n],null);for(var n=0;n<i.length;n++)this.itemPull[i[n]].complex&&this._addSubMenuPolygon(e,this.itemPull[i[n]].id)},dhtmlXMenuObject.prototype._renderSublevelPolygon=function(e,t){var i=document.createElement("DIV");i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Polygon "+(this.conf.rtl?"dir_right":""),i.dir="ltr",i.oncontextmenu=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!(e.cancelBubble=!0)},i.id="polygon_"+t,i.onclick=function(e){(e=e||event).cancelBubble=!0},i.style.display="none",document.body.insertBefore(i,document.body.firstChild),i.innerHTML='<div style="position:relative;"></div><div style="position: relative; overflow:hidden;"></div><div style="position:relative;"></div>';var n=document.createElement("TABLE");n.className="dhtmlxMebu_SubLevelArea_Tbl",n.cellSpacing=0,n.cellPadding=0,n.border=0;var a=document.createElement("TBODY");return n.appendChild(a),i.childNodes[1].appendChild(n),i.tbl=n,i.tbd=a,this.idPull[i.id]=i,null!=this.sxDacProc&&(this.idPull["sxDac_"+t]=new this.sxDacProc(i,i.className),window.dhx4.isIE?(this.idPull["sxDac_"+t]._setSpeed(this.dacSpeedIE),this.idPull["sxDac_"+t]._setCustomCycle(this.dacCyclesIE)):(this.idPull["sxDac_"+t]._setSpeed(this.dacSpeed),this.idPull["sxDac_"+t]._setCustomCycle(this.dacCycles))),i},dhtmlXMenuObject.prototype._renderSublevelItem=function(e,t){var i=this,n=document.createElement("TR");n.className="enabled"==this.itemPull[e].state?"sub_item":"sub_item_dis";var a=document.createElement("TD");a.className="sub_item_icon";var o,r=this.itemPull[e]["enabled"==this.itemPull[e].state?"imgen":"imgdis"];""!=r?("checkbox"!=(o=this.itemPull[e].type)&&"radio"!=o||((s=document.createElement("DIV")).id="image_"+this.itemPull[e].id,s.className="sub_icon "+r,a.appendChild(s)),"checkbox"!=o&&"radio"!=o&&((s=document.createElement("IMG")).id="image_"+this.itemPull[e].id,s.className="sub_icon",s.src=this.conf.icons_path+r,a.appendChild(s))):a.innerHTML="&nbsp;";var s=document.createElement("TD");s.className="sub_item_text",""!=this.itemPull[e].title?((d=document.createElement("DIV")).className="sub_item_text",d.innerHTML=this.itemPull[e].title,s.appendChild(d)):s.innerHTML="&nbsp;";var l,d=document.createElement("TD");d.className="sub_item_hk",this.itemPull[e].complex?((l=document.createElement("DIV")).className="complex_arrow",l.id="arrow_"+this.itemPull[e].id,d.appendChild(l)):0<this.itemPull[e].hotkey.length&&!this.itemPull[e].complex?((l=document.createElement("DIV")).className="sub_item_hk",l.innerHTML=this.itemPull[e].hotkey,d.appendChild(l)):d.innerHTML="&nbsp;",n.appendChild(this.conf.rtl?d:a),n.appendChild(s),n.appendChild(this.conf.rtl?a:d),n.id=this.itemPull[e].id,n.parent=this.itemPull[e].parent,0<this.itemPull[e].tip.length&&(n.title=this.itemPull[e].tip),n.onselectstart=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},n.onmouseover=function(e){i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),"web"==i.conf.mode&&window.clearTimeout(i.conf.tm_handler),this._visible||i._redistribSubLevelSelection(this.id,this.parent),this._visible=!0},n.onmouseout=function(){"web"==i.conf.mode&&(i.conf.tm_handler&&window.clearTimeout(i.conf.tm_handler),i.conf.tm_handler=window.setTimeout(function(){i&&i._clearAndHide&&i._clearAndHide()},i.conf.tm_sec,"JavaScript"));var e=this;i.conf.hide_tm[this.id]&&window.clearTimeout(i.conf.hide_tm[this.id]),i.conf.hide_tm[this.id]=window.setTimeout(function(){e._visible=!1},50)},n.onclick=function(e){if(i.checkEvent("onClick")||!i.itemPull[this.id].complex){(e=e||event).cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,tc=i.itemPull[this.id].complex?"c":"-",td="enabled"==i.itemPull[this.id].state?"-":"d";var t={ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey};switch(i.itemPull[this.id].type){case"checkbox":i._checkboxOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",t);break;case"radio":i._radioOnClickHandler(this.id.replace(i.idPrefix,""),tc+td+"n",t);break;case"item":i._doOnClick(this.id.replace(i.idPrefix,""),tc+td+"n",t)}return!1}};e=this.idPull["polygon_"+this.itemPull[e].parent];null!=(t=null!=t&&(t=++t<0?0:t)>e.tbd.childNodes.length-1?null:t)&&null!=e.tbd.childNodes[t]?e.tbd.insertBefore(n,e.tbd.childNodes[t]):e.tbd.appendChild(n),this.idPull[n.id]=n},dhtmlXMenuObject.prototype._renderSeparator=function(e,t){var i,n,a,o,r=!this.conf.context&&this.itemPull[e].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea";"TopLevel"==r&&this.conf.context||(i=this,"TopLevel"!=r&&((n=document.createElement("TR")).className="sub_sep",(a=document.createElement("TD")).colSpan="3",n.appendChild(a)),(o=document.createElement("DIV")).id="separator_"+e,o.className="TopLevel"==r?"top_sep":"sub_sep",o.onselectstart=function(e){(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1},o.onclick=function(e){(e=e||event).cancelBubble=!0;e={ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey};i._doOnClick(this.id.replace("separator_"+i.idPrefix,""),"--s",e)},"TopLevel"==r?(null!=t?null!=this.cont.childNodes[t=++t<0?0:t]?this.cont.insertBefore(o,this.cont.childNodes[t]):this.cont.appendChild(o):(r=this.cont.childNodes[this.cont.childNodes.length-1],-1==String(r).search("TopLevel_Text")?this.cont.appendChild(o):this.cont.insertBefore(o,r)),this.idPull[o.id]=o):(e=this.idPull["polygon_"+this.itemPull[e].parent],null!=(t=null!=t&&(t=++t<0?0:t)>e.tbd.childNodes.length-1?null:t)&&null!=e.tbd.childNodes[t]?e.tbd.insertBefore(n,e.tbd.childNodes[t]):e.tbd.appendChild(n),a.appendChild(o),this.idPull[o.id]=n))},dhtmlXMenuObject.prototype.addNewSeparator=function(e,t){t=this.idPrefix+(null!=t?t:this._genStr(24));var i=this.idPrefix+this.getParentId(e);this._addItemIntoGlobalStrorage(t,i,"","separator",!1,"",""),this._renderSeparator(t,this.getItemPosition(e))},dhtmlXMenuObject.prototype._initObj=function(e,t,i){e instanceof Array||(null!=(i=e.parentId)&&0!==String(i).indexOf(this.idPrefix)&&(i=this.idPrefix+String(i)),e=e.items);for(var n,a,o,r,s,l=0;l<e.length;l++){void 0!==e[l].id&&null!=e[l].id||(e[l].id=this._genStr(24)),0!==String(e[l].id).indexOf(this.idPrefix)&&(e[l].id=this.idPrefix+String(e[l].id));var d={type:"item",tip:"",hotkey:"",state:"enabled",imgen:"",imgdis:""};for(_ in d)void 0===e[l][_]&&(e[l][_]=d[_]);if(""==e[l].imgen&&null!=e[l].img&&(e[l].imgen=e[l].img),""==e[l].imgdis&&null!=e[l].img_disabled&&(e[l].imgdis=e[l].img_disabled),null==e[l].title&&null!=e[l].text&&(e[l].title=e[l].text),null!=e[l].href&&(null!=e[l].href.link&&(e[l].href_link=e[l].href.link),null!=e[l].href.target&&(e[l].href_target=e[l].href.target)),null!=e[l].userdata)for(var _ in e[l].userdata)this.userData[e[l].id+"_"+_]=e[l].userdata[_];(void 0!==e[l].enabled&&0==window.dhx4.s2b(e[l].enabled)||void 0!==e[l].disabled&&1==window.dhx4.s2b(e[l].disabled))&&(e[l].state="disabled"),void 0===e[l].parent&&(e[l].parent=null!=i?i:this.idPrefix+this.topId),"checkbox"==e[l].type&&(e[l].checked=window.dhx4.s2b(e[l].checked),e[l].imgen=e[l].imgdis="chbx_"+(e[l].checked?"1":"0")),"radio"==e[l].type&&(e[l].checked=window.dhx4.s2b(e[l].checked),e[l].imgen=e[l].imgdis="rdbt_"+(e[l].checked?"1":"0"),void 0!==e[l].group&&null!=e[l].group||(e[l].group=this._genStr(24)),null==this.radio[e[l].group]&&(this.radio[e[l].group]=[]),this.radio[e[l].group].push(e[l].id)),this.itemPull[e[l].id]=e[l],null!=e[l].items&&0<e[l].items.length?(this.itemPull[e[l].id].complex=!0,this._initObj(e[l].items,!0,e[l].id)):this.conf.dload&&1==e[l].complex&&(this.itemPull[e[l].id].loaded="no"),this.itemPull[e[l].id].items=null}!0!==t&&(1==this.conf.dload?null==i?this._initTopLevelMenu():(this._addSubMenuPolygon(i,i),this.conf.selected==i&&(o=this.itemPull[i].parent==this.idPrefix+this.topId,n=o&&!this.conf.context?this.conf.dir_toplv:this.conf.dir_sublv,a=!1,o&&this.conf.top_mode&&"web"==this.conf.mode&&!this.conf.context&&(1!=(t=this.idPull[i])._mouseOver||1<(o=this.conf.top_tmtime-((new Date).getTime()-t._dynLoadTM))&&(r=i,s=this,t._menuOpenTM=window.setTimeout(function(){s._showPolygon(r,n),s=r=null},o),a=!0)),a||this._showPolygon(i,n)),this.itemPull[i].loaded="yes",1==this.conf.dload_icon&&this._updateLoaderIcon(i,!1)):this._init())},dhtmlXMenuObject.prototype._xmlToJson=function(e,t){var i=[];if(null==t){var n=e.getElementsByTagName(this.conf.tags.root);if(null==n||0==n.length)return data;n=n[0]}else n=e;null!=n.getAttribute("parentId")&&(t=this.idPrefix+n.getAttribute("parentId"));for(var a=0;a<n.childNodes.length;a++)if(void 0!==n.childNodes[a].tagName&&String(n.childNodes[a].tagName).toLowerCase()==this.conf.tags.item){var o,r=n.childNodes[a],s={id:this.idPrefix+(r.getAttribute("id")||this._genStr(24)),title:r.getAttribute("text")||"",imgen:r.getAttribute("img")||"",imgdis:r.getAttribute("imgdis")||"",tip:"",hotkey:"",type:r.getAttribute("type")||"item"};null!=r.getAttribute("cssNormal")&&(s.cssNormal=r.getAttribute("cssNormal")),"checkbox"==s.type&&(s.checked=r.getAttribute("checked")),"radio"==s.type&&(s.checked=r.getAttribute("checked"),s.group=r.getAttribute("group")),s.state="enabled",(null!=r.getAttribute("enabled")&&0==window.dhx4.s2b(r.getAttribute("enabled"))||null!=r.getAttribute("disabled")&&1==window.dhx4.s2b(r.getAttribute("disabled")))&&(s.state="disabled"),s.parent=null!=t?t:this.idPrefix+this.topId,this.conf.dload?(s.complex=null!=r.getAttribute("complex"),s.complex&&(s.loaded="no")):(o=this._xmlToJson(r,s.id),s.items=o.items,s.complex=0<s.items.length);for(var l,d,_=0;_<r.childNodes.length;_++)void 0!==r.childNodes[_].tagName&&((l=String(r.childNodes[_].tagName||"").toLowerCase())!=this.conf.tags.userdata||null!=(d=r.childNodes[_]).getAttribute("name")&&(this.userData[s.id+"_"+d.getAttribute("name")]=null!=d.firstChild&&null!=d.firstChild.nodeValue?d.firstChild.nodeValue:""),l==this.conf.tags.text_ext&&(s.title=r.childNodes[_].firstChild.nodeValue),l==this.conf.tags.tooltip&&(s.tip=r.childNodes[_].firstChild.nodeValue),l==this.conf.tags.hotkey&&(s.hotkey=r.childNodes[_].firstChild.nodeValue),l==this.conf.tags.href&&"item"==s.type&&(s.href_link=r.childNodes[_].firstChild.nodeValue,null!=r.childNodes[_].getAttribute("target")&&(s.href_target=r.childNodes[_].getAttribute("target"))));i.push(s)}return r={parentId:t,items:i}},dhtmlXMenuObject.prototype.enableDynamicLoading=function(e,t){this.conf.dload=!0,this.conf.dload_url=e,this.conf.dload_sign=-1==String(this.conf.dload_url).search(/\?/)?"?":"&",this.conf.dload_icon=t,this._init()},dhtmlXMenuObject.prototype._updateLoaderIcon=function(e,t){var i;null!=this.idPull[e]&&(0<=String(this.idPull[e].className).search("TopLevel_Item")||(i=this.conf.rtl?0:2,this.idPull[e].childNodes[i]&&this.idPull[e].childNodes[i].childNodes[0]&&(i=this.idPull[e].childNodes[i].childNodes[0],0===String(i.className).search("complex_arrow")&&(i.className="complex_arrow"+(t?"_loading":"")))))},dhtmlXMenuObject.prototype.addNewSibling=function(e,t,i,n,a,o){var r=this.idPrefix+(null!=t?t:this._genStr(24)),t=this.idPrefix+(null!=e?this.getParentId(e):this.topId);this._addItemIntoGlobalStrorage(r,t,i,"item",n,a,o),t!=this.idPrefix+this.topId||this.conf.context?this._renderSublevelItem(r,this.getItemPosition(e)):this._renderToplevelItem(r,this.getItemPosition(e))},dhtmlXMenuObject.prototype.addNewChild=function(e,t,i,n,a,o,r){if(null==e){if(!this.conf.context)return this.addNewSibling(e,i,n,a,o,r),void(null!=t&&this.setItemPosition(i,t));e=this.topId}i=this.idPrefix+(null!=i?i:this._genStr(24)),this.setHotKey&&this.setHotKey(e,""),e=this.idPrefix+e,this._addItemIntoGlobalStrorage(i,e,n,"item",a,o,r),null==this.idPull["polygon_"+e]&&this._renderSublevelPolygon(e,e),this._renderSublevelItem(i,t-1),this._redefineComplexState(e)},dhtmlXMenuObject.prototype.removeItem=function(e,t,i){var n,a=null;if((e=!t?this.idPrefix+e:e)!=this.idPrefix+this.topId){if(null==this.itemPull[e])return;if(this.idPull["polygon_"+e]&&this.idPull["polygon_"+e]._tmShow&&window.clearTimeout(this.idPull["polygon_"+e]._tmShow),"separator"==this.itemPull[e].type){var o=this.idPull["separator_"+e];this.itemPull[e].parent==this.idPrefix+this.topId?(o.onclick=null,o.onselectstart=null,o.id=null):(o.childNodes[0].childNodes[0].onclick=null,o.childNodes[0].childNodes[0].onselectstart=null,o.childNodes[0].childNodes[0].id=null,o.childNodes[0].removeChild(o.childNodes[0].childNodes[0]),o.removeChild(o.childNodes[0])),o.parentNode.removeChild(o),this.idPull["separator_"+e]=null,this.itemPull[e]=null,delete this.idPull["separator_"+e],delete this.itemPull[e],o=null}else{a=this.itemPull[e].parent;for((o=this.idPull[e]).onclick=null,o.oncontextmenu=null,o.onmouseover=null,o.onmouseout=null,o.onselectstart=null,o.id=null;0<o.childNodes.length;)o.removeChild(o.childNodes[0]);o.parentNode.removeChild(o),this.idPull[e]=null,this.itemPull[e]=null,delete this.idPull[e],delete this.itemPull[e],o=null}0}for(n in this.itemPull)this.itemPull[n].parent==e&&this.removeItem(n,!0,!0);var r=new Array(e);null==a||i||null!=this.idPull["polygon_"+a]&&0==this.idPull["polygon_"+a].tbd.childNodes.length&&(r.push(a),this._updateItemComplexState(a,!1,!1));for(var s,l=0;l<r.length;l++)this.idPull["polygon_"+r[l]]&&((s=this.idPull["polygon_"+r[l]]).onclick=null,s.oncontextmenu=null,s.tbl.removeChild(s.tbd),s.tbd=null,s.childNodes[1].removeChild(s.tbl),s.tbl=null,s.id=null,s.parentNode.removeChild(s),s=null,window.dhx4.isIE6&&(s="polygon_"+r[l]+"_ie6cover",null!=this.idPull[s]&&(document.body.removeChild(this.idPull[s]),delete this.idPull[s])),null!=this.idPull["arrowup_"+e]&&this._removeArrow&&this._removeArrow("arrowup_"+e),null!=this.idPull["arrowdown_"+e]&&this._removeArrow&&this._removeArrow("arrowdown_"+e),this.idPull["polygon_"+r[l]]=null,delete this.idPull["polygon_"+r[l]]);r=null,"dhx_terrace"==this.conf.skin&&1==arguments.length&&this._improveTerraceSkin()},dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(e,t,i,n,a,o,r){t={id:e,title:i,imgen:null!=o?o:"",imgdis:null!=r?r:"",type:n,state:1==a?"disabled":"enabled",parent:t,complex:!1,hotkey:"",tip:""};this.itemPull[t.id]=t},dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.conf.context=!0,1==this.base._autoSkinUpdate&&(this.base.className=this.base.className.replace("dhtmlxMenu_"+this.conf.skin+"_Middle",""),this.base._autoSkinUpdate=!1),null!=this.conf.ctx_baseid&&this.addContextZone(this.conf.ctx_baseid)},dhtmlXMenuObject.prototype.addContextZone=function(e){var t;t=e==document.body?(e="document.body."+this.idPrefix,document.body):document.getElementById(e);var i,n=!1;for(i in this.conf.ctx_zones)n=n||i==e||this.conf.ctx_zones[i]==t;if(1==n)return!1;this.conf.ctx_zones[e]=t;var a=this;window.dhx4.isOpera?(this.operaContext=function(e){a._doOnContextMenuOpera(e,a)},t.addEventListener("mouseup",this.operaContext,!1)):(null==t.oncontextmenu||t._oldContextMenuHandler||(t._oldContextMenuHandler=t.oncontextmenu),t.oncontextmenu=function(e){for(var t in dhtmlXMenuObject.prototype.liveInst)t!=a.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[t].context&&dhtmlXMenuObject.prototype.liveInst[t]._hideContextMenu();return(e=e||event).cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,a._doOnContextBeforeCall(e,this),!1})},dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(e,t){for(var i in dhtmlXMenuObject.prototype.liveInst)i!=t.conf.live_id&&dhtmlXMenuObject.prototype.liveInst[i].context&&dhtmlXMenuObject.prototype.liveInst[i]._hideContextMenu();return e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,0==e.button&&1==e.ctrlKey&&t._doOnContextBeforeCall(e,this),!1},dhtmlXMenuObject.prototype.removeContextZone=function(e){if(!this.isContextZone(e))return!1;e==document.body&&(e="document.body."+this.idPrefix);var t=this.conf.ctx_zones[e];window.dhx4.isOpera?t.removeEventListener("mouseup",this.operaContext,!1):(t.oncontextmenu=null!=t._oldContextMenuHandler?t._oldContextMenuHandler:null,t._oldContextMenuHandler=null);try{this.conf.ctx_zones[e]=null,delete this.conf.ctx_zones[e]}catch(e){}return!0},dhtmlXMenuObject.prototype.isContextZone=function(e){if(e==document.body&&null!=this.conf.ctx_zones["document.body."+this.idPrefix])return!0;var t=!1;return t=null!=this.conf.ctx_zones[e]&&this.conf.ctx_zones[e]==document.getElementById(e)?!0:t},dhtmlXMenuObject.prototype._isContextMenuVisible=function(){return null!=this.idPull["polygon_"+this.idPrefix+this.topId]&&""==this.idPull["polygon_"+this.idPrefix+this.topId].style.display},dhtmlXMenuObject.prototype._showContextMenu=function(e,t,i){if(this._clearAndHide(),null==this.idPull["polygon_"+this.idPrefix+this.topId])return!1;window.clearTimeout(this.conf.tm_handler),this.idPull[this.idPrefix+this.topId]=new Array(e,t),this._showPolygon(this.idPrefix+this.topId,"bottom"),this.callEvent("onContextMenu",[i])},dhtmlXMenuObject.prototype._hideContextMenu=function(){if(null==this.idPull["polygon_"+this.idPrefix+this.topId])return!1;this._clearAndHide(),this._hidePolygon(this.idPrefix+this.topId)},dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(e,t){this.conf.ctx_zoneid=t.id,this._clearAndHide(),this._hideContextMenu();var i=e.srcElement||e.target,n=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?e.offsetX:e.layerX,a=window.dhx4.isIE||window.dhx4.isOpera||window.dhx4.isKHTML?e.offsetY:e.layerY,n=window.dhx4.absLeft(i)+n,a=window.dhx4.absTop(i)+a;this.checkEvent("onBeforeContextMenu")?this.callEvent("onBeforeContextMenu",[t.id,e])&&this.conf.ctx_autoshow&&(this._showContextMenu(n,a,t.id),this.callEvent("onAfterContextMenu",[t.id,e])):this.conf.ctx_autoshow&&(this._showContextMenu(n,a,t.id),this.callEvent("onAfterContextMenu",[t.id]))},dhtmlXMenuObject.prototype.showContextMenu=function(e,t){this._showContextMenu(e,t,!1)},dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()},dhtmlXMenuObject.prototype.setAutoShowMode=function(e){this.conf.ctx_autoshow=1==e},dhtmlXMenuObject.prototype.setAutoHideMode=function(e){this.conf.ctx_autohide=1==e},dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(e){this.conf.ctx_hideall=1==e},dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.conf.ctx_hideall},dhtmlXMenuObject.prototype._improveTerraceSkin=function(){for(var e in this.itemPull)if(this.itemPull[e].parent==this.idPrefix+this.topId&&null!=this.idPull[e]){var t,i=!1,n=!1;for(t in this.idPull[e].parentNode.firstChild==this.idPull[e]&&(i=!0),this.idPull[e].parentNode.lastChild==this.idPull[e]&&(n=!0),this.itemPull)"separator"==this.itemPull[t].type&&this.itemPull[t].parent==this.idPrefix+this.topId&&(this.idPull[e].nextSibling==this.idPull["separator_"+t]&&(n=!0),this.idPull[e].previousSibling==this.idPull["separator_"+t]&&(i=!0));this.idPull[e].style.borderLeftWidth=i?"1px":"0px",this.idPull[e].style.borderTopLeftRadius=this.idPull[e].style.borderBottomLeftRadius=i?"3px":"0px",this.idPull[e].style.borderTopRightRadius=this.idPull[e].style.borderBottomRightRadius=n?"3px":"0px",this.idPull[e]._bl=i,this.idPull[e]._br=n}},dhtmlXMenuObject.prototype._improveTerraceButton=function(e,t){t?(this.idPull[e].style.borderBottomLeftRadius=this.idPull[e]._bl?"3px":"0px",this.idPull[e].style.borderBottomRightRadius=this.idPull[e]._br?"3px":"0px"):(this.idPull[e].style.borderBottomLeftRadius="0px",this.idPull[e].style.borderBottomRightRadius="0px")},dhtmlXMenuObject.prototype.setItemEnabled=function(e){this._changeItemState(e,"enabled",this._getItemLevelType(e))},dhtmlXMenuObject.prototype.setItemDisabled=function(e){this._changeItemState(e,"disabled",this._getItemLevelType(e))},dhtmlXMenuObject.prototype.isItemEnabled=function(e){return null!=this.itemPull[this.idPrefix+e]&&"enabled"==this.itemPull[this.idPrefix+e].state},dhtmlXMenuObject.prototype._changeItemState=function(e,t,i){var n=this.idPrefix+e;return null!=this.itemPull[n]&&null!=this.idPull[n]&&this.itemPull[n].state!=t&&(this.itemPull[n].state=t,this.itemPull[n].parent!=this.idPrefix+this.topId||this.conf.context?this.idPull[n].className="sub_item"+("enabled"==this.itemPull[n].state?"":"_dis"):this.idPull[n].className="dhtmlxMenu_"+this.conf.skin+"_TopLevel_Item_"+("enabled"==this.itemPull[n].state?"Normal":"Disabled"),this._updateItemComplexState(this.idPrefix+e,this.itemPull[this.idPrefix+e].complex,!1),this._updateItemImage(e,i),this.idPrefix+this.conf.last_click==n&&"TopLevel"!=i&&this._redistribSubLevelSelection(n,this.itemPull[n].parent),"TopLevel"==i&&this.conf.context),!1},dhtmlXMenuObject.prototype.getItemText=function(e){return null!=this.itemPull[this.idPrefix+e]?this.itemPull[this.idPrefix+e].title:""},dhtmlXMenuObject.prototype.setItemText=function(e,t){if(e=this.idPrefix+e,null!=this.itemPull[e]&&null!=this.idPull[e])if(this._clearAndHide(),this.itemPull[e].title=t,this.itemPull[e].parent!=this.idPrefix+this.topId||this.conf.context){for(i=null,n=0;n<this.idPull[e].childNodes[1].childNodes.length;n++)"sub_item_text"==String(this.idPull[e].childNodes[1].childNodes[n].className||"")&&(i=this.idPull[e].childNodes[1].childNodes[n]);""==String(this.itemPull[e].title).length||null==this.itemPull[e].title?i&&(i.parentNode.removeChild(i),i=null,this.idPull[e].childNodes[1].innerHTML="&nbsp;"):(i||((i=document.createElement("DIV")).className="sub_item_text",this.idPull[e].childNodes[1].innerHTML="",this.idPull[e].childNodes[1].appendChild(i)),i.innerHTML=this.itemPull[e].title)}else{for(var i=null,n=0;n<this.idPull[e].childNodes.length;n++)try{"top_level_text"==this.idPull[e].childNodes[n].className&&(i=this.idPull[e].childNodes[n])}catch(e){}""==String(this.itemPull[e].title).length||null==this.itemPull[e].title?null!=i&&i.parentNode.removeChild(i):(i||((i=document.createElement("DIV")).className="top_level_text",this.conf.rtl&&0<this.idPull[e].childNodes.length?this.idPull[e].insertBefore(i,this.idPull[e].childNodes[0]):this.idPull[e].appendChild(i)),i.innerHTML=this.itemPull[e].title)}},dhtmlXMenuObject.prototype.loadFromHTML=function(e,t,i){var n=this.conf.tags.item;this.conf.tags.item="div";var a="string"==typeof e?document.getElementById(e):e,e=this._xmlToJson(a,this.idPrefix+this.topId);this._initObj(e),this.conf.tags.item=n,t&&a.parentNode.removeChild(a),(a=objOd=null)!=onload&&("function"==typeof i?i():"function"==typeof window[i]&&window[i]())},dhtmlXMenuObject.prototype.hideItem=function(e){this._changeItemVisible(e,!1)},dhtmlXMenuObject.prototype.showItem=function(e){this._changeItemVisible(e,!0)},dhtmlXMenuObject.prototype.isItemHidden=function(e){var t=null;return t=null!=this.idPull[this.idPrefix+e]?"none"==this.idPull[this.idPrefix+e].style.display:t},dhtmlXMenuObject.prototype._changeItemVisible=function(e,t){var i=this.idPrefix+e;null!=this.itemPull[i]&&("separator"==this.itemPull[i].type&&(i="separator_"+i),null!=this.idPull[i]&&(this.idPull[i].style.display=t?"":"none",this._redefineComplexState(this.itemPull[this.idPrefix+e].parent)))},dhtmlXMenuObject.prototype.setUserData=function(e,t,i){this.userData[this.idPrefix+e+"_"+t]=i},dhtmlXMenuObject.prototype.getUserData=function(e,t){return null!=this.userData[this.idPrefix+e+"_"+t]?this.userData[this.idPrefix+e+"_"+t]:null},dhtmlXMenuObject.prototype.setOpenMode=function(e){this.conf.mode="win"==e?"win":"web"},dhtmlXMenuObject.prototype.setWebModeTimeout=function(e){this.conf.tm_sec=isNaN(e)?400:e},dhtmlXMenuObject.prototype.getItemImage=function(e){var t=new Array(null,null);return e=this.idPrefix+e,"item"==this.itemPull[e].type&&(t[0]=this.itemPull[e].imgen,t[1]=this.itemPull[e].imgdis),t},dhtmlXMenuObject.prototype.setItemImage=function(e,t,i){"item"==this.itemPull[this.idPrefix+e].type&&(this.itemPull[this.idPrefix+e].imgen=t,this.itemPull[this.idPrefix+e].imgdis=i,this._updateItemImage(e,this._getItemLevelType(e)))},dhtmlXMenuObject.prototype.clearItemImage=function(e){this.setItemImage(e,"","")},dhtmlXMenuObject.prototype.setVisibleArea=function(e,t,i,n){this.conf.v_enabled=!0,this.conf.v.x1=e,this.conf.v.x2=t,this.conf.v.y1=i,this.conf.v.y2=n},dhtmlXMenuObject.prototype.setTooltip=function(e,t){e=this.idPrefix+e,null!=this.itemPull[e]&&null!=this.idPull[e]&&(this.idPull[e].title=0<t.length?t:null,this.itemPull[e].tip=t)},dhtmlXMenuObject.prototype.getTooltip=function(e){return null==this.itemPull[this.idPrefix+e]?null:this.itemPull[this.idPrefix+e].tip},dhtmlXMenuObject.prototype.setTopText=function(e){this.conf.context||(null==this._topText&&(this._topText=document.createElement("DIV"),this._topText.className="dhtmlxMenu_TopLevel_Text_"+(!this.conf.rtl&&"left"==this.conf.align?"right":"left"),this.base.appendChild(this._topText)),this._topText.innerHTML=e)},dhtmlXMenuObject.prototype.setAlign=function(e){this.conf.align!=e&&("left"!=e&&"right"!=e||(this.conf.align=e,this.cont&&(this.cont.className="right"==this.conf.align?"align_right":"align_left"),null!=this._topText&&(this._topText.className="dhtmlxMenu_TopLevel_Text_"+("left"==this.conf.align?"right":"left"))))},dhtmlXMenuObject.prototype.setHref=function(e,t,i){null!=this.itemPull[this.idPrefix+e]&&(this.itemPull[this.idPrefix+e].href_link=t,null!=i&&(this.itemPull[this.idPrefix+e].href_target=i))},dhtmlXMenuObject.prototype.clearHref=function(e){null!=this.itemPull[this.idPrefix+e]&&(delete this.itemPull[this.idPrefix+e].href_link,delete this.itemPull[this.idPrefix+e].href_target)},dhtmlXMenuObject.prototype.getCircuit=function(e){for(var t=new Array(e);this.getParentId(e)!=this.topId;)e=this.getParentId(e),t[t.length]=e;return t.reverse()},dhtmlXMenuObject.prototype._getCheckboxState=function(e){return null==this.itemPull[this.idPrefix+e]?null:this.itemPull[this.idPrefix+e].checked},dhtmlXMenuObject.prototype._setCheckboxState=function(e,t){null!=this.itemPull[this.idPrefix+e]&&(this.itemPull[this.idPrefix+e].checked=t)},dhtmlXMenuObject.prototype._updateCheckboxImage=function(e){if(null!=this.idPull[this.idPrefix+e]){this.itemPull[this.idPrefix+e].imgen="chbx_"+(this._getCheckboxState(e)?"1":"0"),this.itemPull[this.idPrefix+e].imgdis=this.itemPull[this.idPrefix+e].imgen;try{this.idPull[this.idPrefix+e].childNodes[this.conf.rtl?2:0].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+e].imgen}catch(e){}}},dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(e,t,i){"d"!=t.charAt(1)&&null!=this.itemPull[this.idPrefix+e]&&(t=this._getCheckboxState(e),this.checkEvent("onCheckboxClick")&&!this.callEvent("onCheckboxClick",[e,t,this.conf.ctx_zoneid,i])||this.setCheckboxState(e,!t),this.checkEvent("onClick")&&this.callEvent("onClick",[e]))},dhtmlXMenuObject.prototype.setCheckboxState=function(e,t){this._setCheckboxState(e,t),this._updateCheckboxImage(e)},dhtmlXMenuObject.prototype.getCheckboxState=function(e){return this._getCheckboxState(e)},dhtmlXMenuObject.prototype.addCheckbox=function(e,t,i,n,a,o,r){if(!this.conf.context||t!=this.topId){if(null==this.itemPull[this.idPrefix+t])return;if("child"==e&&"item"!=this.itemPull[this.idPrefix+t].type)return}var s,l,d="chbx_"+(o?"1":"0"),_=d;"sibling"==e?(s=this.idPrefix+(null!=n?n:this._genStr(24)),l=this.idPrefix+this.getParentId(t),this._addItemIntoGlobalStrorage(s,l,a,"checkbox",r,d,_),this.itemPull[s].checked=o,this._renderSublevelItem(s,this.getItemPosition(t))):(s=this.idPrefix+(null!=n?n:this._genStr(24)),l=this.idPrefix+t,this._addItemIntoGlobalStrorage(s,l,a,"checkbox",r,d,_),this.itemPull[s].checked=o,null==this.idPull["polygon_"+l]&&this._renderSublevelPolygon(l,l),this._renderSublevelItem(s,i-1),this._redefineComplexState(l))},dhtmlXMenuObject.prototype.setHotKey=function(e,t){if(e=this.idPrefix+e,null!=this.itemPull[e]&&null!=this.idPull[e]&&(this.itemPull[e].parent!=this.idPrefix+this.topId||this.conf.context)&&!this.itemPull[e].complex){var i=this.itemPull[e].type;if("item"==i||"checkbox"==i||"radio"==i){i=null;try{"sub_item_hk"==this.idPull[e].childNodes[this.conf.rtl?0:2].childNodes[0].className&&(i=this.idPull[e].childNodes[this.conf.rtl?0:2].childNodes[0])}catch(e){}if(0==t.length)this.itemPull[e].hotkey_backup=this.itemPull[e].hotkey,this.itemPull[e].hotkey="",null!=i&&i.parentNode.removeChild(i);else{if(this.itemPull[e].hotkey=t,(this.itemPull[e].hotkey_backup=null)==i){(i=document.createElement("DIV")).className="sub_item_hk";for(var n=this.idPull[e].childNodes[this.conf.rtl?0:2];0<n.childNodes.length;)n.removeChild(n.childNodes[0]);n.appendChild(i)}i.innerHTML=t}}}},dhtmlXMenuObject.prototype.getHotKey=function(e){return null==this.itemPull[this.idPrefix+e]?null:this.itemPull[this.idPrefix+e].hotkey},dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(e){for(var t=this._getSubItemToDeselectByPolygon(e),i=0;i<this.conf.opened_poly.length;i++)this.conf.opened_poly[i]!=e&&this._hidePolygon(this.conf.opened_poly[i]);for(i=0;i<t.length;i++)null!=this.idPull[t[i]]&&"enabled"==this.itemPull[t[i]].state&&(this.idPull[t[i]].className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_Item_Normal")},dhtmlXMenuObject.prototype._checkArrowsState=function(e){var t=this.idPull["polygon_"+e].childNodes[1],i=this.idPull["arrowup_"+e],e=this.idPull["arrowdown_"+e];0==t.scrollTop?i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp_Disabled":i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp"+(i.over?"_Over":""),t.scrollTop+t.offsetHeight<t.scrollHeight?e.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown"+(e.over?"_Over":""):e.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown_Disabled"},dhtmlXMenuObject.prototype._addUpArrow=function(e){var t=this,i=document.createElement("DIV");i.pId=this.idPrefix+e,i.id="arrowup_"+this.idPrefix+e,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowUp",i.over=!1,i.onselectstart=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},i.oncontextmenu=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},i.onmouseover=function(){"web"==t.conf.mode&&window.clearTimeout(t.conf.tm_handler),t._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowUp_Over",this.over=!0,t._canScrollUp=!0,t._doScrollUp(this.pId,!0))},i.onmouseout=function(){"web"==t.conf.mode&&(window.clearTimeout(t.conf.tm_handler),t.conf.tm_handler=window.setTimeout(function(){t._clearAndHide()},t.conf.tm_sec,"JavaScript")),this.over=!1,t._canScrollUp=!1,this.className!="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowUp_Disabled"&&(this.className="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowUp",window.clearTimeout(t.conf.of_utm))},i.onclick=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!(e.cancelBubble=!0)};e=this.idPull["polygon_"+this.idPrefix+e];e.childNodes[0].appendChild(i),this.idPull[i.id]=i},dhtmlXMenuObject.prototype._addDownArrow=function(e){var t=this,i=document.createElement("DIV");i.pId=this.idPrefix+e,i.id="arrowdown_"+this.idPrefix+e,i.className="dhtmlxMenu_"+this.conf.skin+"_SubLevelArea_ArrowDown",i.over=!1,i.onselectstart=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},i.oncontextmenu=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!1},i.onmouseover=function(){"web"==t.conf.mode&&window.clearTimeout(t.conf.tm_handler),t._clearAllSelectedSubItemsInPolygon(this.pId),this.className!="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowDown_Over",this.over=!0,t._canScrollDown=!0,t._doScrollDown(this.pId,!0))},i.onmouseout=function(){"web"==t.conf.mode&&(window.clearTimeout(t.conf.tm_handler),t.conf.tm_handler=window.setTimeout(function(){t._clearAndHide()},t.conf.tm_sec,"JavaScript")),this.over=!1,t._canScrollDown=!1,this.className!="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowDown_Disabled"&&(this.className="dhtmlxMenu_"+t.conf.skin+"_SubLevelArea_ArrowDown",window.clearTimeout(t.conf.of_dtm))},i.onclick=function(e){return(e=e||event).preventDefault?e.preventDefault():e.returnValue=!1,!(e.cancelBubble=!0)};e=this.idPull["polygon_"+this.idPrefix+e];e.childNodes[2].appendChild(i),this.idPull[i.id]=i},dhtmlXMenuObject.prototype._removeUpArrow=function(e){e="arrowup_"+this.idPrefix+e;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeDownArrow=function(e){e="arrowdown_"+this.idPrefix+e;this._removeArrow(e)},dhtmlXMenuObject.prototype._removeArrow=function(e){var t=this.idPull[e];t.onselectstart=null,t.oncontextmenu=null,t.onmouseover=null,t.onmouseout=null,t.onclick=null,t.parentNode&&t.parentNode.removeChild(t),this.idPull[e]=t=null;try{delete this.idPull[e]}catch(e){}},dhtmlXMenuObject.prototype._isArrowExists=function(e){return null!=this.idPull["arrowup_"+e]&&null!=this.idPull["arrowdown_"+e]},dhtmlXMenuObject.prototype._doScrollUp=function(e,t){var i,n,a,o=this.idPull["polygon_"+e].childNodes[1];this._canScrollUp&&0<o.scrollTop?(i=!1,(n=o.scrollTop-this.conf.of_ustep)<0&&(i=!0,n=0),o.scrollTop=n,i?t=!0:(a=this).conf.of_utm=window.setTimeout(function(){a._doScrollUp(e,!1),a=null},this.conf.of_utime)):(this._canScrollUp=!1,this._checkArrowsState(e)),t&&this._checkArrowsState(e)},dhtmlXMenuObject.prototype._doScrollDown=function(e,t){var i,n,a,o=this.idPull["polygon_"+e].childNodes[1];this._canScrollDown&&o.scrollTop+o.offsetHeight<=o.scrollHeight?(i=!1,(n=o.scrollTop+this.conf.of_dstep)+o.offsetHeight>=o.scrollHeight&&(i=!0,n=o.scrollHeight-o.offsetHeight),o.scrollTop=n,i?t=!0:(a=this).conf.of_dtm=window.setTimeout(function(){a._doScrollDown(e,!1),a=null},this.conf.of_dtime)):(this._canScrollDown=!1,this._checkArrowsState(e)),t&&this._checkArrowsState(e)},dhtmlXMenuObject.prototype._countPolygonItems=function(e){var t,i=0;for(t in this.itemPull){var n=this.itemPull[t].parent,a=this.itemPull[t].type;n!=this.idPrefix+e||"item"!=a&&"radio"!=a&&"checkbox"!=a||i++}return i},dhtmlXMenuObject.prototype.setOverflowHeight=function(e){if("auto"===e)return this.conf.overflow_limit=0,void(this.conf.auto_overflow=!0);if(!(0==this.conf.overflow_limit&&e<=0))if(this._clearAndHide(),0<=this.conf.overflow_limit&&0<e)this.conf.overflow_limit=e;else if(0<this.conf.overflow_limit&&e<=0){for(var t in this.itemPull){var i;this._isArrowExists(t)&&(i=String(t).replace(this.idPrefix,""),this._removeUpArrow(i),this._removeDownArrow(i),this.idPull["polygon_"+t].childNodes[1].style.height="")}this.conf.overflow_limit=0}},dhtmlXMenuObject.prototype._getRadioImgObj=function(e){try{var t=this.idPull[this.idPrefix+e].childNodes[this.conf.rtl?2:0].childNodes[0]}catch(e){t=null}return t},dhtmlXMenuObject.prototype._setRadioState=function(e,t){var i=this._getRadioImgObj(e);null!=i&&((e=this.itemPull[this.idPrefix+e]).checked=t,e.imgen="rdbt_"+(e.checked?"1":"0"),e.imgdis=e.imgen,i.className="sub_icon "+e.imgen)},dhtmlXMenuObject.prototype._radioOnClickHandler=function(e,t,i){"d"!=t.charAt(1)&&null!=this.itemPull[this.idPrefix+e].group&&(t=this.itemPull[this.idPrefix+e].group,this.checkEvent("onRadioClick")&&!this.callEvent("onRadioClick",[t,this.getRadioChecked(t),e,this.conf.ctx_zoneid,i])||this.setRadioChecked(t,e),this.checkEvent("onClick")&&this.callEvent("onClick",[e]))},dhtmlXMenuObject.prototype.getRadioChecked=function(e){for(var t=null,i=0;i<this.radio[e].length;i++){var n=this.radio[e][i].replace(this.idPrefix,""),a=this._getRadioImgObj(n);null!=a&&null!=a.className.match(/rdbt_1$/gi)&&(t=n)}return t},dhtmlXMenuObject.prototype.setRadioChecked=function(e,t){if(null!=this.radio[e])for(var i=0;i<this.radio[e].length;i++){var n=this.radio[e][i].replace(this.idPrefix,"");this._setRadioState(n,n==t)}},dhtmlXMenuObject.prototype.addRadioButton=function(e,t,i,n,a,o,r,s){if(!this.conf.context||t!=this.topId){if(null==this.itemPull[this.idPrefix+t])return;if("child"==e&&"item"!=this.itemPull[this.idPrefix+t].type)return}var l,d=this.idPrefix+(null!=n?n:this._genStr(24)),_="rdbt_"+(r?"1":"0"),n=_;"sibling"==e?(l=this.idPrefix+this.getParentId(t),this._addItemIntoGlobalStrorage(d,l,a,"radio",s,_,n),this._renderSublevelItem(d,this.getItemPosition(t))):(l=this.idPrefix+t,this._addItemIntoGlobalStrorage(d,l,a,"radio",s,_,n),null==this.idPull["polygon_"+l]&&this._renderSublevelPolygon(l,l),this._renderSublevelItem(d,i-1),this._redefineComplexState(l));o=null!=o?o:this._genStr(24);this.itemPull[d].group=o,null==this.radio[o]&&(this.radio[o]=new Array),this.radio[o][this.radio[o].length]=d,1==r&&this.setRadioChecked(o,String(d).replace(this.idPrefix,""))},dhtmlXMenuObject.prototype.serialize=function(){return"<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>"},dhtmlXMenuObject.prototype._readLevel=function(e){var t,i,n,a,o,r,s,l,d="";for(t in this.itemPull)this.itemPull[t].parent==e&&(a=n=i="",o=String(this.itemPull[t].id).replace(this.idPrefix,""),s=(r="")!=this.itemPull[t].title?' text="'+this.itemPull[t].title+'"':"",l="","item"==this.itemPull[t].type&&(""!=this.itemPull[t].imgen&&(i=' img="'+this.itemPull[t].imgen+'"'),""!=this.itemPull[t].imgdis&&(n=' imgdis="'+this.itemPull[t].imgdis+'"'),""!=this.itemPull[t].hotkey&&(a="<hotkey>"+this.itemPull[t].hotkey+"</hotkey>")),"separator"==this.itemPull[t].type?r=' type="separator"':"disabled"==this.itemPull[t].state&&(l=' enabled="false"'),"checkbox"==this.itemPull[t].type&&(r=' type="checkbox"'+(this.itemPull[t].checked?' checked="true"':"")),d+="<item id='"+o+"'"+s+(r="radio"==this.itemPull[t].type?' type="radio" group="'+this.itemPull[t].group+'" '+(this.itemPull[t].checked?' checked="true"':""):r)+i+n+l+">",d+=a,this.itemPull[t].complex&&(d+=this._readLevel(t)),d+="</item>");return d},dhtmlXMenuObject.prototype.enableEffect=function(e,t,i){for(var n in this._menuEffect=("opacity"==e||"slide"==e||"slide+"==e)&&e,this._pOpStyleIE=0<=navigator.userAgent.search(/MSIE\s[678]\.0/gi),this.idPull)0===n.search(/polygon/)&&(this._pOpacityApply(n,this._pOpStyleIE?100:1),this.idPull[n].style.height="");this._pOpMax=(void 0===t?100:t)/(this._pOpStyleIE?1:100),this._pOpStyleName=this._pOpStyleIE?"filter":"opacity",this._pOpStyleValue=this._pOpStyleIE?"progid:DXImageTransform.Microsoft.Alpha(Opacity=#)":"#",this._pSlSteps=this._pOpStyleIE?10:20,this._pSlTMTimeMax=i||50},dhtmlXMenuObject.prototype._showPolygonEffect=function(e){this._pShowHide(e,!0)},dhtmlXMenuObject.prototype._hidePolygonEffect=function(e){this._pShowHide(e,!1)},dhtmlXMenuObject.prototype._pOpacityApply=function(e,t){this.idPull[e].style[this._pOpStyleName]=String(this._pOpStyleValue).replace("#",t||this.idPull[e]._op)},dhtmlXMenuObject.prototype._pShowHide=function(e,t){if(this.idPull){if(null!=this.idPull[e]._tmShow){if(0<this.idPull[e]._step_h&&1==t||this.idPull[e]._step_h<0&&0==t)return;window.clearTimeout(this.idPull[e]._tmShow),this.idPull[e]._tmShow=null,this.idPull[e]._max_h=null}if(0!=t||"hidden"!=this.idPull[e].style.visibility&&"none"!=this.idPull[e].style.display){if(1==t&&"none"==this.idPull[e].style.display&&(this.idPull[e].style.visibility="hidden",this.idPull[e].style.display=""),null==this.idPull[e]._max_h){if(this.idPull[e]._max_h=parseInt(this.idPull[e].offsetHeight),this.idPull[e]._h=1==t?0:this.idPull[e]._max_h,this.idPull[e]._step_h=Math.round(this.idPull[e]._max_h/this._pSlSteps)*(1==t?1:-1),0==this.idPull[e]._step_h)return;this.idPull[e]._step_tm=Math.round(this._pSlTMTimeMax/this._pSlSteps),"slide+"==this._menuEffect||"opacity"==this._menuEffect?(this.idPull[e].op_tm=this.idPull[e]._step_tm,this.idPull[e].op_step=this._pOpMax/this._pSlSteps*(1==t?1:-1),this._pOpStyleIE&&(this.idPull[e].op_step=Math.round(this.idPull[e].op_step)),this.idPull[e]._op=1==t?0:this._pOpMax):this.idPull[e]._op=this._pOpStyleIE?100:1,this._pOpacityApply(e),0===this._menuEffect.search(/slide/)&&(this.idPull[e].style.height="0px"),this.idPull[e].style.visibility="visible"}this._pEffectSet(e,this.idPull[e]._h+this.idPull[e]._step_h)}}},dhtmlXMenuObject.prototype._pEffectSet=function(e,t){var i;this.idPull&&(this.idPull[e]._tmShow&&window.clearTimeout(this.idPull[e]._tmShow),this.idPull[e]._h=Math.max(0,Math.min(t,this.idPull[e]._max_h)),0===this._menuEffect.search(/slide/)&&(this.idPull[e].style.height=this.idPull[e]._h+"px"),t+=this.idPull[e]._step_h,"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[e]._op=Math.max(0,Math.min(this._pOpMax,this.idPull[e]._op+this.idPull[e].op_step)),this._pOpacityApply(e)),0<this.idPull[e]._step_h&&t<=this.idPull[e]._max_h||this.idPull[e]._step_h<0&&0<=t?(i=this).idPull[e]._tmShow=window.setTimeout(function(){i._pEffectSet(e,t)},this.idPull[e]._step_tm):(0===this._menuEffect.search(/slide/)&&(this.idPull[e].style.height=""),this.idPull[e]._step_h<0&&(this.idPull[e].style.visibility="hidden"),"slide+"!=this._menuEffect&&"opacity"!=this._menuEffect||(this.idPull[e]._op=this.idPull[e]._step_h<0?this._pOpStyleIE?100:1:this._pOpMax,this._pOpacityApply(e)),this.idPull[e]._tmShow=null,this.idPull[e]._h=null,this.idPull[e]._max_h=null,this.idPull[e]._step_tm=null))};